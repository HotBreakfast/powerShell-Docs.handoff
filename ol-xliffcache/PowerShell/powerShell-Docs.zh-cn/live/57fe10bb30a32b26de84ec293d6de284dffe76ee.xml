{
  "nodes": [
    {
      "content": "Creating a Graphical Date Picker",
      "pos": [
        11,
        43
      ]
    },
    {
      "content": "Creating a Graphical Date Picker",
      "pos": [
        178,
        210
      ]
    },
    {
      "content": "Use Windows PowerShell 3.0 and later releases to create a form with a graphical, calendar\\-style control that lets users select a day of the month.",
      "pos": [
        211,
        358
      ]
    },
    {
      "content": "Create a graphical date\\-picker control",
      "pos": [
        363,
        402
      ]
    },
    {
      "content": "Copy and then paste the following into Windows PowerShell ISE, and then save it as a Windows PowerShell script (.ps1).",
      "pos": [
        403,
        521
      ]
    },
    {
      "content": "The script begins by loading two .NET Framework classes: <bpt id=\"p1\">**</bpt>System.Drawing<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>System.Windows.Forms<ept id=\"p2\">**</ept>.",
      "pos": [
        1812,
        1917
      ]
    },
    {
      "content": "You then start a new instance of the .NET Framework class <bpt id=\"p1\">**</bpt>Windows.Forms.Form<ept id=\"p1\">**</ept>; that provides a blank form or window to which you can start adding controls.",
      "pos": [
        1918,
        2076
      ]
    },
    {
      "content": "After you create an instance of the Form class, assign values to three properties of this class.",
      "pos": [
        2125,
        2221
      ]
    },
    {
      "content": "Text.",
      "pos": [
        2229,
        2234
      ]
    },
    {
      "content": "This becomes the title of the window.",
      "pos": [
        2237,
        2274
      ]
    },
    {
      "content": "Size.",
      "pos": [
        2282,
        2287
      ]
    },
    {
      "content": "This is the size of the form, in pixels.",
      "pos": [
        2290,
        2330
      ]
    },
    {
      "content": "The preceding script creates a form that’s 243 pixels wide by 230 pixels tall.",
      "pos": [
        2331,
        2409
      ]
    },
    {
      "content": "StartingPosition.",
      "pos": [
        2417,
        2434
      ]
    },
    {
      "content": "This optional property is set to <bpt id=\"p1\">**</bpt>CenterScreen<ept id=\"p1\">**</ept> in the preceding script.",
      "pos": [
        2437,
        2511
      ]
    },
    {
      "content": "If you don’t add this property, Windows selects a location when the form is opened.",
      "pos": [
        2512,
        2595
      ]
    },
    {
      "content": "By setting the <bpt id=\"p1\">**</bpt>StartingPosition<ept id=\"p1\">**</ept> to <bpt id=\"p2\">**</bpt>CenterScreen<ept id=\"p2\">**</ept>, you’re automatically displaying the form in the middle of the screen each time it loads.",
      "pos": [
        2596,
        2741
      ]
    },
    {
      "content": "Next, create and then add a calendar control in your form.",
      "pos": [
        2868,
        2926
      ]
    },
    {
      "content": "In this example, the current day is not highlighted or circled.",
      "pos": [
        2927,
        2990
      ]
    },
    {
      "content": "Users can select only one day on the calendar at one time.",
      "pos": [
        2991,
        3049
      ]
    },
    {
      "content": "Next, create an <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button for your form.",
      "pos": [
        3216,
        3260
      ]
    },
    {
      "content": "Specify the size and behavior of the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button.",
      "pos": [
        3261,
        3312
      ]
    },
    {
      "content": "In this example, the button position is 165 pixels from the form’s top edge, and 38 pixels from the left edge.",
      "pos": [
        3313,
        3423
      ]
    },
    {
      "content": "The button height is 23 pixels, while the button length is 75 pixels.",
      "pos": [
        3424,
        3493
      ]
    },
    {
      "content": "The script uses predefined Windows Forms types to determine the button behaviors.",
      "pos": [
        3494,
        3575
      ]
    },
    {
      "content": "Similarly, you create a <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button.",
      "pos": [
        3901,
        3943
      ]
    },
    {
      "content": "The <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button is 165 pixels from the top, but 113 pixels from the left edge of the window.",
      "pos": [
        3944,
        4042
      ]
    },
    {
      "pos": [
        4405,
        4516
      ],
      "content": "Set the <bpt id=\"p1\">**</bpt>Topmost<ept id=\"p1\">**</ept> property to <bpt id=\"p2\">**</bpt>$True<ept id=\"p2\">**</ept> to force the window to open atop other open windows and dialog boxes."
    },
    {
      "content": "Add the following line of code to display the form in Windows.",
      "pos": [
        4549,
        4611
      ]
    },
    {
      "content": "Finally, the code inside the <bpt id=\"p1\">**</bpt>If<ept id=\"p1\">**</ept> block instructs Windows what to do with the form after users select a day on the calendar, and then click the <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept> button or press the <bpt id=\"p3\">**</bpt>Enter<ept id=\"p3\">**</ept> key.",
      "pos": [
        4651,
        4838
      ]
    },
    {
      "content": "Windows PowerShell displays the selected date to users.",
      "pos": [
        4839,
        4894
      ]
    },
    {
      "content": "See Also",
      "pos": [
        5067,
        5075
      ]
    },
    {
      "content": "Hey Scripting Guy:  Why don’t these PowerShell GUI examples work?",
      "pos": [
        5077,
        5142
      ]
    },
    {
      "content": "GitHub: Dave Wyatt's WinFormsExampleUpdates",
      "pos": [
        5192,
        5235
      ]
    },
    {
      "content": "Windows PowerShell Tip of the Week:  Creating a Graphical Date Picker",
      "pos": [
        5289,
        5358
      ]
    }
  ],
  "content": "---\ntitle: Creating a Graphical Date Picker\nms.custom: na\nms.reviewer: na\nms.suite: na\nms.tgt_pltfrm: na\nms.topic: article\nms.assetid: c1cb722c-41e9-4baa-be83-59b4653222e9\n---\n# Creating a Graphical Date Picker\nUse Windows PowerShell 3.0 and later releases to create a form with a graphical, calendar\\-style control that lets users select a day of the month.\n\n## Create a graphical date\\-picker control\nCopy and then paste the following into Windows PowerShell ISE, and then save it as a Windows PowerShell script (.ps1).\n\n```\nAdd-Type -AssemblyName System.Windows.Forms\nAdd-Type -AssemblyName System.Drawing\n\n$form = New-Object Windows.Forms.Form \n\n$form.Text = \"Select a Date\" \n$form.Size = New-Object Drawing.Size @(243,230) \n$form.StartPosition = \"CenterScreen\"\n\n$calendar = New-Object System.Windows.Forms.MonthCalendar \n$calendar.ShowTodayCircle = $False\n$calendar.MaxSelectionCount = 1\n$form.Controls.Add($calendar) \n\n$OKButton = New-Object System.Windows.Forms.Button\n$OKButton.Location = New-Object System.Drawing.Point(38,165)\n$OKButton.Size = New-Object System.Drawing.Size(75,23)\n$OKButton.Text = \"OK\"\n$OKButton.DialogResult = [System.Windows.Forms.DialogResult]::OK\n$form.AcceptButton = $OKButton\n$form.Controls.Add($OKButton)\n\n$CancelButton = New-Object System.Windows.Forms.Button\n$CancelButton.Location = New-Object System.Drawing.Point(113,165)\n$CancelButton.Size = New-Object System.Drawing.Size(75,23)\n$CancelButton.Text = \"Cancel\"\n$CancelButton.DialogResult = [System.Windows.Forms.DialogResult]::Cancel\n$form.CancelButton = $CancelButton\n$form.Controls.Add($CancelButton)\n\n$form.Topmost = $True\n\n$result = $form.ShowDialog() \n\nif ($result -eq [System.Windows.Forms.DialogResult]::OK)\n{\n    $date = $calendar.SelectionStart\n    Write-Host \"Date selected: $($date.ToShortDateString())\"\n}\n```\n\nThe script begins by loading two .NET Framework classes: **System.Drawing** and **System.Windows.Forms**. You then start a new instance of the .NET Framework class **Windows.Forms.Form**; that provides a blank form or window to which you can start adding controls.\n\n```\n$form = New-Object Windows.Forms.Form\n```\n\nAfter you create an instance of the Form class, assign values to three properties of this class.\n\n-   **Text.** This becomes the title of the window.\n\n-   **Size.** This is the size of the form, in pixels. The preceding script creates a form that’s 243 pixels wide by 230 pixels tall.\n\n-   **StartingPosition.** This optional property is set to **CenterScreen** in the preceding script. If you don’t add this property, Windows selects a location when the form is opened. By setting the **StartingPosition** to **CenterScreen**, you’re automatically displaying the form in the middle of the screen each time it loads.\n\n```\n$form.Text = \"Select a Date\" \n$form.Size = New-Object Drawing.Size @(243,230) \n$form.StartPosition = \"CenterScreen\"\n```\n\nNext, create and then add a calendar control in your form. In this example, the current day is not highlighted or circled. Users can select only one day on the calendar at one time.\n\n```\n$calendar = New-Object System.Windows.Forms.MonthCalendar \n$calendar.ShowTodayCircle = $False\n$calendar.MaxSelectionCount = 1\n$form.Controls.Add($calendar)\n```\n\nNext, create an **OK** button for your form. Specify the size and behavior of the **OK** button. In this example, the button position is 165 pixels from the form’s top edge, and 38 pixels from the left edge. The button height is 23 pixels, while the button length is 75 pixels. The script uses predefined Windows Forms types to determine the button behaviors.\n\n```\n$OKButton = New-Object System.Windows.Forms.Button\n$OKButton.Location = New-Object System.Drawing.Point(38,165)\n$OKButton.Size = New-Object System.Drawing.Size(75,23)\n$OKButton.Text = \"OK\"\n$OKButton.DialogResult = [System.Windows.Forms.DialogResult]::OK\n$form.AcceptButton = $OKButton\n$form.Controls.Add($OKButton)\n```\n\nSimilarly, you create a **Cancel** button. The **Cancel** button is 165 pixels from the top, but 113 pixels from the left edge of the window.\n\n```\n$CancelButton = New-Object System.Windows.Forms.Button\n$CancelButton.Location = New-Object System.Drawing.Point(113,165)\n$CancelButton.Size = New-Object System.Drawing.Size(75,23)\n$CancelButton.Text = \"Cancel\"\n$CancelButton.DialogResult = [System.Windows.Forms.DialogResult]::Cancel\n$form.CancelButton = $CancelButton\n$form.Controls.Add($CancelButton)\n```\n\nSet the **Topmost** property to **$True** to force the window to open atop other open windows and dialog boxes.\n\n```\n$form.Topmost = $True\n```\n\nAdd the following line of code to display the form in Windows.\n\n```\n$result = $form.ShowDialog()\n```\n\nFinally, the code inside the **If** block instructs Windows what to do with the form after users select a day on the calendar, and then click the **OK** button or press the **Enter** key. Windows PowerShell displays the selected date to users.\n\n```\nif ($result -eq [System.Windows.Forms.DialogResult]::OK)\n{\n    $date = $calendar.SelectionStart\n    Write-Host \"Date selected: $($date.ToShortDateString())\"\n}\n```\n\n## See Also\n[Hey Scripting Guy:  Why don’t these PowerShell GUI examples work?](http://go.microsoft.com/fwlink/?LinkId=506644)\n[GitHub: Dave Wyatt's WinFormsExampleUpdates](https://github.com/dlwyatt/WinFormsExampleUpdates)\n[Windows PowerShell Tip of the Week:  Creating a Graphical Date Picker](http://technet.microsoft.com/library/ff730942.aspx)\n\n"
}