---
title: "Новые возможности интегрированной среды сценариев PowerShell версии 5.0"
ms.date: 2016-05-11
keywords: powershell,cmdlet
description: 
ms.topic: article
author: jpjofre
manager: dongill
ms.prod: powershell
ms.assetid: 38648d47-7c27-4b37-a40e-ad29948519c2
translationtype: Human Translation
ms.sourcegitcommit: 03ac4b90d299b316194f1fa932e7dbf62d4b1c8e
ms.openlocfilehash: 7be11016317a65565dd9af2a3f65e8f00b3818f3

---

# Новые возможности в интегрированной среде сценариев Windows PowerShell
В этой статье описаны новые и обновленные функции, представленные в разных версиях интегрированной среды сценариев Windows PowerShell Â®.

## <a name="overview"></a>Описание компонента
Интегрированная среда сценариев Windows PowerShell — это ведущее приложение, позволяющее писать, выполнять и тестировать сценарии и модули в удобной среде с графическим интерфейсом. Такие важные возможности, как цветовая разметка синтаксиса, заполнение нажатием клавиши TAB, визуальная отладка, совместимость с Юникодом и контекстная справка делают работу со сценариями более удобной.

Общие сведения об интегрированной среде сценариев Windows PowerShell см. в статье [Общие сведения об интегрированной среде сценариев Windows PowerShell](https://technet.microsoft.com/en-us/library/3c1892c2-bf84-4cb6-af26-1f453be9e671).

## <a name="versions"></a>Новые и измененные функции в интегрированной среде сценариев Windows PowerShell
Следующая таблица содержит новые и измененные функции для этого выпуска интегрированной среды сценариев Windows PowerShell в Windows PowerShell.

|Компонент\/функция|Интегрированная среда сценариев Windows PowerShell 4.0|Интегрированная среда сценариев Windows PowerShell 3.0|Интегрированная среда сценариев Windows PowerShell 2.0|
|--------------------------|-----------------------------------------------|-----------------------------------------------|-----------------------------------------------|
|**[Intellisense](#BKMK_Intellisense)**|X|X||
|**[Фрагменты](#bkmk_snippets)**|X|X||
|**[Дополнительные компоненты](#BKMK_AddOnTools)**|X|X||
|**[Диспетчер перезапуска и автосохранение](#BKMK_RestartMgr)**|X|X||
|**[Область консоли](#BKMK_ConsolePane)**|X|X||
|**[Список недавно использовавшихся элементов](#BKMK_MRU)**|X|X||
|**[Параметры командной строки](#BKMK_CommandLine)**|X|X||
|**[Новые возможности редактора](#BKMK_NewEditorFeatures)**|X|X||
|**[Новое окно справки](#BKMK_NewHelpViewer)**|X|X||
|**[Командлет Show-Command](#BKMK_ShowCommand)**|X|X||

### <a name="BKMK_Intellisense"></a>Intellisense
**Добавлен в интегрированной среде сценариев 3.0**

IntelliSense — это средство для автоматического заполнения, являющееся частью интегрированной среды сценариев Windows PowerShell. В процессе ввода Intellisense отображает активные меню с подходящими командлетами, параметрами, значениями параметров, файлами и папками.

**Какой эффект дает это изменение?**

С появлением Intellisense упростилось обнаружение командлетов и синтаксиса при использовании интегрированной среды сценариев Windows PowerShell для создания сценариев. Интегрированная среда сценариев Windows PowerShell позволяет также изучать Windows PowerShell при создании новых сценариев.

**Что работает иначе?**

При вводе командлетов в интегрированной среде сценариев Windows PowerShell 3.0 или более поздней версии отображается прокручиваемое и активное меню, позволяющее просмотреть и выбрать соответствующие команды.

### <a name="BKMK_Snippets"></a>Фрагменты
**Добавлен в интегрированной среде сценариев 3.0**

*Фрагменты* — это короткие участки кода Windows PowerShell, которые можно легко вставить в сценарии, создаваемые в интегрированной среде сценариев Windows PowerShell. Интегрированная среда сценариев Windows PowerShell включает стандартный набор фрагментов. При работе в интегрированной среде сценариев Windows PowerShell можно добавлять фрагменты кода с помощью командлета **New\-Snippet**.

**Какой эффект дает это изменение?**

С помощью фрагментов можно быстро составлять и создавать сценарии для автоматизации среды.

**Что работает иначе?**

Чтобы использовать фрагменты кода в Windows PowerShell 3.0 или более поздней версии, выберите команду **Запустить фрагменты** в меню **Правка** или нажмите сочетание клавиш **CTRL\-J**.

### <a name="BKMK_AddOnTools"></a>Дополнительные компоненты
**Добавлено в PowerShell 3.0**

Интегрированная среда сценариев Windows PowerShell теперь поддерживает дополнительные компоненты — элементы управления Windows Presentation Foundation (WPF), которые добавляются с использованием объектной модели. Дополнительные компоненты могут отображаться в вертикальной или горизонтальной области внутри консоли. Если область содержит несколько дополнительных компонентов, они отображаются на вкладках. Можно также добавлять и удалять дополнительные компоненты сторонних разработчиков. Дополнительные сведения об импорте и экспорте дополнительных компонентов см. в статье [Операции интегрированной среды сценариев Windows PowerShell](http://technet.microsoft.com/library/cc732148.aspx).

**Какой эффект дает это изменение?**

Дополнительные компоненты позволяют расширить и настроить интегрированную среду сценариев Windows PowerShell с помощью средств, способных улучшить работу со сценариями или добавить в нее функциональные возможности.

**Что работает иначе?**

Интегрированная среда сценариев Windows PowerShell 3.0 и более поздних версий содержит дополнительный компонент **Commands**. Дополнительный компонент **Commands** позволяет параллельно просматривать командлеты и справку для них с помощью областей **сценариев** и **консоли**.

Еще больше дополнительных компонентов можно найти с помощью команды **Перейти на сайт дополнительных компонентов** в меню **Дополнительные компоненты**.

### <a name="BKMK_RestartMgr"></a>Диспетчер перезапуска и автосохранение
**Добавлено в PowerShell 3.0**

Интегрированная среда сценариев Windows PowerShell теперь автоматически сохраняет открытые сценарии в отдельном расположении каждые две минуты.  Если интегрированная среда сценариев Windows PowerShell прекращает работать или перезагружается операционная система, то при повторном запуске интегрированной среды сценариев Windows PowerShell сценарии, открытые во время последнего сеанса, восстанавливаются, даже если они не были сохранены.

Чтобы изменить интервал автоматического сохранения, выполните в области консоли следующую команду: **$psise.Options.AutoSaveMinuteInterval**.

**Какой эффект дает это изменение?**

Теперь в интегрированной среде сценариев Windows PowerShell можно работать, зная, что в случае неожиданной перезагрузки открытые сценарии сохраняются автоматически.

**Что работает иначе?**

Интегрированная среда сценариев Windows PowerShell 2.0 не сохраняет сценарии автоматически в случае перезагрузки.

### <a name="BKMK_MRU"></a>Список недавно\-использовавшихся элементов
**Добавлено в PowerShell 3.0**

Интегрированная среда сценариев Windows PowerShell теперь имеет список недавно\-использовавшихся файлов. При открытии файла в интегрированной среде сценариев Windows PowerShell он добавляется в список недавно\-использовавшихся элементов в меню **Файл**.

Чтобы изменить число файлов в списке недавно\-использовавшихся элементов, выполните следующую команду в области консоли: **$psise.Options.MruCount**.

**Какой эффект дает это изменение?**

Теперь вы можете использовать список недавно использовавшихся элементов для упрощения доступа к файлам.

**Что работает иначе?**

В интегрированной среде сценариев Windows PowerShell 2.0 нет списка недавно использовавшихся элементов.

### <a name="BKMK_ConsolePane"></a>Область консоли
**Добавлено в PowerShell 3.0**

Области команд и вывода, которые были разделены в первом выпуске интегрированной среды сценариев Windows PowerShell, объединены теперь в одну область консоли. Область консоли аналогична по функциональности и внешнему виду типовой консоли Windows PowerShell, но отличается рядом усовершенствований, которые перечислены ниже (многие из них описаны в этой статье).

-   Цветовая разметка синтаксиса вводимого текста (но не выводимого текста), включая синтаксис XML

-   Intellisense

-   Соответствие скобок

-   Индикация ошибок

-   Полная поддержка Юникода

-   Контекстная\-справка по нажатию клавиши **F1**

-   Контекстный командлет Show\-Command по нажатию клавиш **Ctrl\+F1**

-   Поддержка наборов сложных сценариев и написания справа налево

-   Поддержка шрифтов

-   Масштабирование

-   Режимы выделения строки и блока

-   Сохранение введенного содержимого в командной строке при нажатии пользователем клавиши **СТРЕЛКА ВВЕРХ** для просмотра истории в консоли

**Какой эффект дает это изменение?**

Добавление этих изменений для области консоли делает процесс использования сценариев более согласованным с интерфейсом консоли.

**Что работает иначе?**

Интегрированная среда сценариев Windows PowerShell 2.0 имеет отдельные области команд и вывода.

### <a name="BKMK_CommandLine"></a>Переключатели командной строки
**Добавлено в PowerShell 3.0**

При запуске интегрированной среды сценариев Windows PowerShell из командной строки (путем ввода **Powershell\_ise.exe**) можно указывать следующие новые параметры:

-   *\-NoProfile*: запускает интегрированную среду сценариев Windows PowerShell без выполнения **$profile**

-   *\-Help*: отображает окно справки

-   *\-MTA*: интегрированная среда сценариев Windows PowerShell запускается в режиме многопотокового подразделения. По умолчанию для интегрированной среды сценариев Windows PowerShell используется режим однопотокового подразделения или *\-sta*.

**Какой эффект дает это изменение?**

Добавление этих параметров командной строки позволяет управлять средой, в которой выполняется интегрированная среда сценариев Windows PowerShell.

**Что работает иначе?**

Интегрированная среда сценариев Windows PowerShell 2.0 не распознает эти параметры командной строки.

### <a name="BKMK_NewEditorFeatures"></a>Новые возможности редактора
**Добавлено в PowerShell 3.0**

Другие возможности редактирования в интегрированной среде сценариев Windows PowerShell:

-   **Цветовая разметка синтаксиса XML**. Теперь в интегрированной среде сценариев Windows PowerShell синтаксис XML выделяется цветами, как в Windows PowerShell.

-   **Парные фигурные скобки**. В интегрированной среде сценариев Windows PowerShell реализованы контроль соответствия и подсветка скобок. (Например, команда **Перейти к совпадению** или сочетание клавиш **Ctrl \+ ]** позволяют найти закрывающую скобку, если выделена открывающая скобка.)

-   **Режим структуры**. Область сценариев теперь поддерживает режим структуры, который позволяет сворачивать и разворачивать фрагменты кода, щелкая знаки "минус" или "плюс" на левом поле. Обозначать начало и конец сворачиваемого фрагмента кода можно с помощью скобок или тегов **\#region** и **\#endregion**. Чтобы развернуть или свернуть все области, нажмите клавиши **CTRL\+M**.

-   **Перетаскивание текста при правке**. Теперь интегрированная среда сценариев Windows PowerShell поддерживает перетаскивание текста при правке. Можно выбрать любой блок текста и перетащить его в другое место в редакторе или консоли. Если при перетаскивании удерживать нажатой клавишу CTRL, текст копируется в новое расположение. В этой, а также в предыдущей версии интегрированной среды сценариев Windows PowerShell при перетаскивании файла в интегрированную среду сценариев Windows PowerShell этот файл открывается.

-   **Отображение ошибок анализа**. Ошибки анализа подчеркиваются красным цветом. При наведении указателя мыши на подчеркнутую ошибку отображается подсказка, поясняющая суть обнаруженной проблемы.

-   **Масштаб**. Устанавливать масштаб отображения содержимого консоли в процентах можно с помощью ползунка масштаба (в правом нижнем углу окна интегрированной среды сценариев Windows PowerShell) или ввода команды **$psise.options.Zoom** в области консоли.

-   **Копирование и вставка форматированного текста**. Теперь при копировании в буфер обмена интегрированной среды сценариев Windows PowerShell сохраняется исходное начертание, размер и цвет шрифта выделенного текста.

-   **Выделение блока**. Можно выделить блок текста, удерживая клавишу ALT при выделении текста мышью в области сценариев или нажимая клавиши **ALT\+SHIFT\+СТРЕЛКА**.

**Какой эффект дает это изменение?**

Дополнительные возможности редактирования помогают получить более согласованную и эффективную среду редактирования.

**Что работает иначе?**

Эти усовершенствования редактирования отсутствовали в интегрированной среде сценариев Windows PowerShell 2.0.

### <a name="BKMK_NewHelpViewer"></a>Новое окно справки
**Добавлено в PowerShell 3.0**

Если нажать клавишу **F1**, когда курсор находится внутри командлета или выделена часть командлета, в новом окне справки откроется контекстная\-справка по выделенному командлету. Чтобы вывести описательные разделы справки Windows PowerShell, введите команду **operators** в области консоли, а затем нажмите клавишу **F1**.

Прежде чем пользоваться этой функцией, загрузите последнюю версию разделов справки Windows PowerShell с веб-сайта Майкрософт. Разделы справки проще всего скачать, выполнив командлет **Update\-Help** в области консоли при запуске интегрированной среды сценариев Windows PowerShell от имени администратора.

Где указать, откуда именно берется справка, вызываемая клавишей **F1**. В разделе **Другие параметры** на вкладке **Общие параметры** в меню **Сервис**\/**Параметры** можно установить или снять флажок **Использовать локальную справку вместо справки в Интернете**. Если этот флажок установлен, клиент ищет справку по командлету в скачанных файлах, находящихся в папке модулей.  Если флажок снят, клиент ищет справку в библиотеке TechNet.

**Какой эффект дает это изменение?**

Получение\-контекстной справки без выхода из командлета или сценария повышает эффективность и согласованность обучения.

**Что работает иначе?**

При нажатии клавиши F1 в предыдущих версиях интегрированной среды сценариев Windows PowerShell открывался файл справки с локального компьютера. В интегрированной среде сценариев Windows PowerShell 3.0 и более поздних версий открывшееся окно содержит справку, поддерживающую поиск и настройку. Это новая справка по интегрированной среде сценариев Windows PowerShell ISE 3.0, в Windows PowerShell 3.0 появилась обновленная справка.

### <a name="BKMK_ShowCommand"></a>Командлет Show\-Command
**Добавлено в PowerShell 3.0**

Командлет **Show\-Command** позволяет составить или выполнить командлет или функцию, заполнив графическую форму. Эта форма дает пользователям возможность работать с Windows PowerShell в графической среде. Кроме того, командлет **Show\-Command** позволяет опытным сценарным программистам быстро создавать графические интерфейсы на основе Windows PowerShell.

**Какой эффект дает это изменение?**

Используя командлет **Show\-Command** в сценариях Windows PowerShell, вы можете предоставить пользователям привычную графическую среду. Кроме того, **Show\-Command** помогает новичкам осваивать Windows PowerShell.

**Что работает иначе?**

Командлет Show\-Command — новинка интегрированной среды сценариев Windows PowerShell 3.0.

## <a name="BKMK_LINKS"></a>См. также:
Дополнительные сведения об интегрированной среде сценариев в Windows PowerShell см. по следующим ссылкам.

-   [Using the Windows PowerShell Integrated Scripting Environment (Использование интегрированной среды сценариев Windows PowerShell)](../core-powershell/ise/Using-the-Windows-PowerShell-ISE.md)

-   [Интегрированная среда сценариев на вики-сайте TechNet](http://social.technet.microsoft.com/wiki/search/searchresults.aspx?q=ISE)

-   [Центр сценариев](http://technet.microsoft.com/scriptcenter/default)




<!--HONumber=Jun16_HO4-->


