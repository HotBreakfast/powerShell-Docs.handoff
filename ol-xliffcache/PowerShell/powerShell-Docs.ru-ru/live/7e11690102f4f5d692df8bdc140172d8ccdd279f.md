---
title: Новые возможности Windows PowerShell
ms.custom: na
ms.reviewer: na
ms.suite: na
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 1476722e-947e-425d-a86c-50037488dc6e
---
# Новые возможности Windows PowerShell
[!INCLUDE[wps_1](../Token/wps_1_md.md)] 5.0 включает несколько важных новых функций, расширяющих возможности использования и позволяющих более просто и полно контролировать среды на основе Windows и управлять ими.

[!INCLUDE[wps_2](../Token/wps_2_md.md)] 5.0 обеспечивает обратную совместимость. Командлеты, поставщики, модули, оснастки, сценарии, функции и профили, предназначенные для [!INCLUDE[psversion4](../Token/psversion4_md.md)], [!INCLUDE[psversion3](../Token/psversion3_md.md)] и [!INCLUDE[psversion2](../Token/psversion2_md.md)], обычно работают в [!INCLUDE[wps_2](../Token/wps_2_md.md)] 5.0 без изменений.

[!INCLUDE[wps_2](../Token/wps_2_md.md)] 5.0 устанавливается по умолчанию как в [!INCLUDE[winthreshold_server_1](../Token/winthreshold_server_1_md.md)], так и в [!INCLUDE[winthreshold_client_1](../Token/winthreshold_client_1_md.md)]. Чтобы установить [!INCLUDE[wps_2](../Token/wps_2_md.md)] 5.0 в [!INCLUDE[winblue_server_2](../Token/winblue_server_2_md.md)], [!INCLUDE[winblue_client_ent_2](../Token/winblue_client_ent_2_md.md)] или [!INCLUDE[winblue_client_pro_2](../Token/winblue_client_pro_2_md.md)], скачайте и установите [Windows Management Framework 5.0](http://go.microsoft.com/fwlink/?LinkID=395058). Прежде чем устанавливать Windows Management Framework 5.0, прочтите сведения о скачивании и убедитесь, что все требования к системе выполнены.

## В этом разделе

-   [Обновления для DSC Windows PowerShell 4.0 в статье базы знаний 3000850](#BKMK_3000850)

-   [Новые функции в Windows PowerShell 5.0](#BKMK_new50)

-   [Новые функции в Windows PowerShell 4.0](#BKMK_wps4)

-   [Новые функции в Windows PowerShell 3.0](#BKMK_wps3)

## <a name="BKMK_3000850"></a> Обновления Windows PowerShell 4.0 в накопительном пакете обновления за ноябрь 2014 года (статья базы знаний 3000850)
[Накопительный пакет обновления за ноябрь 2014 года для Windows RT 8.1, Windows 8.1 и Windows Server 2012 R2](https://support.microsoft.com/kb/3000850/) (статья базы знаний 3000850) содержит множество обновлений и улучшений для службы настройки требуемого состояния (DSC) [!INCLUDE[wps_2](../Token/wps_2_md.md)] в [!INCLUDE[wps_2](../Token/wps_2_md.md)] 4.0. Чтобы определить, установлено ли в вашей системе обновление из статьи 3000850, выполните `Get-Hotfix -Id KB3000850` в [!INCLUDE[wps_2](../Token/wps_2_md.md)].

-   Обновления для существующих командлетов в модуле [PSDesiredStateConfiguration](https://technet.microsoft.com/library/dn391651(v=wps.640).aspx):

    -   [Get-DscResource](http://technet.microsoft.com/library/dn521625.aspx) работает быстрее (особенно в интегрированной среде сценариев).

    -   [Start-DscConfiguration](http://technet.microsoft.com/library/dn521623.aspx) имеет новый параметр -UseExisting, который повторно применяет последнюю конфигурацию.

    -   Исправлена работа параметра -Force для [Start-DscConfiguration](http://technet.microsoft.com/library/dn521623.aspx).

    -   [Get-DscLocalConfigurationManager](http://technet.microsoft.com/library/dn407378.aspx) отображает больше полезной информации о состоянии подсистемы.

    -   [Test-DscConfiguration](http://technet.microsoft.com/library/dn407382.aspx) теперь возвращает имя компьютера вместе со значением True или False.

    -   [New-DscChecksum](http://technet.microsoft.com/library/dn521622.aspx) теперь поддерживает пути UNC.

-   Новые командлеты в модуле [PSDesiredStateConfiguration](http://technet.microsoft.com/library/dn391651(v=wps.640).aspx):

    -   [Update-DscConfiguration](http://technet.microsoft.com/library/mt143541(v=wps.630).aspx) выполняет проверку опрашивающего сервера по запросу.

    -   [Stop-DscConfiguration](http://technet.microsoft.com/library/mt143542(v=wps.630).aspx) останавливает уже выполняемую конфигурацию.

    -   [Remove-DscConfigurationDocument](http://technet.microsoft.com/library/mt143544(v=wps.630).aspx) позволяет удалять документы конфигурации на разных этапах (ожидающий, предыдущий и текущий).

-   Усовершенствования языка:

    -   DependsOn теперь поддерживает составные ресурсы.

    -   DependsOn теперь поддерживает числа в именах экземпляров ресурса.

    -   Выражения узла, результатом вычисления которых является пустое значение, больше не приводят к ошибкам.

    -   Исправлена ошибка, возникающая, когда вычисление выражения узла дает пустой результат.

    -   Конфигурации, вызывающие другие конфигурации, теперь работают в консоли [!INCLUDE[wps_2](../Token/wps_2_md.md)].

-   Усовершенствования режима опроса:

    -   Режим опроса теперь поддерживает все ZIP-файлы.

    -   **AllowModuleOverwrite** теперь работает правильно.

-   Усовершенствования устойчивости

    -   Новый **DebugMode** позволяет повторно загружать модули ресурсов.

    -   В случае сбоя конфигурации файл pending.mof не удаляется.

    -   Локальный диспетчер конфигурации (LCM) стал более устойчивым к повреждению параметров метаконфигурации.

-   Усовершенствования диагностики:

    -   Когда локальный диспетчер конфигурации задает для таймера значения, отличные от указанных вами, отображается предупреждение.

    -   Файлы журнала ошибок теперь содержат стек вызовов для ресурсов [!INCLUDE[wps_2](../Token/wps_2_md.md)].

-   Усовершенствования гибкости:

    -   Ресурс LocalConfigurationManager имеет новое свойство **ActionAfterReboot**.

        -   ContinueConfiguration (значение по умолчанию): автоматически возобновляет конфигурацию после перезапуска целевого узла.

        -   StopConfiguration: не возобновляет конфигурацию автоматически после перезапуска узла.

    -   Проверку согласованности теперь можно выполнять чаще, чем операцию PULL, и наоборот.

    -   Поддержка управления версиями: теперь DSC может распознать документ, созданный в более новой версии клиента (входит в состав [предварительной версии WMF 5.0](http://go.microsoft.com/fwlink/?LinkID=395058)).

-   Усовершенствования предотвращения ошибок:

    -   Версия модуля теперь применяется принудительно до применения конфигурации.

    -   **DebugPreference** теперь работает правильно для вызовов Get-, Set- или Test-TargetResource.

-   Усовершенствования обработки учетных данных:

    -   Сертификат теперь используется, если указан как **Certificate**, так и **PSDscAllowPlainTextPassword**.

    -   Учетные данные расшифровываются даже для Get-TargetResource.

    -   Учетные данные метаконфигурации зашифровываются и расшифровываются.

    -   PSCredential теперь расшифровываются, если находятся во внедренном объекте.

-   Улучшения встроенных ресурсов:

    -   Ресурс Package:

        -   больше не устанавливает неправильный пакет (из локальных или интернет-источников);

        -   теперь поддерживает протокол HTTPS.

    -   Теперь в [ресурсе Package](http://technet.microsoft.com/library/dn282132.aspx) реализована поддержка протокола HTTPS.

    -   [Ресурс Archive](http://technet.microsoft.com/library/dn249917.aspx) теперь поддерживает учетные данные.

## <a name="BKMK_new50"></a> Новые функции в Windows PowerShell 5.0

-   [Новые функции в Windows PowerShell](#BKMK_newcore)

-   [Новые функции для настройки требуемого состояния Windows PowerShell](#BKMK_newDSC)

-   [Новые функции в интегрированной среде сценариев Windows PowerShell](#BKMK_newISE)

-   [Новые функции в веб-службах Windows PowerShell](#BKMK_newOData)

-   [Исправления важных ошибок в Windows PowerShell 5.0](#BKMK_5bugfix)

### <a name="BKMK_newcore"></a> Новые функции в Windows PowerShell

-   Начиная с [!INCLUDE[wps_2](../Token/wps_2_md.md)] 5.0, разработку можно вести с использованием классов, формального синтаксиса и семантики, которые похожи на другие объектно-ориентированные языки программирования. Для поддержки новой функции в язык [!INCLUDE[wps_2](../Token/wps_2_md.md)] были добавлены **Class**, **Enum** и другие ключевые слова. Дополнительные сведения о работе с классами см. в статье "about_Classes".

-   В [!INCLUDE[wps_2](../Token/wps_2_md.md)] 5.0 для передачи структурированных данных между сценарием и вызывающими его объектами (или средой внешнего размещения) можно использовать новый структурированный информационный поток. Теперь можно использовать Write-Host для вывода выходных данных в информационный поток. Информационные потоки также работают для PowerShell.Streams, заданий, запланированных заданий и рабочих процессов. Следующие функции поддерживают информационный поток.

    -   Новый командлет Write-Information, позволяющий указать, как [!INCLUDE[wps_2](../Token/wps_2_md.md)] обрабатывает данные информационного потока для команды. Write-Host является программой-оболочкой для Write-Information. Write-Information также является поддерживаемым действием рабочего процесса.

    -   Два новых общих параметра — InformationVariable и InformationAction — позволяют настроить отображение информационных потоков из команды. Допустимыми значениями для InformationAction являются SilentlyContinue, Stop, Continue, Inquire, Ignore и Suspend, при этом Continue используется по умолчанию. InformationVariable указывает строку как имя переменной, в которую требуется сохранить данные Write-Host из команды.

    -   Новая привилегированная переменная InformationPreference задает настройку по умолчанию для данных информационного потока в сеансе [!INCLUDE[wps_2](../Token/wps_2_md.md)]. Значение по умолчанию — Continue.

    -   Были добавлены два новых общих параметра рабочего процесса — PSInformation и InformationAction.

    -   Теперь при использовании команды Format-Table столбцы таблицы автоматически форматируются с учетом первых 300 мс данных, проходящих через поток.

-   При сотрудничестве с [Microsoft Research](http://research.microsoft.com/) был добавлен новый командлет ConvertFrom-String. ConvertFrom-String позволяет извлекать и анализировать структурированные объекты из содержимого текстовых строк. Дополнительные сведения см. в статье ConvertFrom-String.

-   Новый командлет Convert-String автоматически форматирует текст согласно примеру, указанному в параметре -Example.

-   Новый модуль Microsoft.PowerShell.Archive содержит командлеты, позволяющие сжимать файлы и папки в архивы (которые также называют ZIP-файлами), извлекать файлы из существующих ZIP-файлов и обновлять ZIP-файлы с использованием более поздних версий содержащихся в них файлов.

-   Новый модуль PackageManagement позволяет обнаруживать и устанавливать программные пакеты через Интернет. Модуль PackageManagement (ранее OneGet) — это диспетчер или мультиплексор существующих диспетчеров пакетов (также называемых поставщиками пакетов), который унифицирует управление пакетами Windows с помощью единого интерфейса Windows PowerShell.

-   Новый модуль PowerShellGet позволяет искать, устанавливать, публиковать и обновлять модули и ресурсы DSC в [коллекции PowerShell](http://www.powershellgallery.com/) или во внутреннем репозитории модулей, который можно настроить с помощью командлета Register-PSRepository.

-   Добавлено новое ключевое слово языка **Hidden**, чтобы указать, что элемент (свойство или метод) не отображаются по умолчанию в результатах Get-Member (если только не задан параметр -Force). Свойства или методы, которые были помечены как скрытые, также не отображаются в результатах IntelliSense, если только не используется контекст, где элемент должен быть видимым. Например, автоматическая переменная $This должна показывать скрытые элементы при использовании в методе класса.

-   New-Item, Remove-Item и Get-ChildItem были усовершенствованы, чтобы поддерживать создание [символических ссылок](http://en.wikipedia.org/wiki/Symbolic_link) и управление ими. Параметр **ItemType** для New-Item принимает новое значение **SymbolicLink**. Теперь символьные ссылки можно создавать в отдельной строке с помощью командлета New-Item.

-   Get-ChildItem также получил новый параметр -Depth, используемый вместе с параметром -Recurse для ограничения рекурсии. Например, Get-ChildItem -Recurse -Depth 2 возвращает результаты из текущей папки, всех дочерних папок внутри нее и всех вложенных в них папок.

-   Copy-Item теперь позволяет копировать файлы или папки из одного сеанса [!INCLUDE[wps_2](../Token/wps_2_md.md)] в другой. Таким образом, файлы можно копировать в сеансы, подключенные к удаленным компьютерам (включая компьютеры под управлением [Nano Windows Server](http://blogs.technet.com/b/windowsserver/archive/2015/04/08/microsoft-announces-nano-server-for-modern-apps-and-cloud.aspx), не имеющие другого интерфейса). Чтобы скопировать файлы, укажите идентификаторы PSSession в качестве значения новых параметров -FromSession и -ToSession, а также добавьте -Path и -Destination, чтобы указать исходный путь и назначение, соответственно. Например, Copy-Item -Path c:\myFile.txt -ToSession $s -Destination d:\destinationFolder.

-   Транскрибирование [!INCLUDE[wps_2](../Token/wps_2_md.md)] было улучшено и теперь распространяется на все ведущие приложения (например интегрированную среду сценариев [!INCLUDE[wps_2](../Token/wps_2_md.md)]), а не только узел консоли (**powershell.exe**). Параметры транскрибирования (в том числе включение записи во всей системе) можно настроить с помощью параметра групповой политики **Включить транскрипции PowerShell**, который находится в разделе "Административные шаблоны/Компоненты Windows/[!INCLUDE[wps_2](../Token/wps_2_md.md)]".

-   Новая функция подробной трассировки сценариев позволяет включить подробное отслеживание и анализ для используемых в системе сценариев [!INCLUDE[wps_2](../Token/wps_2_md.md)]. После включения этой функции [!INCLUDE[wps_2](../Token/wps_2_md.md)] регистрирует все блоки сценариев в журнале событий трассировки Windows — **Microsoft-Windows-PowerShell/Operational**.

-   Начиная с [!INCLUDE[wps_2](../Token/wps_2_md.md)] 5.0, командлеты Cryptographic Message Syntax поддерживают шифрование и расшифровку содержимого с помощью стандартного формата IETF для криптографической защиты сообщений, задокументированного в [RFC5652](http://tools.ietf.org/html/rfc5652). Командлеты Get-CmsMessage, Protect-CmsMessage и Unprotect-CmsMessage были добавлены в модуль [Microsoft.PowerShell.Security](http://technet.microsoft.com/library/hh849807.aspx) .

-   Новые командлеты в модуле [Microsoft.PowerShell.Utility](http://technet.microsoft.com/library/hh849958.aspx) — Get-Runspace, Debug-Runspace, Get-RunspaceDebug, Enable-RunspaceDebug и Disable-RunspaceDebug — позволяют задать параметры отладки для пространства выполнения, а также запускать и останавливать отладку в нем. Для отладки произвольных пространств выполнения, то есть тех, которые не используются по умолчанию для консоли [!INCLUDE[wps_2](../Token/wps_2_md.md)] или сеанса интегрированной среды сценариев [!INCLUDE[wps_2](../Token/wps_2_md.md)], [!INCLUDE[wps_2](../Token/wps_2_md.md)] позволяет задавать точки останова в сценарии. Кроме того, доступны дополнительные точки для останова выполнения сценария, чтобы можно было подключить отладчик и отладить сценарий пространства выполнения. В отладчик сценариев [!INCLUDE[wps_2](../Token/wps_2_md.md)] для пространств выполнения добавлена поддержка вложенной отладки для произвольных пространств выполнения.

-   В модуль [Microsoft.PowerShell.Utility](http://technet.microsoft.com/library/hh849958.aspx) добавлен командлет Format-Hex. Format-Hex позволяет просматривать текст или двоичные данные в шестнадцатеричном формате.

-   В модуль [Microsoft.PowerShell.Utility](http://technet.microsoft.com/library/hh849958.aspx) добавлены командлеты Get-Clipboard и Set-Clipboard, упрощающие перенос содержимого в сеанс [!INCLUDE[wps_2](../Token/wps_2_md.md)] и из него. Командлеты Clipboard поддерживают изображения, звуковые файлы, списки файлов и текст.

-   В модуль [Microsoft.PowerShell.Management](http://technet.microsoft.com/library/hh849827(v=wps.640).aspx) добавлен командлет Clear-RecycleBin, очищающий корзину для фиксированного диска, включающего в себя внешние диски. По умолчанию вам предлагается подтвердить команду Clear-RecycleBin, так как для свойства ConfirmImpact командлета задано значение ConfirmImpact.High.

-   Новый командлет New-TemporaryFile позволяет создать временный файл во время создания сценария. По умолчанию временный файл создается в папке C:\Users\<user name>\AppData\Local\Temp.

-   Теперь командлеты Out-File, Add-Content и Set-Content имеют новый параметр -NoNewline, который пропускает перевод на новую строку после выходных данных.

-   Командлет New-Guid использует класс Guid .NET Framework для создания идентификатора GUID, что удобно при создании сценариев или ресурсов DSC.

-   Так как сведения о версии файла могут вводить пользователя в заблуждение, особенно после исправления файла, для объектов FileInfo доступны новые свойства сценария FileVersionRaw и ProductVersionRaw. Например, можно выполнить следующую команду, чтобы отобразить значения этих свойств для PowerShell.exe, где $pid содержит идентификатор процесса для открытого сеанса Windows PowerShell: Get-Process -Id $pid -FileVersionInfo | Format-List *версия* -Force

-   Новые командлеты Enter-PSHostProcess и Exit-PSHostProcess позволяют отлаживать сценарии [!INCLUDE[wps_2](../Token/wps_2_md.md)] в процессах отдельно от текущего процесса, выполняемого в консоли [!INCLUDE[wps_2](../Token/wps_2_md.md)]. Запустите Enter-PSHostProcess, чтобы ввести определенный идентификатор процесса или подключиться к нему, а затем запустите Get-Runspace, чтобы возвратить активные пространства выполнения внутри этого процесса. После окончания отладки сценария в процессе запустите Exit-PSHostProcess, чтобы отключиться от него.

-   В модуль [Microsoft.PowerShell.Utility](http://technet.microsoft.com/library/hh849958.aspx) добавлен командлет Wait-Debugger. Wait-Debugger можно запустить, чтобы остановить сценарий в отладчике перед выполнением следующего оператора сценария.

-   Отладчик рабочих процессов [!INCLUDE[wps_2](../Token/wps_2_md.md)] теперь поддерживает завершение команды или вкладки, а также допускает отладку вложенных функций рабочего процесса. Теперь можно нажать клавиши **CTRL+BREAK** для открытия отладчика в выполняемом сценарии как для локального, так и для удаленного сеанса, а также в сценарии рабочего процесса.

-   В модуль [Microsoft.PowerShell.Core](http://technet.microsoft.com/library/hh849695.aspx) добавлен командлет Debug-Job, обеспечивающий отладку выполняемых сценариев заданий для рабочего процесса [!INCLUDE[wps_2](../Token/wps_2_md.md)], фонового процесса, а также заданий, выполняемых в удаленных сеансах.

-   Для заданий [!INCLUDE[wps_2](../Token/wps_2_md.md)] добавлено новое состояние AtBreakpoint. Оно применяется, когда задание выполняет сценарий с заданными точками останова и была достигнута такая точка. При остановке задания в точке останова отладки необходимо отладить задание, запустив командлет Debug-Job.

-   [!INCLUDE[wps_2](../Token/wps_2_md.md)] 5.0 реализует поддержку нескольких версий модуля [!INCLUDE[wps_2](../Token/wps_2_md.md)] в одной папке внутри $PSModulePath. Для класса ModuleSpecification добавлено свойство RequiredVersion, помогающее получить нужную версию модуля. Это свойство является взаимоисключающим со свойством ModuleVersion. RequiredVersion теперь поддерживается как часть значения параметра FullyQualifiedName для командлетов Get-Module, Import-Module и Remove-Module.

-   Теперь проверку версии модуля можно выполнить, запустив командлет Test-ModuleManifest.

-   Результаты командлета Get-Command теперь содержат столбец Version, так как в класс CommandInfo добавлено свойство Version. Get-Command показывает команды из нескольких версий одного модуля. Свойство Version также является частью производных классов CmdletInfo: CmdletInfo и ApplicationInfo.

-   Get-Command имеет новый параметр -ShowCommandInfo, возвращающий сведения ShowCommand в виде объектов PSObject. Это особенно удобно, когда Show-Command выполняется в интегрированной среде сценариев [!INCLUDE[wps_2](../Token/wps_2_md.md)] с использованием удаленного взаимодействия [!INCLUDE[wps_2](../Token/wps_2_md.md)]. Параметр -ShowCommandInfo заменяет функцию Get-SerializedCommand в модуле Microsoft.PowerShell.Utility, но сценарий Get-SerializedCommand по-прежнему доступен для поддержки сценариев нижнего уровня.

-   Новый командлет Get-ItemPropertyValue позволяет получить значение свойства без использования точечной нотации. Например, в более старых версиях [!INCLUDE[wps_2](../Token/wps_2_md.md)] можно выполнить следующую команду, чтобы получить значение свойства Application Base для раздела реестра PowerShellEngine: **(Get-ItemProperty -Path HKLM:\SOFTWARE\Microsoft\PowerShell\3\PowerShellEngine -Name ApplicationBase).ApplicationBase**. Начиная с [!INCLUDE[wps_2](../Token/wps_2_md.md)] 5.0, можно выполнить команду **Get-ItemPropertyValue -Path HKLM:\SOFTWARE\Microsoft\PowerShell\3\PowerShellEngine -Name ApplicationBase**.

-   Теперь консоль [!INCLUDE[wps_2](../Token/wps_2_md.md)] использует такую же цветовую разметку синтаксиса, как и в интегрированной среде сценариев [!INCLUDE[wps_2](../Token/wps_2_md.md)].

-   Новый модуль NetworkSwitch содержит командлеты, позволяющие применять конфигурацию коммутатора, виртуальной локальной сети и портов базового сетевого коммутатора уровня 2 к сетевым коммутаторам, прошедшим сертификацию для [!INCLUDE[winblue_server_2](../Token/winblue_server_2_md.md)].

-   Для командлетов Import-Module и Remove-Module добавлен параметр FullyQualifiedName, позволяющий хранить несколько версий одного модуля.

-   Командлеты Save-Help, Update-Help, Import-PSSession, Export-PSSession и Get-Command имеют новый параметр FullyQualifiedModule типа ModuleSpecification. Добавьте этот параметр, чтобы указать модуль по полному имени.

-   Значение **$PSVersionTable.PSVersion** обновлено до 5.0.

### <a name="BKMK_newDSC"></a> Новые функции для настройки требуемого состояния Windows PowerShell

-   Усовершенствования языка [!INCLUDE[wps_2](../Token/wps_2_md.md)] позволяют определять ресурсы настройки требуемого состояния (DSC) [!INCLUDE[wps_2](../Token/wps_2_md.md)] с помощью классов. Import-DscResource теперь является подлинным динамическим ключевым словом. [!INCLUDE[wps_2](../Token/wps_2_md.md)] анализирует корневой модуль указанного модуля, выполняя поиск классов, которые содержат атрибут DscResource. Теперь классы можно использовать для определения ресурсов DSC, в которых не требуется ни MOF-файл, ни вложенная папка DSCResource в папке модуля. Файл модуля [!INCLUDE[wps_2](../Token/wps_2_md.md)] может содержать несколько классов ресурсов DSC.

-   Добавлен новый параметр ThrottleLimit для указанных ниже командлетов в модуле PSDesiredStateConfiguration. Он позволяет указать число конечных компьютеров или устройств, на которых команда должны выполняться одновременно.

    -   Get-DscConfiguration

    -   Get-DscConfigurationStatus

    -   Get-DscLocalConfigurationManager

    -   Restore-DscConfiguration

    -   Test-DscConfiguration

    -   Compare-DscConfiguration

    -   Publish-DscConfiguration

    -   Set-DscLocalConfigurationManager

    -   Start-DscConfiguration

    -   Update-DscConfiguration

-   Централизованное ведение отчетов об ошибках DSC позволяет не только заносить полные сведения об ошибке в журнал событий, но и отправлять их в центральное расположение для дальнейшего анализа. В этом центральном расположении можно хранить ошибки конфигурации DSC для любого сервера в среде. После определения сервера отчетов в метаконфигурации все ошибки отправляются на этот сервер, а затем сохраняются в базе данных. Эту функцию можно настроить независимо от того, настроен ли целевой узел для извлечения конфигураций с опрашивающего сервера.

-   Усовершенствования, направленные на упрощение создания ресурсов DSC в интегрированной среде сценариев [!INCLUDE[wps_2](../Token/wps_2_md.md)]. Теперь вам доступны следующие операции:

    -   Вывод всех ресурсов DSC в блоке **configuration** или **node** путем нажатия клавиш **CTRL+ПРОБЕЛ** на пустой строке внутри него.

    -   Автозаполнение свойств ресурсов, имеющих тип **enumeration**.

    -   Автозаполнение в свойстве **DependsOn** ресурсов DSC, основанное на других экземплярах ресурсов в конфигурации.

    -   Улучшенное заполнение нажатием клавиши TAB для значений свойств ресурсов.

-   Теперь пользователь может запустить ресурс с заданным набором учетных данных, добавив атрибут **PSDscRunAsCredential** в блок узла. Например, PSDscRunAsCredential = Get-Credential Contoso\DscUser. Эта функция удобна для создания конфигураций, запускающих установщик Windows и исполняемые программы установки, обращающихся к кусту реестра для конкретного пользователя или выполняющих другие задачи вне контекста текущего пользователя.

-   Для ключевого слова **Configuration** добавлена 32-разрядная поддержка (на базе x86).

-   Теперь [!INCLUDE[wps_2](../Token/wps_2_md.md)] поддерживает специальную справку для конфигураций DSC, определенных путем добавления [CmdletBinding()] в созданную функцию конфигурации.

-   Новый атрибут **DscLocalConfigurationManager** определяет блок конфигурации как метаконфигурацию, которая используется для настройки локального диспетчера конфигураций (LCM) DSC. Этот атрибут ограничивает конфигурацию, допуская только элементы для настройки локального диспетчера конфигураций DSC. Во время обработки эта конфигурация создает файл *.meta.mof, который затем отправляется на соответствующие целевые узлы с помощью командлета Set-DscLocalConfigurationManager.

-   Теперь в [!INCLUDE[wps_2](../Token/wps_2_md.md)] 5.0 разрешены частичные конфигурации. Доставлять документы конфигурации на узел можно фрагментами. Чтобы узел получил несколько фрагментов документа конфигурации, сначала следует настроить его локальный диспетчер конфигураций для указания ожидаемых фрагментов:

-   В DSC для [!INCLUDE[wps_2](../Token/wps_2_md.md)] 5.0 появилась возможность межкомпьютерной синхронизации. Встроенные ресурсы WaitFor* (**WaitForAll**, **WaitForAny** и **WaitForSome**) позволяют указать зависимости между компьютерами во время выполнения конфигурации без внешней оркестрации. Эти ресурсы обеспечивают синхронизацию между узлами с помощью CIM-подключений по протоколу WS-Man. Конфигурация может ожидать изменения состояния определенного ресурса на другом компьютере.

-   JEA-администрирование — новое средство обеспечения безопасности при делегировании — использует DSC и ограниченные пространства выполнения [!INCLUDE[wps_2](../Token/wps_2_md.md)], чтобы защитить предприятие от потери данных и умышленной или случайной компрометации их сотрудниками. Дополнительные сведения о JEA, включая сведения о том, где можно скачать ресурс DSC xJEA, см. в статье [Just Enough Administration, Step by Step](http://blogs.technet.com/b/privatecloud/archive/2014/05/14/just-enough-administration-step-by-step.aspx) (JEA-администрирование — шаг за шагом).

-   В модуль PSDesiredStateConfiguration добавлены следующие командлеты:

    -   Командлет Get-DscConfigurationStatus получает высокоуровневые сведения о состоянии конфигурации с целевого узла. Вы можете получить состояние последней или всех конфигураций.

    -   Командлет Compare-DscConfiguration сравнивает указанную конфигурацию с фактическим состоянием одного или нескольких целевых узлов.

    -   Командлет Publish-DscConfiguration копирует MOF-файл на целевой узел без применения конфигурации. Она применяется во время следующей проверки согласованности или при запуске командлета Update-DscConfiguration.

    -   Новый командлет Test-DscConfiguration позволяет убедиться, что полученная конфигурация соответствует требуемой. Он возвращает значение True, если фактическая конфигурации соответствует требуемой, или значение False в противном случае.

    -   Новый командлет Update-DscConfiguration выполняет принудительную обработку конфигурации. Если локальный диспетчер конфигураций находится в режиме опроса, командлет получает конфигурацию с опрашивающего сервера перед ее применением.

### <a name="BKMK_newISE"></a> Новые функции в интегрированной среде сценариев Windows PowerShell

-   Теперь можно редактировать удаленные сценарии и файлы [!INCLUDE[wps_2](../Token/wps_2_md.md)] в локальной копии интегрированной среды сценариев [!INCLUDE[wps_2](../Token/wps_2_md.md)], выполнив Enter-PSSession для открытия удаленного сеанса на компьютере с нужными файлами, а затем выполнив **PSEdit<path and file name on the remote computer>**. Эта функция упрощает редактирование файлов [!INCLUDE[wps_2](../Token/wps_2_md.md)], хранящихся в Windows Server только с основными серверными компонентами, где запуск интегрированной среды сценариев [!INCLUDE[wps_2](../Token/wps_2_md.md)] невозможен.

-   Теперь командлет Start-Transcript поддерживается в интегрированной среде сценариев [!INCLUDE[wps_2](../Token/wps_2_md.md)].

-   Можно отлаживать удаленные сценарии [!INCLUDE[wps_2](../Token/wps_2_md.md)] в интегрированной среде сценариев.

-   Новая команда меню **Прервать все** (CTRL+B) переключается в режим отладчика как для локальных, так и для удаленных сценариев.

### <a name="BKMK_newOData"></a> Новая функция в веб-службах Windows PowerShell (расширение IIS OData для управления)

-   Начиная с [!INCLUDE[wps_2](../Token/wps_2_md.md)] 5.0, можно создать набор командлетов [!INCLUDE[wps_2](../Token/wps_2_md.md)] на основе функциональности, предоставляемой заданной конечной точкой OData. Для этого используется командлет Export-ODataEndpointProxy, доступный в новом модуле [Microsoft.PowerShell.OdataUtils](http://technet.microsoft.com/library/dn818507(v=wps.640).aspx).

### <a name="BKMK_5bugfix"></a> Исправления важных ошибок в Windows PowerShell 5.0

-   [!INCLUDE[wps_2](../Token/wps_2_md.md)] 5.0 содержит новую реализацию COM, обеспечивающую значительное повышение производительности при работе с COM-объектами. Видеодемонстрация этого эффекта приведена на странице [Com_Perf_Improvements](http://1drv.ms/1qu3UPZ).

-   Была значительно повышена производительность при первом заполнении нажатием клавиши TAB в сеансе [!INCLUDE[wps_2](../Token/wps_2_md.md)]. Время завершения сократилось почти на 500 мс.

## <a name="BKMK_wps4"></a> Новые функции в Windows PowerShell 4.0
[!INCLUDE[psversion4](../Token/psversion4_md.md)] обеспечивает обратную совместимость. Командлеты, поставщики, модули, оснастки, сценарии, функции и профили, предназначенные для [!INCLUDE[psversion3](../Token/psversion3_md.md)] и [!INCLUDE[psversion2](../Token/psversion2_md.md)], работают в [!INCLUDE[psversion4](../Token/psversion4_md.md)] без изменений.

[!INCLUDE[psversion4](../Token/psversion4_md.md)] устанавливается по умолчанию в [!INCLUDE[winblue_client_1](../Token/winblue_client_1_md.md)] и [!INCLUDE[winblue_server_2](../Token/winblue_server_2_md.md)]. Чтобы установить [!INCLUDE[psversion4](../Token/psversion4_md.md)] в Windows 7 с пакетом обновления 1 (SP1) или Windows Server 2008 R2, скачайте и установите [Windows Management Framework 4.0](http://www.microsoft.com/download/details.aspx?id=40855). Перед тем как устанавливать Windows Management Framework 4.0., прочтите сведения о загрузке и убедитесь, что все требования к системе выполнены.

-   [Новые функции в Windows PowerShell](#BKMK_core)

-   [Новые функции в интегрированной среде сценариев Windows PowerShell](#BKMK_ise)

-   [Новые функции в рабочем процессе Windows PowerShell](#BKMK_workflow)

-   [Новые функции в веб-службах Windows PowerShell](#BKMK_psws)

-   [Новые функции в Windows PowerShell Web Access](#BKMK_powwa)

-   [Исправления важных ошибок в Windows PowerShell 4.0](#BKMK_bugs)

[!INCLUDE[psversion4](../Token/psversion4_md.md)] включает приведенные ниже новые функции.

### <a name="BKMK_core"></a> Новые функции в Windows PowerShell

-   **Служба настройки требуемого состояния [!INCLUDE[wps_2](../Token/wps_2_md.md)]** является новой системой управления в [!INCLUDE[psversion4](../Token/psversion4_md.md)], которая позволяет развертывать данные конфигурации для программных служб и среды, в которой они выполняются, и управлять ими. Дополнительные сведения о службе настройки требуемого состояния см. в статье [Начало работы со службой настройки требуемого состояния Windows PowerShell](assetId:///c134aa32-b085-4656-9a89-955d8ff768d0).

-   **Save-Help** теперь позволяет сохранять справку по модулям, установленным на удаленных компьютерах. Командлет Save-Help можно использовать для того, чтобы загрузить справку по модулю с подключенного к Интернету клиента (на котором могут быть установлены не все модули, для которых требуется справка), а затем скопировать сохраненную справку в удаленную общую папку или на удаленный компьютер без доступа к Интернету.

-   Улучшенный отладчик [!INCLUDE[wps_2](../Token/wps_2_md.md)] разрешает выполнять отладку рабочих процессов [!INCLUDE[wps_2](../Token/wps_2_md.md)], а также сценариев, выполняющихся на удаленных компьютерах. Рабочие процессы [!INCLUDE[wps_2](../Token/wps_2_md.md)] теперь можно отлаживать на уровне сценария из командной строки [!INCLUDE[wps_2](../Token/wps_2_md.md)] или [!INCLUDE[ise_2](../Token/ise_2_md.md)]. Сценарии [!INCLUDE[wps_2](../Token/wps_2_md.md)], включая рабочие процессы сценариев, теперь можно отлаживать в удаленных сеансах. Сеансы удаленной отладки сохраняются в удаленных сеансах [!INCLUDE[wps_2](../Token/wps_2_md.md)], которые отключаются, а позже подключаются.

-   Параметр **RunNow** для **Register-ScheduledJob** и **Set-ScheduledJob** позволяет не устанавливать дату и время немедленного начала для заданий, используя параметр **Trigger**.

-   **Invoke-RestMethod** и **Invoke-WebRequest** теперь позволяют задать все заголовки с помощью параметра Headers. Хотя этот параметр всегда существовал, он являлся одним из нескольких параметров для веб-командлетов, вызывающих исключения или ошибки.

-   **Get-Module** содержит новый параметр **FullyQualifiedName** типа **ModuleSpecification[]**. Параметр **FullyQualifiedName** Get-Module теперь позволяет указать модуль, используя имя, версию и GUID (необязательно) модуля.

-   Параметр политики выполнения по умолчанию в [!INCLUDE[winblue_server_2](../Token/winblue_server_2_md.md)] — **RemoteSigned**. В [!INCLUDE[winblue_client_2](../Token/winblue_client_2_md.md)] параметр по умолчанию не изменился.

-   Начиная с [!INCLUDE[psversion4](../Token/psversion4_md.md)], поддерживается вызов метода с помощью имен динамических методов. Можно использовать переменную для хранения имени метода, а затем динамически вызвать метод, вызвав переменную.

-   Задания асинхронных рабочих процессов больше не удаляются по истечении времени ожидания, указанного в общем параметре рабочего процесса **PSElapsedTimeoutSec**.

-   Новый параметр **RepeatIndefinitely** добавлен в командлеты **New-JobTrigger** и **Set-JobTrigger**. Это устраняет необходимость указания значения **TimeSpan.MaxValue** для параметра **RepetitionDuration** в целях постоянного запуска запланированного задания в течение неопределенного периода времени.

-   Параметр **Passthru** добавлен в командлеты **Enable-JobTrigger** и **Disable-JobTrigger**. Параметр Passthru отображает все объекты, созданные или измененные вашей командой.

-   Имена параметров для указания рабочей группы в командлетах **Add-Computer** и **Remove-Computer** теперь согласованы. Оба командлета теперь используют параметр **WorkgroupName**.

-   Добавлен новый общий параметр **PipelineVariable**. PipelineVariable позволяет сохранить результаты выведенной команды (или части выведенной команды) как переменную, которую можно передать через оставшуюся часть конвейера.

-   Теперь поддерживается фильтрация коллекции с помощью синтаксиса метода. Это означает, что теперь можно фильтровать коллекцию объектов с помощью упрощенного синтаксиса, аналогичного синтаксису Where() или Where-Object, отформатированному как вызов метода. Ниже приведен пример: (Get-Process).where({$_.Name -match 'powershell'})

-   Командлет **Get-Process** содержит новый параметр-переключатель **IncludeUserName**.

-   Добавлен новый командлет **Get-FileHash**, который возвращает хеш файла в одном из нескольких форматов для указанного файла.

-   В [!INCLUDE[psversion4](../Token/psversion4_md.md)], если модуль использует ключ **DefaultCommandPrefix** в манифесте или если пользователь импортирует модуль с параметром **Prefix**, свойство **ExportedCommands** модуля отображает команды в модуле с префиксом. При выполнении команд с использованием синтаксиса модуля ModuleName\CommandName имена команд должны включать префикс.

-   Значение **$PSVersionTable.PSVersion** обновлено до 4.0.

-   Поведение оператора **Where()** изменено. `Collection.Where('property –match name')`, принимающий строковое выражение в формате `"Property –CompareOperator Value"`, больше не поддерживается. Однако оператор **Where()** принимает строковые выражения в формате блока сценария; эта возможность все еще поддерживается.

### <a name="BKMK_ise"></a> Новые функции в интегрированной среде сценариев Windows PowerShell

-   [!INCLUDE[ise_2](../Token/ise_2_md.md)] поддерживает отладку [!INCLUDE[ps_workflow_2](../Token/ps_workflow_2_md.md)] и отладку удаленных сценариев.

-   Для поставщиков и конфигураций службы настройки требуемого состояния [!INCLUDE[wps_2](../Token/wps_2_md.md)] добавлена поддержка IntelliSense.

### <a name="BKMK_workflow"></a> Новые функции в рабочем процессе Windows PowerShell

-   Добавлена поддержка нового общего параметра **PipelineVariable** в контексте итеративных конвейеров, например тех, которые используются System Center Orchestrator; это конвейеры, выполняющие команды просто слева направо, в отличие от смешанного выполнения команд с помощью потоковой передачи.

-   Привязка параметров значительно улучшила работу за пределами сценариев заполнения с помощью клавиши TAB, например с помощью команд, которые не существуют в текущем пространстве выполнения.

-   В [!INCLUDE[ps_workflow_2](../Token/ps_workflow_2_md.md)] добавлена поддержка действий настраиваемого контейнера. Если параметр действия имеет типы **Activity**, **Activity[]** или является универсальной коллекцией действий, а пользователь предоставил блок сценария в качестве аргумента, то [!INCLUDE[ps_workflow_2](../Token/ps_workflow_2_md.md)] преобразует блок сценария в XAML так же, как при обычной компиляции сценария в рабочий процесс [!INCLUDE[wps_2](../Token/wps_2_md.md)].

-   После сбоя рабочий процесс [!INCLUDE[wps_2](../Token/wps_2_md.md)] автоматически повторно подключается к управляемым узлам.

-   Теперь можно отрегулировать оператор действий **Foreach -Parallel**, используя свойство **ThrottleLimit**.

-   Общий параметр **ErrorAction** содержит новое допустимое значение **Suspend**, эксклюзивное для рабочих процессов.

-   Конечная точка рабочих процессов теперь автоматически закрывается, если отсутствуют активные сеансы, выполняющиеся и ожидающие задания. Эта функция сохраняет ресурсы на компьютере, который действует как сервер рабочих процессов, при соответствии условиям автоматического закрытия.

### <a name="BKMK_psws"></a> Новые функции в веб-службах Windows PowerShell

-   В случае возникновения ошибки в веб-службах [!INCLUDE[wps_2](../Token/wps_2_md.md)] (служба PSWS также называется расширением IIS OData для управления) при выполнении командлета вызывающему объекту возвращаются более подробные сообщения об ошибках. Кроме того, коды ошибок следуют [руководствам по кодам ошибок Windows Azure REST API](http://msdn.microsoft.com/library/windowsazure/dd179357.aspx).

-   Конечная точка теперь может определить версию API, а также принудительно использовать конкретную версию API. Каждый раз при возникновении несоответствия между клиентом и сервером ошибки отображаются как на клиенте, так и на сервере.

-   Управление схемой диспетчера упрощено путем автоматического создания значений для всех отсутствующих полей в схеме. Создание происходит в виде полезной точки отсчета, даже если схема диспетчера не существует.

-   Усовершенствована обработка типов в PSWS для поддержки типов, которые используют конструктор, отличный от конструктора по умолчанию, с поведением, аналогичным поведению **PSTypeConverter** в [!INCLUDE[wps_2](../Token/wps_2_md.md)]. Это позволяет использовать сложные типы с PSWS.

-   PSWS теперь позволяет расширить связанный экземпляр во время выполнения запроса. Для более крупного двоичного содержимого (например, изображений, аудио или видео) стоимость передачи является значительной, и передачу двоичных данных лучше производить без кодирования. PSWS использует именованные потоки ресурсов для передачи без кодирования. Именованный поток ресурсов — это свойство сущности типа **Edm.Stream**. Каждый именованный поток ресурсов содержит отдельный универсальный код ресурса для операций GET или UPDATE.

-   Действия OData теперь предоставляют механизм вызова методов, отличных от CRUD (Create, Read, Update и Delete), в ресурсе. Можно вызвать действие, отправив запрос HTTP POST в универсальный код ресурса, который определен для действия. Параметры для действия определены в тексте запроса POST.

-   Для соответствия руководствам Microsoft Azure все URL-адреса должны быть упрощены. Изменение, включенное в **Key As Segment**, позволяет представлять отдельные ключи в виде сегментов. Обратите внимание, что ссылки, которые используют значения нескольких ключей, как и раньше, требуют значений с разделителями-запятыми в нотации со скобками.

-   До этого выпуска PSWS единственным способом выполнения операций Create, Update или Delete было вызвать Post, Put или Delete в ресурсе верхнего уровня. Новые в этом выпуске PSWS операции содержащегося ресурса позволяют пользователям получать те же результаты, достигая того же ресурса не напрямую, а как если бы эти ресурсы были содержащимися.

### <a name="BKMK_powwa"></a> Новые функции в Windows PowerShell Web Access

-   В веб-консоли [!INCLUDE[pswa_2](../Token/pswa_2_md.md)] можно отключиться от существующих сеансов и подключиться к ним. Кнопка **Сохранить** в веб-консоли позволяет отключиться от сеанса, не удаляя его, и повторно подключиться к нему в следующий раз.

-   Параметры по умолчанию могут отображаться на одной странице входа. Чтобы отобразить параметры по умолчанию, настройте значения для всех параметров, отображающихся в области **Дополнительные параметры подключения** на странице входа, в файле **web.config**. Файл **web.config** можно использовать для настройки всех дополнительных параметров подключения, за исключением второго или дополнительного набора учетных данных.

-   В [!INCLUDE[winblue_server_2](../Token/winblue_server_2_md.md)] можно удаленно управлять правилами авторизации для [!INCLUDE[pswa_2](../Token/pswa_2_md.md)]. Командлеты **Add-PswaAuthorizationRule** и **Test-PswaAuthorizationRule** теперь включают параметр Credential, который позволяет администраторам управлять правилами авторизации с удаленного компьютера или в сеансе [!INCLUDE[pswa_2](../Token/pswa_2_md.md)].

-   Теперь вы можете открыть несколько сеансов [!INCLUDE[pswa_2](../Token/pswa_2_md.md)] в одном сеансе браузера, используя новую вкладку для каждого сеанса. Больше не нужно открывать новый сеанс браузера для подключения к новому сеансу в веб-консоли [!INCLUDE[wps_2](../Token/wps_2_md.md)].

### <a name="BKMK_bugs"></a> Исправления важных ошибок в Windows PowerShell 4.0

-   **Get-Counter** теперь может возвращать счетчики, содержащие символ апострофа в выпусках Windows на французском языке.

-   Метод **GetType** теперь можно просматривать в десериализованных объектах.

-   Операторы **#Requires** теперь позволяют пользователям при необходимости запрашивать права доступа администратора.

-   Командлет **Import-Csv** теперь пропускает пустые строки.

-   Исправлена проблема потребления [!INCLUDE[ise_2](../Token/ise_2_md.md)] слишком большого объема памяти при выполнении команды **Invoke-WebRequest**.

-   **Get-Module** теперь отображает версии модуля в столбце **Version**.

-   Remove-Item -Recurse теперь удаляет элементы из вложенных папок, как и ожидалось.

-   Свойство **UserName** добавлено к выходным объектам **Get-Process**.

-   Командлет **Invoke-RestMethod** теперь возвращает все доступные результаты.

-   **Add-Member** теперь влияет на хеш-таблицы, даже если доступ к хеш-таблицам еще не осуществлялся.

-   **Select-Object -Expand** больше не вызывает сбой или исключение, если значение свойства равно NULL или пустое.

-   **Get-Process** теперь может использоваться в конвейере с другими командами, которые получают свойство **ComputerName** из объектов.

-   **ConvertTo-Json** и **ConvertFrom-Json** теперь могут принимать условия, заключенные в двойные кавычки, а сообщения об ошибках теперь доступны для локализации.

-   **Get-Job** теперь возвращает все завершенные запланированные задания даже в новых сеансах.

-   Исправлены проблемы с подключением и отключением виртуальных жестких дисков с помощью поставщика **FileSystem** в [!INCLUDE[psversion4](../Token/psversion4_md.md)]. [!INCLUDE[wps_2](../Token/wps_2_md.md)] теперь может отслеживать новые диски при подключении в одном сеансе.

-   Вам больше не нужно явно загружать модули **ScheduledJob** или **Workflow** для работы с их типами заданий.

-   Повышена производительность импорта рабочих процессов, определяющих вложенные рабочие процессы.

## <a name="BKMK_wps3"></a> Новые функции в Windows PowerShell 3.0
[!INCLUDE[psversion3](../Token/psversion3_md.md)] включает приведенные ниже новые функции.

-   [Рабочий процесс Windows PowerShell](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_Workflow)

-   [Windows PowerShell Web Access](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_WebAccess)

-   [Новые функции интегрированной среды сценариев Windows PowerShell](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_ISE)

-   [Поддержка Microsoft .NET Framework 4.0](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_NET4)

-   [Поддержка среды предустановки Windows](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_WinPE)

-   [Отключенные сеансы](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_Disconnected)

-   [Надежное подключение сеансов](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_Robust)

-   [Система обновляемой справки](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_UpHelp)

-   [Усовершенствованная справка в Интернете](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_Online)

-   [Интеграция CIM](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_CIM)

-   [Файлы конфигурации сеанса](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_ConfigFile)

-   [Интеграция запланированных заданий и планировщика задач](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_ScheduledJob)

-   [Усовершенствования языка Windows PowerShell](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_Lang)

-   [Новые основные командлеты](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_Core)

-   [Усовершенствования существующих основных командлетов и поставщиков](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_Prov)

-   [Удаленный импорт и обнаружение модулей](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_REM)

-   [Усовершенствованное заполнение нажатием клавиши TAB](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_TAB)

-   [Автоматическая загрузка модуля](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_AutoLoad)

-   [Улучшение работы с модулями](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_MOD)

-   [Упрощенное обнаружение команд](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_SIMPLE)

-   [Улучшенная поддержка ведения журнала, диагностики и групповой политики](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_LOG)

-   [Усовершенствованное форматирование и выходные данные](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_OUT)

-   [Усовершенствованное взаимодействие с узлом консоли](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_HOST)

-   [Новые API командлетов и размещения](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_API)

-   [Повышение производительности](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_PERF)

-   [Поддержка запуска от имени и общего узла](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_RUNAS)

-   [Улучшения обработки специальных символов](../Topic/What-s-New-in-Windows-PowerShell.md#BKMK_CHAR)

### <a name="BKMK_Workflow"></a> Рабочий процесс Windows PowerShell
[!INCLUDE[ps_workflow_1](../Token/ps_workflow_1_md.md)] предоставляет возможности Windows Workflow Foundation для [!INCLUDE[mshshort](../Token/mshshort_md.md)]. Рабочие процессы можно записывать на языке XAML или [!INCLUDE[mshshort](../Token/mshshort_md.md)] и запускать их так же, как командлеты. Командлет [Get-Command](assetId:///59c6d302-6e8c-48b7-a6f6-f0172df936ad) получает команды рабочих процессов, а [Get-Help](assetId:///1f46eeb4-49d7-4bec-bb29-395d9b42f54a) получает справку для рабочих процессов.

Рабочие процессы — это последовательности длительных, повторяющихся, частых, параллелизуемых, прерываемых, приостанавливаемых и перезапускаемых действий управления несколькими компьютерами. Действие рабочих процессов можно возобновить после намеренного или случайного прерывания работы, например отключения от сети, перезапуска Windows или сбоя питания.

Рабочие процессы также являются переносимыми; их можно экспортировать из XAML-файлов или импортировать в них. Вы можете написать конфигурации настраиваемых сеансов, которые позволяют делегированным или подчиненным пользователям запускать рабочий процесс или действия в рабочем процессе.

Далее приводятся преимущества [!INCLUDE[ps_workflow_2](../Token/ps_workflow_2_md.md)].

-   **Автоматизация последовательности длительных задач.**

-   **Удаленный мониторинг длительных задач**. Состояние и ход выполнения действий видны в любое время.

-   **Управление несколькими компьютерами.** Одновременный запуск задач как рабочих процессов на сотнях управляемых узлов. [!INCLUDE[ps_workflow_2](../Token/ps_workflow_2_md.md)] включает встроенную библиотеку общих параметров управления, например **PSComputerName**, которые поддерживают сценарии управления несколькими компьютерами.

-   **Выполнение одной задачи для сложных процессов.** Связанные сценарии, реализующие весь сквозной сценарий в одном рабочем процессе, можно совмещать.

-   **Сохраняемость.** Рабочий процесс сохраняется (или создается его контрольная точка) в точках, определенных автором, чтобы можно было продолжить рабочий процесс с последней сохраненной задачи (или контрольной точки), а не перезапускать его с начала.

-   **Надежность.** Автоматическое восстановление после сбоя. Рабочие процессы сохраняются при запланированных и незапланированных перезапусках. Выполнение рабочего процесса можно приостановить, а затем продолжить его с последней точки сохранения. Авторы рабочих процессов могут назначить перезапуск определенных действий в случае сбоя на одном или нескольких управляемых узлах.

-   **Возможность отключения, повторного подключения и запуска в отключенных сеансах.** Пользователи могут подключаться к серверу рабочих процессов и отключаться от него, не прерывая выполнения рабочих процессов. Можно выйти из системы клиентского компьютера или перезагрузить его и отслеживать выполнение рабочих процессов с другого компьютера, не прерывая выполнения рабочего процесса.

-   **Планирование.** Задачи рабочего процесса можно планировать как любой сценарий или командлет [!INCLUDE[mshshort](../Token/mshshort_md.md)].

-   **Регулирование рабочих процессов и подключений.** Выполнение рабочих процессов и подключений к узлам можно регулировать, включая масштабирование и сценарии высокой доступности.

### <a name="BKMK_WebAccess"></a> Windows PowerShell Web Access
[!INCLUDE[pswa_1](../Token/pswa_1_md.md)] является функцией [!INCLUDE[win8_server_2](../Token/win8_server_2_md.md)], которая позволяет пользователям выполнять команды и сценарии Windows PowerShell в веб-консоли. Устройства, использующие веб-консоль, не требуют [!INCLUDE[mshshort](../Token/mshshort_md.md)], программного обеспечения для удаленного управления или установки подключаемых модулей браузера. Все, что требуется, — это правильно настроенный шлюз [!INCLUDE[pswa_2](../Token/pswa_2_md.md)] и браузер на клиентском устройстве, поддерживающий JavaScript® и принимающий файлы cookie.

Дополнительные сведения см. в статье [Развертывание Windows PowerShell Web Access](http://go.microsoft.com/fwlink/p/?LinkID=221050).

### <a name="BKMK_ISE"></a> Новые функции интегрированной среды сценариев Windows PowerShell
В версии [!INCLUDE[psversion3](../Token/psversion3_md.md)] в [!INCLUDE[ise_1](../Token/ise_1_md.md)] входит несколько новых функций, включая IntelliSense, окно Show-Command, унифицированную область консоли, фрагменты кода, парные фигурные скобки, разделы развертывания и свертывания, автосохранение, список последних элементов, полное копирование, блочное копирование и полную поддержку записи рабочих процессов для сценариев Windows PowerShell. Дополнительные сведения см. в статье [about_Windows_PowerShell_ISE [v3]](assetId:///dfa54d47-60c6-4fff-8197-c747e8d411bb).

### <a name="BKMK_NET4"></a> Поддержка Microsoft .NET Framework 4
Служба Windows PowerShell создана на основе среды CLR 4.0. Создатели командлетов, сценариев и рабочих процессов могут использовать новые классы Microsoft .NET Framework 4 в Windows PowerShell с функциями, в которые входит совместимость и развертывание приложений, Managed Extensibility Framework, параллельное вычисление, сети, Windows Communication Foundation и Windows Workflow Foundation.

### <a name="BKMK_WinPE"></a> Поддержка среды предустановки Windows
Windows PowerShell 3.0 является дополнительным компонентом среды предустановки Windows (Windows PE) 4.0 для Windows 8. Windows PE — это минимальная операционная система, которая запускает компьютер без операционной системы и подготавливает его к установке Windows. Windows PE можно использовать для секционирования и форматирования жестких дисков, копирования образов дисков на компьютер и запуска установки Windows из общей сетевой папки. Windows PowerShell 3.0 можно использовать в Windows PE для управления развертыванием, диагностикой и сценариями восстановления.

### <a name="BKMK_Disconnected"></a> Отключенные сеансы
Начиная с Windows PowerShell 3.0, постоянные пользовательские сеансы (PSSessions), которые вы создаете с помощью командлета New-PSSession, сохраняются на удаленном компьютере. Они больше не зависят от сеанса, в котором были созданы.

Теперь можно отключиться от сеанса, не прерывая команд, выполняющихся в сеансе. Можно закрыть сеанс и завершить работу компьютера. Позже можно повторно подключиться к сеансу из другого сеанса на том же или другом компьютере.

Параметр **ComputerName** командлета [Get-PSSession](assetId:///b2b10531-d0df-4746-b877-e75c09955cb6) теперь получает все сеансы пользователя, которые подключаются к компьютеру, даже если они были запущены в другом сеансе на другом компьютере. Можно повторно подключиться к сеансам, получить результаты команд, запустить новые команды, а затем отключиться от сеанса.

Добавлены новые командлеты для поддержки функции удаленных сеансов, включая [Disconnect-PSSession](assetId:///f8f95111-612f-4cba-9098-77904b0473d8), [Connect-PSSession](assetId:///b803dd29-f208-4079-80d4-db04d778f060) и Receive-PSSession, а также добавлены новые параметры в командлеты, управляющие сеансами PSSession, например параметр **InDisconnectedSession** командлета [Invoke-Command](assetId:///906b4b41-7da8-4330-9363-e7164e5e6970).

Функция отключенных сеансов поддерживается только в том случае, если компьютеры на исходной (client) и завершающей (server) точках подключения запущены под управлением Windows PowerShell 3.0.

### <a name="BKMK_Robust"></a> Надежное подключение сеансов
Windows PowerShell 3.0 обнаруживает неожиданные потери подключения между клиентом и сервером и пытается повторно установить подключение и продолжить выполнение автоматически. Если подключение "клиент-сервер" невозможно установить повторно в отведенный период времени, пользователь получает уведомление и выполняется отключение сеанса. Во время попытки повторного подключения Windows PowerShell постоянно предоставляет отзывы пользователю.

Если отключенный сеанс запущен с использованием InvokeCommand, Windows PowerShell создает задание для отключенного сеанса для упрощения повторного подключения и возобновления выполнения.

Эти функции предоставляют более надежное и восстанавливаемое удаленное взаимодействие и позволяют пользователям выполнять длительные задачи, требующие надежных сеансов, например рабочие процессы.

### <a name="BKMK_UpHelp"></a> Система обновляемой справки
Теперь можно скачать обновленные файлы справки для командлетов в модулях. Командлет [Update-Help](assetId:///93e1d870-ace6-432b-8778-8920291d7545) идентифицирует новейшие файлы справки, скачивает их из Интернета, распаковывает, проверяет и устанавливает в каталог для правильного языка данного модуля.

Чтобы использовать обновленные файлы справки, просто введите `Get-Help`. Перезапускать Windows или [!INCLUDE[mshshort](../Token/mshshort_md.md)] не требуется. Чтобы обновить справку для модулей в каталоге $pshome, запустите [!INCLUDE[mshshort](../Token/mshshort_md.md)] с параметром "Запустить от имени администратора".

Чтобы поддержать пользователей без доступа к Интернету и пользователей, расположенных за брандмауэрами, новый командлет [Save-Help](assetId:///aed94f90-b73f-4e25-a25d-7c18d9f161fa) скачивает файлы справки в каталог файловой системы, например в общую папку. После этого пользователи могут использовать командлет [Update-Help](assetId:///93e1d870-ace6-432b-8778-8920291d7545) для получения обновленных файлов справки из общей папки.

Командлет [Update-Help](assetId:///93e1d870-ace6-432b-8778-8920291d7545) можно использовать для обновления файлов справки для всех или конкретных модулей во всех поддерживаемых с любыми языками и региональными параметрами пользовательского интерфейса. Можно даже поместить команду [Update-Help](assetId:///93e1d870-ace6-432b-8778-8920291d7545) в ваш профиль [!INCLUDE[mshshort](../Token/mshshort_md.md)]. По умолчанию [!INCLUDE[mshshort](../Token/mshshort_md.md)] скачивает файлы справки для модуля не чаще раза в день.

Модули [!INCLUDE[win8_client_2](../Token/win8_client_2_md.md)] и [!INCLUDE[win8_server_2](../Token/win8_server_2_md.md)] не включают файлы справки. Чтобы скачать последние файлы справки, введите `Update-Help`. Для получения дополнительных сведений введите `Get-Help` (без параметров) или см. статью [about_Updatable_Help](assetId:///10bba75c-f4ac-4ca1-bbf3-8f34dd521ffe).

Если файлы справки для командлета не установлены на компьютере, командлет [Get-Help](assetId:///1f46eeb4-49d7-4bec-bb29-395d9b42f54a) теперь будет отображать автоматически созданную справку. В автоматически собранную справку входит синтаксис команды и инструкции по использованию командлета [Update-Help](assetId:///93e1d870-ace6-432b-8778-8920291d7545) для скачивания файлов справки.

Любой создатель модуля может поддержать обновляемую справку для модуля. Файлы справки можно включить в модуль и использовать обновляемую справку для их обновления, или же можно пропустить файлы справки и использовать обновляемую справку для их установки. Дополнительные сведения о поддержке обновляемой справки см. в статье [Поддержка обновляемой справки](http://go.microsoft.com/FWLink/?LinkID=242129) на сайте MSDN.

### <a name="BKMK_Online"></a> Усовершенствованная справка в Интернете
Справка в Интернете [!INCLUDE[mshshort](../Token/mshshort_md.md)] является ценным ресурсом для всех пользователей, но особенно она важна для тех, кто не устанавливает или не может установить обновленные файлы справки.

Для получения справки в Интернете по любому командлету [!INCLUDE[mshshort](../Token/mshshort_md.md)] введите:

```
Get-Help <cmdlet-name> -Online
```

[!INCLUDE[mshshort](../Token/mshshort_md.md)] откроет интернет-версию раздела справки в браузере по умолчанию.

Функция **Get-Help -Online** в [!INCLUDE[psversion3](../Token/psversion3_md.md)] теперь предоставляет еще больше возможностей, так как она работает, даже если файлы справки для командлета не установлены на компьютере. Функция **Get-Help -Online** получает универсальный код ресурса для раздела справки в Интернете из свойства HelpUri командлетов и дополнительных функций.

```
PS C:\>(Get-Command Get-ScheduledJob).HelpUri
http://go.microsoft.com/fwlink/?LinkID=223923
```

Начиная с [!INCLUDE[psversion3](../Token/psversion3_md.md)], создатели командлетов на C# могут заполнить свойство **HelpUri**, создав атрибут **HelpUri** в классе командлета. Авторы дополнительных функций могут определить свойство **HelpUri** в атрибуте **CmdletBinding**. Значение свойства **HelpUri** должно начинаться с http или https.

Можно также включить значение **HelpUri** в первую связанную ссылку файла справки по командлету на основе XML или директиву .Link справки на основе комментариев в функцию.

Дополнительные сведения о поддержке справки в Интернете см. в статье [Поддержка справки в Интернете](http://go.microsoft.com/fwlink/?LinkId=242132).

### <a name="BKMK_CIM"></a> Интеграция CIM
[!INCLUDE[psversion3](../Token/psversion3_md.md)] включает поддержку модели CIM, которая предоставляет стандартные определения для информации управления для систем, сетей, приложений и служб, позволяя им обмениваться сведениями об управлении между разнородными системами. Поддержка CIM в [!INCLUDE[psversion3](../Token/psversion3_md.md)], включая возможность создавать командлеты Windows PowerShell на основе новых или существующих классов CIM, команды на основе XML-файлов определений командлетов, поддержка CIM .NET Framework. API, командлеты управления CIM и поставщики WMI 2.0.

### <a name="BKMK_ConfigFile"></a> Файлы конфигурации сеанса
Начиная с [!INCLUDE[psversion3](../Token/psversion3_md.md)], с помощью файла можно создать конфигурацию пользовательского сеанса. Файл конфигурации нового сеанса позволяет определить среду сеансов, которые используют конфигурацию сеансов, включая модули, сценарии и файлы форматирования, загруженные в сеансы, командлеты и элементы языка, которые могут использовать пользователи, модули и сценарии, которые они могут запускать, и переменные, которые они могут просматривать.

Можно создать сеанс, в котором пользователи могут только выполнять командлеты из одного конкретного модуля, или сеанс, в котором пользователи получат весь язык, доступ ко всем модулям и доступ к сценариям, которые выполняют дополнительные задачи.

В предыдущих версиях [!INCLUDE[mshshort](../Token/mshshort_md.md)] функции контроля на этом уровне были доступны только тем, кто мог написать программу на C# или сложный сценарий запуска. Теперь любой участник группы администраторов на компьютере может настроить конфигурацию сеанса, используя файл конфигурации.

Чтобы создать файл конфигурации сеанса, используйте командлет [New-PSSessionConfigurationFile](assetId:///5f3e3633-6e90-479c-aea9-ba45a1954866). Чтобы применить файл конфигурации сеанса к конфигурации сеанса, используйте командлеты [Register-PSSessionConfiguration](assetId:///e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) или [Set-PSSessionConfiguration](assetId:///b21fbad3-1759-4260-b206-dcb8431cd6ea).

Дополнительные сведения см. в статьях [about_Session_Configuration_Files](assetId:///c7217447-1ebf-477b-a8ef-4dbe9a1473b8) и [New-PSSessionConfigurationFile](assetId:///5f3e3633-6e90-479c-aea9-ba45a1954866).

### <a name="BKMK_ScheduledJob"></a> Интеграция запланированных заданий и планировщика задач
Теперь можно запланировать фоновые задания [!INCLUDE[mshshort](../Token/mshshort_md.md)] и управлять ими в [!INCLUDE[mshshort](../Token/mshshort_md.md)] и планировщике задач.

Запланированные задания [!INCLUDE[mshshort](../Token/mshshort_md.md)] являются полезным гибридом фоновых заданий [!INCLUDE[mshshort](../Token/mshshort_md.md)] и задач планировщика задач.

Как и фоновые задания [!INCLUDE[mshshort](../Token/mshshort_md.md)], запланированные задания выполняются асинхронно в фоновом режиме. Управлять выполненными экземплярами запланированных заданий можно с помощью командлетов заданий, например [Start-Job](assetId:///2bc04935-0deb-4ec0-b856-d7290cca6442) и [Get-Job](assetId:///1352c534-7193-46ca-9ab1-0c5219a661ad).

Как и задачи планировщика задач, запланированные задания можно выполнять в однократном или повторяющемся расписании или в ответ на действие или событие. Вы можете просматривать запланированные задания и управлять ими в планировщике задач, включать и отключать их при необходимости, запускать их или использовать как шаблоны и задавать условия, при которых задания запускаются.

Кроме того, в запланированные задания включен настраиваемый набор командлетов для управления ими. Командлеты позволяют создавать, изменять, отключать, повторно включать запланированные задания и управлять ими, создавать триггеры запланированных заданий и устанавливать параметры запланированных заданий.

Дополнительные сведения о запланированных заданиях см. в статье [about_Scheduled_Jobs](assetId:///3b546629-703c-4939-b44f-52dd567bce92).

### <a name="BKMK_Lang"></a> Усовершенствования языка Windows PowerShell
[!INCLUDE[psversion3](../Token/psversion3_md.md)] включает много функций, предназначенных для упрощения языка, его использования и предотвращения распространенных ошибок. В усовершенствования входит перечисление свойств, свойства счетчика и длины в скалярных объектах, новые операторы перенаправления, модификатор области $Using, автоматическая переменная PSItem, гибкое форматирование сценариев, атрибуты переменных, упрощенные аргументы атрибутов, имена числовых команд, оператор Stop-Parsing, усовершенствованный сплаттинг массивов, новые двоичные операторы, упорядоченные словари, приведение PSCustomObject и усовершенствованная справка на основе комментариев.

### <a name="BKMK_Core"></a> Новые основные командлеты
В установку основных компонентов Windows PowerShell добавлены новые командлеты, включая командлеты для управления запланированными заданиями, отключенными сеансами, интеграцией CIM и системой обновляемой справки.

|||
|-|-|
|Add-JobTrigger|New-JobTrigger|
|Connect-PSSession|New-PSSessionConfigurationFile|
|ConvertFrom-Json|New-PSTransportOption|
|ConvertTo-Json|New-PSWorkflowExecutionOption|
|Disable-JobTrigger|New-PSWorkflowSession|
|Disable-ScheduledJob|New-ScheduledJobOption|
|Disconnect-PSSession|New-WinEvent|
|Enable-JobTrigger|Receive-PSSession|
|Enable-ScheduledJob|Register-CimIndicationEvent|
|Get-CimAssociatedInstance|Register-ScheduledJob|
|Get-CimClass|Remove-CimInstance|
|Get-CimInstance|Remove-CimSession|
|Get-CimSession|Remove-TypeData|
|Get-ControlPanelItem|Rename-Computer|
|Get-IseSnippet|Resume-Job|
|Get-JobTrigger|Save-Help|
|Get-ScheduledJob|Set-CimInstance|
|Get-ScheduledJobOption|Set-JobTrigger|
|Get-TypeData|Set-ScheduledJob|
|Import-IseSnippet|Set-ScheduledJobOption|
|Invoke-AsWorkflow|Show-Command|
|Invoke-CimMethod|Show-ControlPanelItem|
|Invoke-RestMethod|Suspend-Job|
|Invoke-WebRequest|Test-PSSessionConfigurationFile|
|New-CimInstance|Unblock-File|
|New-CimSession|Unregister-ScheduledJob|
|New-CimSessionOption|Update-Help|
|New-IseSnippet||

### <a name="BKMK_Prov"></a> Усовершенствования существующих основных командлетов и поставщиков
[!INCLUDE[psversion3](../Token/psversion3_md.md)] включает новые функции для существующих командлетов, в том числе упрощенный синтаксис и новые параметры для следующих командлетов: командлеты Computer, командлеты CSV, Get-ChildItem, Get-Command, Get-Content, Get-History, Measure-Object, командлеты Security, Select-Object, Select-String, Split-Path, Start-Process, Tee-Object, Test-Connection, Add-Member и WMI.

Также были значительно улучшены поставщики Windows PowerShell, включая поддержку поставщика сертификатов для управления сертификатами SSL для веб-размещения, поддержку учетных данных, постоянных сетевых дисков и других потоков данных на дисках файловой системы.

### <a name="BKMK_REM"></a> Удаленный импорт и обнаружение модулей
[!INCLUDE[psversion3](../Token/psversion3_md.md)] расширяет возможности обнаружения модулей, импорта и неявного удаленного взаимодействия на удаленных компьютерах. Командлеты модуля получают модули на удаленных компьютерах и импортируют их на удаленный или локальный компьютер, используя удаленное взаимодействие Windows PowerShell. Поддержка нового сеанса CIM позволяет использовать CIM и WMI для управления компьютерами, работающими не под управлением Windows, с помощью импорта команд на локальный компьютер, который неявно выполняется на удаленном компьютере.

Подробнее см. в разделах справки для командлетов [Get-Module](assetId:///2cccd4c4-9a21-4c77-b691-984ee57242e1) и [Import-Module](assetId:///af616c24-e122-4098-930e-1e3ea2080ade).

### <a name="BKMK_TAB"></a> Усовершенствованное заполнение нажатием клавиши TAB
Заполнение нажатием клавиши TAB в консоли [!INCLUDE[wps_2](../Token/wps_2_md.md)] теперь заполняет имена командлетов, параметров, значений параметров, перечислений, типов .NET Framework, COM-объектов, скрытых каталогов и многого другого. Функция заполнения нажатием клавиши TAB полностью переписана на основе нового средства анализа и дерева абстрактного синтаксиса для поддержки большего количества сценариев, включая деревья анализа в памяти и заполнение нажатием клавиши TAB в середине строки.

### <a name="BKMK_AutoLoad"></a> Автоматическая загрузка модуля
Командлет [Get-Command](assetId:///59c6d302-6e8c-48b7-a6f6-f0172df936ad) теперь получает все командлеты и функции из всех модулей, установленных на компьютере, даже если модуль не импортируется в текущий сеанс.

При получении нужного командлета его можно использовать немедленно, без необходимости импорта каких-либо модулей. Модули [!INCLUDE[mshshort](../Token/mshshort_md.md)] теперь импортируются автоматически при использовании любого командлета в модуле. Вам больше не нужно искать модуль и импортировать его, чтобы использовать командлеты.

Автоматический импорт модулей активируется запуском командлета в команде либо выполнением **Get-Command** или [Get-Help](assetId:///1f46eeb4-49d7-4bec-bb29-395d9b42f54a) для командлета без подстановочных знаков.

Автоматический импорт модулей можно включать, отключать и настраивать с помощью привилегированной переменной **$PSModuleAutoLoadingPreference**.

Дополнительные сведения см. в статьях [about_Modules [v4]](assetId:///94f57429-a539-4aee-bb0d-205cd7e801f9), [about_Preference_Variables [v4]](assetId:///31344314-be29-4286-b039-afa5460cbe8b) и в разделах справки по командлетам [Get-Command](assetId:///59c6d302-6e8c-48b7-a6f6-f0172df936ad) и [Import-Module](assetId:///af616c24-e122-4098-930e-1e3ea2080ade).

### <a name="BKMK_MOD"></a> Улучшение работы с модулями
Windows PowerShell 3.0 предоставляет поддержку дополнительных функций для модулей, включая следующие новые функции.

1.  Ведение журнала модуля для индивидуальных модулей (LogPipelineExecutionDetails) и новый параметр групповой политики "Включить ведение журнала модуля".

2.  Расширенные объекты модуля, предоставляющие значения из манифеста модуля.

3.  Новое свойство **ExportedCommands** модулей, включая вложенные модули, которые совмещают команды всех типов.

4.  Усовершенствованное обнаружение доступных модулей (не импортированных), включая разрешение параметров **Path** и **ListAvailable** в одной команде.

5.  Новый ключ **DefaultCommandPrefix** в манифестах модуля, предотвращающий конфликты имен без изменения кода модуля.

6.  Усовершенствованные требования модуля, включая полные обязательные модули с версией и GUID, а также автоматический импорт обязательных модулей

7.  Бесперебойная, упрощенная работа командлета [New-ModuleManifest](assetId:///512adced-f42f-4e88-ba7c-834fc9e5d047).

8.  Новый параметр **Module** для #Requires.

9. Усовершенствованный командлет [Import-Module](assetId:///af616c24-e122-4098-930e-1e3ea2080ade) с обоими параметрами **MinimumVersion** и **RequiredVersion**.

### <a name="BKMK_SIMPLE"></a> Упрощенное обнаружение команд
Больше не нужно импортировать все модули для обнаружения команд, доступных для сеанса. В [!INCLUDE[psversion3](../Token/psversion3_md.md)] командлет [Get-Command](assetId:///59c6d302-6e8c-48b7-a6f6-f0172df936ad) получает все команды из всех установленных модулей. При использовании команды модуль, экспортирующий команду, автоматически импортируется в сеанс.

Новый командлет [Show-Command](assetId:///65bba50b-91a8-49d5-80a2-a30fc684ba41) предназначен для начинающих. Команды можно искать в окне. Вы можете просматривать все команды или фильтровать их по модулю, использовать текстовые поля и раскрывающиеся списки для создания допустимой команды, а затем копировать или запускать команду в пределах одного окна.

### <a name="BKMK_LOG"></a> Улучшенная поддержка ведения журнала, диагностики и групповой политики
[!INCLUDE[psversion3](../Token/psversion3_md.md)] усовершенствует поддержку ведения журнала и трассировки для команд и модулей с поддержкой журналов трассировки событий в Windows, редактируемого свойства **LogPipelineExecutionDetails** модулей и параметра групповой политики "Включить ведение журнала модуля". Теперь вы можете получить значения параметров из сведений журнала, отобразив свойства журнала.

### <a name="BKMK_OUT"></a> Усовершенствованное форматирование и выходные данные
Новые усовершенствования форматирования и выходных данных повышают эффективность всех пользователей [!INCLUDE[wps_2](../Token/wps_2_md.md)]. В усовершенствования входит перенаправление выходных данных для всех потоков, улучшенный командлет Update-Type, который добавляет типы динамически, без файлов Format.ps1xml, перенос по словам в выходных данных, свойства форматирования пользовательских объектов по умолчанию, тип **PSCustomObject**, улучшенное форматирование для объектов WMI и разнородных объектов, а также поддержка обнаружения перегрузок методов.

### <a name="BKMK_HOST"></a> Усовершенствованное взаимодействие с узлом консоли
Основная программа консоли [!INCLUDE[wps_2](../Token/wps_2_md.md)] содержит новые функции в [!INCLUDE[psversion3](../Token/psversion3_md.md)], включая однопотоковое подразделение по умолчанию. Новый параметр "Выполнить с помощью PowerShell" в проводнике позволяет выполнять сценарии в неограниченном сеансе, просто щелкнув правой кнопкой мыши. Новая логика запуска узла консоли запускает Windows PowerShell быстрее, а новые шрифты позволяют персонализировать знакомый интерфейс окна консоли.

Дополнительные сведения см. в статье [about_Run_With_PowerShell](assetId:///c9d9ca5f-eff9-4409-be9d-e43b5b4087eb).

### <a name="BKMK_API"></a> Новые API командлетов и размещения
Новые API командлетов и API размещения включают открытые API дерева расширенного синтаксиса и API для подкачки конвейеров, вложенных конвейеров, заполнения пулов пространства выполнения нажатием клавиши TAB, Windows RT, атрибута устаревшего командлета и свойств Verb и Noun объекта FunctionInfo.

### <a name="BKMK_PERF"></a> Повышение производительности
Значительно повышена производительность в Windows PowerShell благодаря новому средству анализа языка, созданному на основе DLR в .NET Framework 4, вместе с компиляцией сценариев среды выполнения, повышением надежности подсистемы и изменением алгоритма [Get-ChildItem](assetId:///75cf79bb-4db6-4a67-8c36-3d20754e2190), который повышает производительность, особенно при поиске общих сетевых папок.

### <a name="BKMK_RUNAS"></a> Поддержка запуска от имени и общего узла
[!INCLUDE[psversion3](../Token/psversion3_md.md)] включает поддержку функций запуска от имени и общего узла.

Функция *запуска от имени*, предназначенная для рабочего процесса Windows PowerShell, позволяет пользователям конфигурации сеанса создавать сеансы, которые запускаются с разрешением общей учетной записи пользователя. Это позволяет пользователям с меньшими привилегиями выполнять определенные команды и сценарии с правами администратора и уменьшает необходимость добавления большего количества опытных пользователей в группу администраторов.

Функция **SharedHost** разрешает нескольким пользователям на нескольких компьютерах одновременно подключаться к сеансу рабочего процесса и отслеживать ход выполнения рабочего процесса. Пользователи могут запустить рабочий процесс на одном компьютере, а затем подключиться к сеансу рабочего процесса на другом компьютере, не отключая сеанс от исходного компьютера. Пользователи должны получить одинаковые разрешения и использовать ту же конфигурацию сеанса. Дополнительные сведения см. в подразделе "Запуск рабочего процесса Windows PowerShell" раздела "Начало работы с рабочими процессами Windows PowerShell".

### <a name="BKMK_CHAR"></a> Улучшения обработки специальных символов
Чтобы улучшить возможность интерпретации и правильной обработки специальных символов в [!INCLUDE[psversion3](../Token/psversion3_md.md)], параметр **LiteralPath**, который обрабатывает специальные символы в путях, допустим практически во всех командлетах с параметром **Path**, включая новые командлеты [Update-Help](assetId:///93e1d870-ace6-432b-8778-8920291d7545) и [Save-Help](assetId:///aed94f90-b73f-4e25-a25d-7c18d9f161fa). Средство анализа также включает специальную логику для улучшения обработки обратного апострофа (`) и квадратных скобок в именах и путях файлов.

## См. также
[about_Windows_PowerShell_4.0](http://technet.microsoft.com/en-us/library/hh847833(v=wps.630).aspx)
[about_Windows_PowerShell_5.0](assetId:///6d56fa88-371e-40c9-b2de-64a2a0cd49da)
[Windows PowerShell](http://go.microsoft.com/fwlink/?LinkID=107116)



<!--HONumber=Apr16_HO1-->


