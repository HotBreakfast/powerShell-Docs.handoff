{
  "nodes": [
    {
      "content": "Running Remote Commands",
      "pos": [
        11,
        34
      ]
    },
    {
      "content": "Running Remote Commands",
      "pos": [
        169,
        192
      ]
    },
    {
      "content": "You can run commands on one or hundreds of computers with a single Windows PowerShell command.",
      "pos": [
        193,
        287
      ]
    },
    {
      "content": "Windows PowerShell supports remote computing by using various technologies, including WMI, RPC, and WS\\-Management.",
      "pos": [
        288,
        403
      ]
    },
    {
      "content": "Remoting Without Configuration",
      "pos": [
        408,
        438
      ]
    },
    {
      "content": "Many Windows PowerShell cmdlets have a ComputerName parameter that enables you to collect data and change settings one or more remote computers.",
      "pos": [
        439,
        583
      ]
    },
    {
      "content": "They use a variety of communication technologies and many work on all Windows operating systems that Windows PowerShell supports without any special configuration.",
      "pos": [
        584,
        747
      ]
    },
    {
      "content": "These cmdlets include:",
      "pos": [
        749,
        771
      ]
    },
    {
      "content": "Restart-Computer",
      "pos": [
        778,
        794
      ]
    },
    {
      "content": "Test-Connection",
      "pos": [
        861,
        876
      ]
    },
    {
      "content": "Clear-EventLog",
      "pos": [
        943,
        957
      ]
    },
    {
      "content": "Get-EventLog",
      "pos": [
        1024,
        1036
      ]
    },
    {
      "content": "Get-Hotfix",
      "pos": [
        1103,
        1113
      ]
    },
    {
      "content": "Get-Process",
      "pos": [
        1203,
        1214
      ]
    },
    {
      "content": "Get-Service",
      "pos": [
        1281,
        1292
      ]
    },
    {
      "content": "Set-Service",
      "pos": [
        1359,
        1370
      ]
    },
    {
      "content": "Get-WinEvent",
      "pos": [
        1437,
        1449
      ]
    },
    {
      "content": "Get-WmiObject",
      "pos": [
        1516,
        1529
      ]
    },
    {
      "content": "Typically, cmdlets that support remoting without special configuration have a ComputerName parameter and do not have a Session parameter.",
      "pos": [
        1591,
        1728
      ]
    },
    {
      "content": "To find these cmdlets in your session, type:",
      "pos": [
        1729,
        1773
      ]
    },
    {
      "content": "Windows PowerShell Remoting",
      "pos": [
        1901,
        1928
      ]
    },
    {
      "content": "Windows PowerShell remoting, which uses the WS\\-Management protocol, lets you run any Windows PowerShell command on one or many remote computers.",
      "pos": [
        1929,
        2074
      ]
    },
    {
      "content": "It lets you establish persistent connections, start 1:1 interactive sessions, and run scripts on multiple computers.",
      "pos": [
        2075,
        2191
      ]
    },
    {
      "content": "To use Windows PowerShell remoting, the remote computer must be configured for remote management.",
      "pos": [
        2193,
        2290
      ]
    },
    {
      "content": "For more information, including instructions, see <bpt id=\"p1\">[</bpt>About Remote Requirements<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dd315349.aspx)</ept>.",
      "pos": [
        2291,
        2428
      ]
    },
    {
      "content": "After you have configured Windows PowerShell remoting, many remoting strategies are available to you.",
      "pos": [
        2430,
        2531
      ]
    },
    {
      "content": "The remainder of this document lists just a few of them.",
      "pos": [
        2532,
        2588
      ]
    },
    {
      "content": "For more information, see <bpt id=\"p1\">[</bpt>About Remote<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dd347744.aspx)</ept> and",
      "pos": [
        2589,
        2692
      ]
    },
    {
      "content": "<bpt id=\"p1\">[</bpt>About Remote FAQ<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dd347744.aspx)</ept>.",
      "pos": [
        2694,
        2772
      ]
    },
    {
      "content": "Start an Interactive Session",
      "pos": [
        2778,
        2806
      ]
    },
    {
      "content": "To start an interactive session with a single remote computer, use the <bpt id=\"p1\">[</bpt>Enter-PSSession<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dd315384.aspx)</ept> cmdlet.",
      "pos": [
        2807,
        2962
      ]
    },
    {
      "content": "For example, to start an interactive session with the Server01 remote computer, type:",
      "pos": [
        2963,
        3048
      ]
    },
    {
      "content": "The command prompt changes to display the name of the computer to which you are connected.",
      "pos": [
        3084,
        3174
      ]
    },
    {
      "content": "From then on, any commands that you type at the prompt run on the remote computer and the results are displayed on the local computer.",
      "pos": [
        3175,
        3309
      ]
    },
    {
      "content": "To end the interactive session, type:",
      "pos": [
        3311,
        3348
      ]
    },
    {
      "content": "For more information about the Enter\\-PSSession and Exit\\-PSSession cmdlets, see <bpt id=\"p1\">[</bpt>Enter-PSSession<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dd315384.aspx)</ept>",
      "pos": [
        3374,
        3531
      ]
    },
    {
      "content": "and <bpt id=\"p1\">[</bpt>Exit-PSSession<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dd315322.aspx)</ept>.",
      "pos": [
        3533,
        3613
      ]
    },
    {
      "content": "Run a Remote Command",
      "pos": [
        3619,
        3639
      ]
    },
    {
      "content": "To run any command on one or many remote computers, use the <bpt id=\"p1\">[</bpt>Invoke-Command<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dd347578.aspx)</ept> cmdlet.",
      "pos": [
        3640,
        3783
      ]
    },
    {
      "content": "For example, to run a <bpt id=\"p1\">[</bpt>Get-UICulture<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dd347742.aspx)</ept> command on the Server01 and Server02 remote computers, type:",
      "pos": [
        3785,
        3942
      ]
    },
    {
      "content": "The output is returned to your computer.",
      "pos": [
        4017,
        4057
      ]
    },
    {
      "pos": [
        4324,
        4482
      ],
      "content": "For more information about the Invoke\\-Command cmdlet, see <bpt id=\"p1\">[</bpt>Invoke-Command<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/22fd98ba-1874-492e-95a5-c069467b8462)</ept>."
    },
    {
      "content": "Run a Script",
      "pos": [
        4488,
        4500
      ]
    },
    {
      "content": "To run a script on one or many remote computers, use the FilePath parameter of the Invoke\\-Command cmdlet.",
      "pos": [
        4501,
        4607
      ]
    },
    {
      "content": "The script must be on or accessible to your local computer.",
      "pos": [
        4608,
        4667
      ]
    },
    {
      "content": "The results are returned to your local computer.",
      "pos": [
        4668,
        4716
      ]
    },
    {
      "content": "For example, the following command runs the DiskCollect.ps1 script on the Server01 and Server02 remote computers.",
      "pos": [
        4718,
        4831
      ]
    },
    {
      "pos": [
        4927,
        5062
      ],
      "content": "For more information about the Invoke\\-Command cmdlet, see <bpt id=\"p1\">[</bpt>Invoke-Command<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dd347578.aspx)</ept>."
    },
    {
      "content": "Establish a Persistent Connection",
      "pos": [
        5068,
        5101
      ]
    },
    {
      "content": "To run a series of related commands that share data, create a session on the remote computer and then use the Invoke\\-Command cmdlet to run commands in the session that you create.",
      "pos": [
        5102,
        5282
      ]
    },
    {
      "content": "To create a remote session, use the New\\-PSSession cmdlet.",
      "pos": [
        5283,
        5341
      ]
    },
    {
      "content": "For example, the following command creates a remote session on the Server01 computer and another remote session on the Server02 computer.",
      "pos": [
        5343,
        5480
      ]
    },
    {
      "content": "It saves the session objects in the $s variable.",
      "pos": [
        5481,
        5529
      ]
    },
    {
      "content": "Now that the sessions are established, you can run any command in them.",
      "pos": [
        5592,
        5663
      ]
    },
    {
      "content": "And because the sessions are persistent, you can collect data in one command and use it in a subsequent command.",
      "pos": [
        5664,
        5776
      ]
    },
    {
      "content": "For example, the following command runs a Get\\-Hotfix command in the sessions in the $s variable and it saves the results in the $h variable.",
      "pos": [
        5778,
        5919
      ]
    },
    {
      "content": "The $h variable is created in each of the sessions in $s, but it does not exist in the local session.",
      "pos": [
        5920,
        6021
      ]
    },
    {
      "content": "Now you can use the data in the $h variable in subsequent commands, such as the following one.",
      "pos": [
        6077,
        6171
      ]
    },
    {
      "content": "The results are displayed on the local computer.",
      "pos": [
        6172,
        6220
      ]
    },
    {
      "content": "Advanced Remoting",
      "pos": [
        6315,
        6332
      ]
    },
    {
      "content": "Windows PowerShell remote management just begins here.",
      "pos": [
        6333,
        6387
      ]
    },
    {
      "content": "By using the cmdlets installed with Windows PowerShell, you can establish and configure remote sessions both from the local and remote ends, create customized and restricted sessions, allow users to import commands from a remote session that actually run implicitly on the remote session, configure the security of a remote session, and much more.",
      "pos": [
        6388,
        6735
      ]
    },
    {
      "content": "To facilitate remote configuration, Windows PowerShell includes a WSMan provider.",
      "pos": [
        6737,
        6818
      ]
    },
    {
      "content": "The WSMAN: drive that the provider creates lets you navigate through a hierarchy of configuration settings on the local computer and remote computers.",
      "pos": [
        6819,
        6969
      ]
    },
    {
      "content": "For more information about the WSMan provider, see  <bpt id=\"p1\">[</bpt>WSMan Provider<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dd819476.aspx)</ept> and",
      "pos": [
        6971,
        7102
      ]
    },
    {
      "content": "<bpt id=\"p1\">  [</bpt>About WS-Management Cmdlets<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dd819481.aspx)</ept>, or in the Windows PowerShell console, type \"get\\-help wsman\".",
      "pos": [
        7103,
        7256
      ]
    },
    {
      "content": "For more information, see:",
      "pos": [
        7258,
        7284
      ]
    },
    {
      "content": "About Remote FAQ",
      "pos": [
        7288,
        7304
      ]
    },
    {
      "content": "Register-PSSessionConfiguration",
      "pos": [
        7368,
        7399
      ]
    },
    {
      "pos": [
        7462,
        7540
      ],
      "content": "<bpt id=\"p1\">[</bpt>Import-PSSession<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dd347575.aspx)</ept>."
    },
    {
      "pos": [
        7543,
        7668
      ],
      "content": "For help with remoting errors, see <bpt id=\"p1\">[</bpt>about_Remote_Troubleshooting<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dd347642.aspx)</ept>."
    },
    {
      "content": "See Also",
      "pos": [
        7673,
        7681
      ]
    },
    {
      "content": "about_Remote",
      "pos": [
        7685,
        7697
      ]
    },
    {
      "content": "about_Remote_FAQ",
      "pos": [
        7784,
        7800
      ]
    },
    {
      "content": "about_Remote_Requirements",
      "pos": [
        7887,
        7912
      ]
    },
    {
      "content": "about_Remote_Troubleshooting",
      "pos": [
        7999,
        8027
      ]
    },
    {
      "content": "about_PSSessions",
      "pos": [
        8114,
        8130
      ]
    },
    {
      "content": "about_WS-Management_Cmdlets",
      "pos": [
        8217,
        8244
      ]
    },
    {
      "content": "Invoke-Command",
      "pos": [
        8331,
        8345
      ]
    },
    {
      "content": "Import-PSSession",
      "pos": [
        8432,
        8448
      ]
    },
    {
      "content": "New-PSSession",
      "pos": [
        8535,
        8548
      ]
    },
    {
      "content": "Register-PSSessionConfiguration",
      "pos": [
        8635,
        8666
      ]
    },
    {
      "content": "WSMan Provider",
      "pos": [
        8753,
        8767
      ]
    }
  ],
  "content": "---\ntitle: Running Remote Commands\nms.custom: na\nms.reviewer: na\nms.suite: na\nms.tgt_pltfrm: na\nms.topic: article\nms.assetid: d6938b56-7dc8-44ba-b4d4-cd7b169fd74d\n---\n# Running Remote Commands\nYou can run commands on one or hundreds of computers with a single Windows PowerShell command. Windows PowerShell supports remote computing by using various technologies, including WMI, RPC, and WS\\-Management.\n\n## Remoting Without Configuration\nMany Windows PowerShell cmdlets have a ComputerName parameter that enables you to collect data and change settings one or more remote computers. They use a variety of communication technologies and many work on all Windows operating systems that Windows PowerShell supports without any special configuration.\n\nThese cmdlets include:\n\n-   [Restart-Computer](https://technet.microsoft.com/en-us/library/dd315301.aspx)\n\n-   [Test-Connection](https://technet.microsoft.com/en-us/library/dd315259.aspx)\n\n-   [Clear-EventLog](https://technet.microsoft.com/en-us/library/dd347552.aspx)\n\n-   [Get-EventLog](https://technet.microsoft.com/en-us/library/dd315250.aspx)\n\n-   [Get-Hotfix](https://technet.microsoft.com/en-us/library/e1ef636f-5170-4675-b564-199d9ef6f101)\n\n-   [Get-Process](https://technet.microsoft.com/en-us/library/dd347630.aspx)\n\n-   [Get-Service](https://technet.microsoft.com/en-us/library/dd347591.aspx)\n\n-   [Set-Service](https://technet.microsoft.com/en-us/library/dd315324.aspx)\n\n-   [Get-WinEvent](https://technet.microsoft.com/en-us/library/dd315358.aspx)\n\n-   [Get-WmiObject](https://technet.microsoft.com/en-us/library/dd315295.aspx)\n\nTypically, cmdlets that support remoting without special configuration have a ComputerName parameter and do not have a Session parameter. To find these cmdlets in your session, type:\n\n```\nget-command | where { $_.parameters.keys -contains \"ComputerName\" -and $_.parameters.keys -notcontains \"Session\"}\n```\n\n## Windows PowerShell Remoting\nWindows PowerShell remoting, which uses the WS\\-Management protocol, lets you run any Windows PowerShell command on one or many remote computers. It lets you establish persistent connections, start 1:1 interactive sessions, and run scripts on multiple computers.\n\nTo use Windows PowerShell remoting, the remote computer must be configured for remote management. For more information, including instructions, see [About Remote Requirements](https://technet.microsoft.com/en-us/library/dd315349.aspx).\n\nAfter you have configured Windows PowerShell remoting, many remoting strategies are available to you. The remainder of this document lists just a few of them. For more information, see [About Remote](https://technet.microsoft.com/en-us/library/dd347744.aspx) and \n[About Remote FAQ](https://technet.microsoft.com/en-us/library/dd347744.aspx).\n\n### Start an Interactive Session\nTo start an interactive session with a single remote computer, use the [Enter-PSSession](https://technet.microsoft.com/en-us/library/dd315384.aspx) cmdlet. For example, to start an interactive session with the Server01 remote computer, type:\n\n```\nenter-pssession Server01\n```\n\nThe command prompt changes to display the name of the computer to which you are connected. From then on, any commands that you type at the prompt run on the remote computer and the results are displayed on the local computer.\n\nTo end the interactive session, type:\n\n```\nexit-pssession\n```\n\nFor more information about the Enter\\-PSSession and Exit\\-PSSession cmdlets, see [Enter-PSSession](https://technet.microsoft.com/en-us/library/dd315384.aspx) \nand [Exit-PSSession](https://technet.microsoft.com/en-us/library/dd315322.aspx).\n\n### Run a Remote Command\nTo run any command on one or many remote computers, use the [Invoke-Command](https://technet.microsoft.com/en-us/library/dd347578.aspx) cmdlet.\n For example, to run a [Get-UICulture](https://technet.microsoft.com/en-us/library/dd347742.aspx) command on the Server01 and Server02 remote computers, type:\n\n```\ninvoke-command -computername Server01, Server02 {get-UICulture}\n```\n\nThe output is returned to your computer.\n\n```\nLCID    Name     DisplayName               PSComputerName\n----    ----     -----------               --------------\n1033    en-US    English (United States)   server01.corp.fabrikam.com\n1033    en-US    English (United States)   server02.corp.fabrikam.com\n```\n\nFor more information about the Invoke\\-Command cmdlet, see [Invoke-Command](https://technet.microsoft.com/en-us/library/22fd98ba-1874-492e-95a5-c069467b8462).\n\n### Run a Script\nTo run a script on one or many remote computers, use the FilePath parameter of the Invoke\\-Command cmdlet. The script must be on or accessible to your local computer. The results are returned to your local computer.\n\nFor example, the following command runs the DiskCollect.ps1 script on the Server01 and Server02 remote computers.\n\n```\ninvoke-command -computername Server01, Server02 -filepath c:\\Scripts\\DiskCollect.ps1\n```\n\nFor more information about the Invoke\\-Command cmdlet, see [Invoke-Command](https://technet.microsoft.com/en-us/library/dd347578.aspx).\n\n### Establish a Persistent Connection\nTo run a series of related commands that share data, create a session on the remote computer and then use the Invoke\\-Command cmdlet to run commands in the session that you create. To create a remote session, use the New\\-PSSession cmdlet.\n\nFor example, the following command creates a remote session on the Server01 computer and another remote session on the Server02 computer. It saves the session objects in the $s variable.\n\n```\n$s = new-pssession -computername Server01, Server02\n```\n\nNow that the sessions are established, you can run any command in them. And because the sessions are persistent, you can collect data in one command and use it in a subsequent command.\n\nFor example, the following command runs a Get\\-Hotfix command in the sessions in the $s variable and it saves the results in the $h variable. The $h variable is created in each of the sessions in $s, but it does not exist in the local session.\n\n```\ninvoke-command -session $s {$h = get-hotfix}\n```\n\nNow you can use the data in the $h variable in subsequent commands, such as the following one. The results are displayed on the local computer.\n\n```\ninvoke-command -session $s {$h | where {$_.installedby -ne \"NTAUTHORITY\\SYSTEM\"\n```\n\n### Advanced Remoting\nWindows PowerShell remote management just begins here. By using the cmdlets installed with Windows PowerShell, you can establish and configure remote sessions both from the local and remote ends, create customized and restricted sessions, allow users to import commands from a remote session that actually run implicitly on the remote session, configure the security of a remote session, and much more.\n\nTo facilitate remote configuration, Windows PowerShell includes a WSMan provider. The WSMAN: drive that the provider creates lets you navigate through a hierarchy of configuration settings on the local computer and remote computers.\n For more information about the WSMan provider, see  [WSMan Provider](https://technet.microsoft.com/en-us/library/dd819476.aspx) and\n  [About WS-Management Cmdlets](https://technet.microsoft.com/en-us/library/dd819481.aspx), or in the Windows PowerShell console, type \"get\\-help wsman\".\n\nFor more information, see:\n- [About Remote FAQ](https://technet.microsoft.com/en-us/library/dd315359.aspx)\n- [Register-PSSessionConfiguration](https://technet.microsoft.com/en-us/library/dd819496.aspx)\n- [Import-PSSession](https://technet.microsoft.com/en-us/library/dd347575.aspx). \n\nFor help with remoting errors, see [about_Remote_Troubleshooting](https://technet.microsoft.com/en-us/library/dd347642.aspx).\n\n## See Also\n- [about_Remote](https://technet.microsoft.com/en-us/library/9b4a5c87-9162-4adf-bdfe-fbc80b9b8970)\n- [about_Remote_FAQ](https://technet.microsoft.com/en-us/library/e23702fd-9415-4a98-9975-390a4d3adc42)\n- [about_Remote_Requirements](https://technet.microsoft.com/en-us/library/da213949-134c-4741-b307-81f4492ba1bd)\n- [about_Remote_Troubleshooting](https://technet.microsoft.com/en-us/library/2f890148-8578-49ed-85ea-79a489dd6317)\n- [about_PSSessions](https://technet.microsoft.com/en-us/library/7a9b4e0e-fa1b-47b0-92f6-6e2995d70acb)\n- [about_WS-Management_Cmdlets](https://technet.microsoft.com/en-us/library/6ed3370a-ea10-45a5-9493-696aeace27ed)\n- [Invoke-Command](https://technet.microsoft.com/en-us/library/22fd98ba-1874-492e-95a5-c069467b8462)\n- [Import-PSSession](https://technet.microsoft.com/en-us/library/048c115e-a6fb-4e0d-8cea-c5ca24630c9d)\n- [New-PSSession](https://technet.microsoft.com/en-us/library/59452f12-a11d-4558-99ea-e6ca6ad5ffd3)\n- [Register-PSSessionConfiguration](https://technet.microsoft.com/en-us/library/af68867a-d201-4b19-a1de-594015ed8a25)\n- [WSMan Provider](https://technet.microsoft.com/en-us/library/66fe1241-e08f-49ca-832f-a84c33ca8735)\n\n"
}