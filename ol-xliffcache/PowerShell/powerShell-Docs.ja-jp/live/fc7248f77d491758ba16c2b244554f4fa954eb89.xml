{"nodes":[{"content":"How to Write and Run Scripts in the Windows PowerShell ISE","pos":[11,69]},{"content":"How to Write and Run Scripts in the Windows PowerShell ISE","pos":[204,262]},{"content":"This topic describes how to create, edit, run, and save scripts in the Script Pane.","pos":[263,346]},{"content":"How to create and run scripts","pos":[353,382]},{"content":"How to write and edit text in the Script Pane","pos":[399,444]},{"content":"How to save a script","pos":[461,481]},{"pos":[517,546],"content":"How to create and run scripts"},{"content":"You can open and edit Windows PowerShellÂ® files in the Script Pane.","pos":[547,615]},{"content":"Specific file types of interest in Windows PowerShellÂ® are script files (.ps1), script data files (.psd1), and script module files (.psm1).","pos":[616,756]},{"content":"These file types are syntax colored in the Script Pane editor.","pos":[757,819]},{"content":"Other common file types you may open in the Script Pane are configuration files (.ps1xml), XML files, and text files.","pos":[820,937]},{"pos":[941,1504],"content":"[!NOTE]\nThe Windows PowerShell execution policy determines whether you can run scripts and load Windows PowerShell profiles and configuration files. The default execution policy, Restricted, prevents all scripts from running, and prevents loading profiles. To change the execution policy to allow profiles to load and be used, see [Set-ExecutionPolicy[PSITPro5_Security]](https://technet.microsoft.com/en-us/library/5690a0e1-495b-4e63-8280-65ead7bf01ab) and [about_Signing [v4]](https://technet.microsoft.com/en-us/library/fcbdd3b9-0b9f-4734-b5c7-e0dcc304fa1d).","leadings":["","> "],"nodes":[{"content":"The Windows PowerShell execution policy determines whether you can run scripts and load Windows PowerShell profiles and configuration files. The default execution policy, Restricted, prevents all scripts from running, and prevents loading profiles. To change the execution policy to allow profiles to load and be used, see [Set-ExecutionPolicy[PSITPro5_Security]](https://technet.microsoft.com/en-us/library/5690a0e1-495b-4e63-8280-65ead7bf01ab) and [about_Signing [v4]](https://technet.microsoft.com/en-us/library/fcbdd3b9-0b9f-4734-b5c7-e0dcc304fa1d)","pos":[8,560],"nodes":[{"content":"The Windows PowerShell execution policy determines whether you can run scripts and load Windows PowerShell profiles and configuration files.","pos":[0,140]},{"content":"The default execution policy, Restricted, prevents all scripts from running, and prevents loading profiles.","pos":[141,248]},{"content":"To change the execution policy to allow profiles to load and be used, see <bpt id=\"p1\">[</bpt>Set-ExecutionPolicy[PSITPro5_Security]<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/5690a0e1-495b-4e63-8280-65ead7bf01ab)</ept> and <bpt id=\"p2\">[</bpt>about_Signing [v4]<ept id=\"p2\">](https://technet.microsoft.com/en-us/library/fcbdd3b9-0b9f-4734-b5c7-e0dcc304fa1d)</ept>","pos":[249,552]}]}]},{"content":"To create a new script file","pos":[1510,1537]},{"content":"On the toolbar, click <bpt id=\"p1\">**</bpt>New<ept id=\"p1\">**</ept> , or on the <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept> menu, click <bpt id=\"p3\">**</bpt>New<ept id=\"p3\">**</ept>.","pos":[1538,1609]},{"content":"The created file appears in a new file tab under the current PowerShell tab.","pos":[1610,1686]},{"content":"Remember that the PowerShell tabs are only visible when there are more than one.","pos":[1687,1767]},{"content":"By default a file of type script (.ps1) is created, but it can be saved with a new name and extension.","pos":[1768,1870]},{"content":"Multiple script files can be created in the same PowerShell tab.","pos":[1871,1935]},{"content":"To open an existing script","pos":[1941,1967]},{"content":"On the toolbar, click <bpt id=\"p1\">**</bpt>Open…<ept id=\"p1\">**</ept>, or on the <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept> menu, click <bpt id=\"p3\">**</bpt>Open<ept id=\"p3\">**</ept>.","pos":[1968,2041]},{"content":"In the <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> dialog box, select the file you want to open.","pos":[2042,2103]},{"content":"The opened file appears in a new tab.","pos":[2104,2141]},{"content":"To close a script tab","pos":[2147,2168]},{"content":"Click the script tab of the script you want to close, then do one of the following:","pos":[2169,2252]},{"pos":[2258,2305],"content":"Click the <bpt id=\"p1\">**</bpt>Close<ept id=\"p1\">**</ept> icon (X) on the script tab."},{"pos":[2311,2348],"content":"On the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>"},{"content":"If the file has been altered since it was last saved, you are prompted to save or discard it.","pos":[2351,2444]},{"content":"To display the file path","pos":[2450,2474]},{"content":"On the file tab, point to the file name.","pos":[2475,2515]},{"content":"The fully qualified path to the script file appears in a tooltip.","pos":[2516,2581]},{"content":"To run a script","pos":[2587,2602]},{"pos":[2603,2679],"content":"On the toolbar, click <bpt id=\"p1\">**</bpt>Run Script<ept id=\"p1\">**</ept>, or on the <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept> menu, click <bpt id=\"p3\">**</bpt>Run<ept id=\"p3\">**</ept>"},{"content":"To run a portion of a script","pos":[2686,2714]},{"content":"In the Script Pane, select a portion of a script.","pos":[2720,2769]},{"pos":[2775,2864],"content":"On the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Run Selection<ept id=\"p2\">**</ept>, or on the toolbar, click <bpt id=\"p3\">**</bpt>Run Selection<ept id=\"p3\">**</ept>"},{"content":"To stop a running script","pos":[2871,2895]},{"content":"On the toolbar, click <bpt id=\"p1\">**</bpt>Stop Operation<ept id=\"p1\">**</ept>, press CTRL\\+BREAK, or on the <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept> menu, click <bpt id=\"p3\">**</bpt>Stop Operation<ept id=\"p3\">**</ept>.","pos":[2896,3007]},{"content":"Pressing <bpt id=\"p1\">**</bpt>CTRL\\+C<ept id=\"p1\">**</ept> also works unless some text is currently selected, in which case <bpt id=\"p2\">**</bpt>CTRL\\+C<ept id=\"p2\">**</ept> maps to the copy function for the selected text.","pos":[3008,3154]},{"pos":[3180,3225],"content":"How to write and edit text in the Script Pane"},{"content":"Use the following steps to edit text in the Script Pane.","pos":[3226,3282]},{"content":"You can copy, cut, paste, find, and replace text.","pos":[3283,3332]},{"content":"You can also undo and redo the last action you just performed.","pos":[3333,3395]},{"content":"The keyboard shortcuts for performing these actions are the same as those used for all Windows applications.","pos":[3396,3504]},{"content":"To enter text in the Script Pane","pos":[3510,3542]},{"pos":[3548,3682],"content":"Move the cursor to the Script Pane by clicking anywhere in the Script Pane, or by clicking <bpt id=\"p1\">**</bpt>Go to Script Pane<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>View<ept id=\"p2\">**</ept> menu."},{"content":"Create a script.","pos":[3688,3704]},{"content":"Syntax coloring and tab completion make this a richer experience in Windows PowerShell ISE.","pos":[3705,3796]},{"pos":[3802,4005],"content":"See <bpt id=\"p1\">[</bpt>How to Use Tab Completion in the Script Pane and Console Pane<ept id=\"p1\">](How-to-Use-Tab-Completion-in-the-Script-Pane-and-Console-Pane.md)</ept> for details about using the tab completion feature to help in typing."},{"content":"To find text in the Script Pane","pos":[4011,4042]},{"pos":[4048,4139],"content":"To find text anywhere, press <bpt id=\"p1\">**</bpt>CTRL\\+F<ept id=\"p1\">**</ept> or, on the <bpt id=\"p2\">**</bpt>Edit<ept id=\"p2\">**</ept> menu, click <bpt id=\"p3\">**</bpt>Find in Script<ept id=\"p3\">**</ept>"},{"pos":[4146,4245],"content":"To find text after the cursor, press <bpt id=\"p1\">**</bpt>F3<ept id=\"p1\">**</ept> or, on the <bpt id=\"p2\">**</bpt>Edit<ept id=\"p2\">**</ept> menu, click <bpt id=\"p3\">**</bpt>Find Next in Script<ept id=\"p3\">**</ept>"},{"pos":[4252,4363],"content":"To find text before the cursor, press <bpt id=\"p1\">**</bpt>SHIFT\\+F3<ept id=\"p1\">**</ept> or, on the <bpt id=\"p2\">**</bpt>Edit<ept id=\"p2\">**</ept> menu, click <bpt id=\"p3\">**</bpt>Find Previous in Script<ept id=\"p3\">**</ept>"},{"content":"To find and replace text in the Script Pane","pos":[4370,4413]},{"content":"Press <bpt id=\"p1\">**</bpt>CRTL\\+H<ept id=\"p1\">**</ept> or, on the <bpt id=\"p2\">**</bpt>Edit<ept id=\"p2\">**</ept> menu, click <bpt id=\"p3\">**</bpt>Replace in Script<ept id=\"p3\">**</ept>.","pos":[4414,4486]},{"content":"Enter both the text you want to find and the text with which you want to replace it, and then press <bpt id=\"p1\">**</bpt>ENTER<ept id=\"p1\">**</ept>","pos":[4487,4596]},{"content":"To go to a particular line of text in the Script Pane","pos":[4603,4656]},{"pos":[4662,4746],"content":"In the Script Pane, press <bpt id=\"p1\">**</bpt>CTRL\\+G<ept id=\"p1\">**</ept> or, on the <bpt id=\"p2\">**</bpt>Edit<ept id=\"p2\">**</ept> menu, click <bpt id=\"p3\">**</bpt>Go to Line<ept id=\"p3\">**</ept>"},{"content":"Enter a line number.","pos":[4753,4773]},{"content":"To copy text in the Script Pane","pos":[4779,4810]},{"content":"In the Script Pane, select the text that you want to copy.","pos":[4816,4874]},{"pos":[4880,4982],"content":"Press <bpt id=\"p1\">**</bpt>CTRL\\+C<ept id=\"p1\">**</ept> or, on the toolbar, click the <bpt id=\"p2\">**</bpt>Copy<ept id=\"p2\">**</ept> icon, or on the <bpt id=\"p3\">**</bpt>Edit<ept id=\"p3\">**</ept> menu, click <bpt id=\"p4\">**</bpt>Copy<ept id=\"p4\">**</ept>"},{"content":"To cut text in the Script Pane","pos":[4989,5019]},{"content":"In the Script Pane, select the text that you want to cut.","pos":[5025,5082]},{"pos":[5088,5188],"content":"Press <bpt id=\"p1\">**</bpt>CTRL\\+X<ept id=\"p1\">**</ept> or, on the toolbar, click the <bpt id=\"p2\">**</bpt>Cut<ept id=\"p2\">**</ept> icon, or on the <bpt id=\"p3\">**</bpt>Edit<ept id=\"p3\">**</ept> menu, click <bpt id=\"p4\">**</bpt>Cut<ept id=\"p4\">**</ept>"},{"content":"To paste text into the Script Pane","pos":[5195,5229]},{"pos":[5230,5334],"content":"Press <bpt id=\"p1\">**</bpt>CTRL\\+V<ept id=\"p1\">**</ept> or, on the toolbar, click the <bpt id=\"p2\">**</bpt>Paste<ept id=\"p2\">**</ept> icon, or on the <bpt id=\"p3\">**</bpt>Edit<ept id=\"p3\">**</ept> menu, click <bpt id=\"p4\">**</bpt>Paste<ept id=\"p4\">**</ept>"},{"content":"To undo an action in the Script Pane","pos":[5341,5377]},{"pos":[5378,5480],"content":"Press <bpt id=\"p1\">**</bpt>CTRL\\+Z<ept id=\"p1\">**</ept> or, on the toolbar, click the <bpt id=\"p2\">**</bpt>Undo<ept id=\"p2\">**</ept> icon, or on the <bpt id=\"p3\">**</bpt>Edit<ept id=\"p3\">**</ept> menu, click <bpt id=\"p4\">**</bpt>Undo<ept id=\"p4\">**</ept>"},{"content":"To redo an action in the Script Pane","pos":[5487,5523]},{"pos":[5524,5626],"content":"Press <bpt id=\"p1\">**</bpt>CTRL\\+Y<ept id=\"p1\">**</ept> or, on the toolbar, click the <bpt id=\"p2\">**</bpt>Redo<ept id=\"p2\">**</ept> icon, or on the <bpt id=\"p3\">**</bpt>Edit<ept id=\"p3\">**</ept> menu, click <bpt id=\"p4\">**</bpt>Redo<ept id=\"p4\">**</ept>"},{"pos":[5653,5673],"content":"How to save a script"},{"content":"Use the following steps to save and name a script.","pos":[5674,5724]},{"content":"An asterisk appears next to the script name to mark a file that has not been saved since it was altered.","pos":[5725,5829]},{"content":"The asterisk disappears when the file is saved.","pos":[5830,5877]},{"content":"To save a script","pos":[5883,5899]},{"pos":[5900,6002],"content":"Press <bpt id=\"p1\">**</bpt>CTRL\\+S<ept id=\"p1\">**</ept> or, on the toolbar, click the <bpt id=\"p2\">**</bpt>Save<ept id=\"p2\">**</ept> icon, or on the <bpt id=\"p3\">**</bpt>File<ept id=\"p3\">**</ept> menu, click <bpt id=\"p4\">**</bpt>Save<ept id=\"p4\">**</ept>"},{"content":"To save and name a script","pos":[6009,6034]},{"content":"On the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Save As<ept id=\"p2\">**</ept>.","pos":[6040,6080]},{"content":"The <bpt id=\"p1\">**</bpt>Save As<ept id=\"p1\">**</ept> dialog box will appear.","pos":[6081,6120]},{"pos":[6126,6178],"content":"In the <bpt id=\"p1\">**</bpt>File name<ept id=\"p1\">**</ept> box, enter a name for the file."},{"content":"In the <bpt id=\"p1\">**</bpt>Save as type<ept id=\"p1\">**</ept> box, select a file type.","pos":[6184,6232]},{"content":"For example, in the <bpt id=\"p1\">**</bpt>Save as type<ept id=\"p1\">**</ept> box, select “PowerShell Scripts (\\* .ps1)”.","pos":[6233,6313]},{"pos":[6319,6333],"content":"Click <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept>"},{"content":"To save a script in ASCII encoding","pos":[6340,6374]},{"content":"By default, Windows PowerShell ISE saves new script files (.ps1), script data files (.psd1), and script module files (.psm1) as Unicode (BigEndianUnicode) by default.","pos":[6375,6541]},{"content":"To save a script in another encoding, such as ASCII (ANSI), use the <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>SaveAs<ept id=\"p2\">**</ept> methods on the <bpt id=\"p3\">[</bpt>$psISE.CurrentFile<ept id=\"p3\">](https://technet.microsoft.com/en-us/library/bc3300e4-9c17-4f00-a621-c8867126e3b3#CurrentFile)</ept> object.","pos":[6542,6770]},{"content":"The following command saves a new script as MyScript.ps1 with ASCII encoding.","pos":[6772,6849]},{"content":"The following command replaces the current script file with a file with the same name, but with ASCII encoding.","pos":[6933,7044]},{"content":"The following command gets the encoding of the current file.","pos":[7110,7170]},{"content":"Windows PowerShell ISE supports the following encoding options: ASCII, BigEndianUnicode, Unicode, UTF32, UTF7, UTF8 and Default.","pos":[7209,7337]},{"content":"The value of the Default option varies with the system.","pos":[7338,7393]},{"content":"Windows PowerShell ISE does not change the encoding of scripts that were created by in other editors, even when you use the Save or Save As commands in Windows PowerShell ISE.","pos":[7395,7570]},{"content":"See Also","pos":[7575,7583]},{"content":"Using the Windows PowerShell ISE","pos":[7585,7617]}],"content":"---\ntitle: How to Write and Run Scripts in the Windows PowerShell ISE\nms.custom: na\nms.reviewer: na\nms.suite: na\nms.tgt_pltfrm: na\nms.topic: article\nms.assetid: 62f916d9-b3a1-484a-bdfb-41f57112c22b\n---\n# How to Write and Run Scripts in the Windows PowerShell ISE\nThis topic describes how to create, edit, run, and save scripts in the Script Pane.\n\n-   [How to create and run scripts](#bkmk_1)\n\n-   [How to write and edit text in the Script Pane](#bkmk_2)\n\n-   [How to save a script](#bkmk_3)\n\n## <a name=\"bkmk_1\"></a>How to create and run scripts\nYou can open and edit Windows PowerShellÂ® files in the Script Pane. Specific file types of interest in Windows PowerShellÂ® are script files (.ps1), script data files (.psd1), and script module files (.psm1). These file types are syntax colored in the Script Pane editor. Other common file types you may open in the Script Pane are configuration files (.ps1xml), XML files, and text files.\n\n> [!NOTE]\n> The Windows PowerShell execution policy determines whether you can run scripts and load Windows PowerShell profiles and configuration files. The default execution policy, Restricted, prevents all scripts from running, and prevents loading profiles. To change the execution policy to allow profiles to load and be used, see [Set-ExecutionPolicy[PSITPro5_Security]](https://technet.microsoft.com/en-us/library/5690a0e1-495b-4e63-8280-65ead7bf01ab) and [about_Signing [v4]](https://technet.microsoft.com/en-us/library/fcbdd3b9-0b9f-4734-b5c7-e0dcc304fa1d).\n\n### To create a new script file\nOn the toolbar, click **New** , or on the **File** menu, click **New**. The created file appears in a new file tab under the current PowerShell tab. Remember that the PowerShell tabs are only visible when there are more than one. By default a file of type script (.ps1) is created, but it can be saved with a new name and extension. Multiple script files can be created in the same PowerShell tab.\n\n### To open an existing script\nOn the toolbar, click **Open…**, or on the **File** menu, click **Open**. In the **Open** dialog box, select the file you want to open. The opened file appears in a new tab.\n\n### To close a script tab\nClick the script tab of the script you want to close, then do one of the following:\n\n1.  Click the **Close** icon (X) on the script tab.\n\n2.  On the **File** menu, click **Close**.\n\nIf the file has been altered since it was last saved, you are prompted to save or discard it.\n\n### To display the file path\nOn the file tab, point to the file name. The fully qualified path to the script file appears in a tooltip.\n\n### To run a script\nOn the toolbar, click **Run Script**, or on the **File** menu, click **Run**.\n\n### To run a portion of a script\n\n1.  In the Script Pane, select a portion of a script.\n\n2.  On the **File** menu, click **Run Selection**, or on the toolbar, click **Run Selection**.\n\n### To stop a running script\nOn the toolbar, click **Stop Operation**, press CTRL\\+BREAK, or on the **File** menu, click **Stop Operation**. Pressing **CTRL\\+C** also works unless some text is currently selected, in which case **CTRL\\+C** maps to the copy function for the selected text.\n\n## <a name=\"bkmk_2\"></a>How to write and edit text in the Script Pane\nUse the following steps to edit text in the Script Pane. You can copy, cut, paste, find, and replace text. You can also undo and redo the last action you just performed. The keyboard shortcuts for performing these actions are the same as those used for all Windows applications.\n\n### To enter text in the Script Pane\n\n1.  Move the cursor to the Script Pane by clicking anywhere in the Script Pane, or by clicking **Go to Script Pane** in the **View** menu.\n\n2.  Create a script. Syntax coloring and tab completion make this a richer experience in Windows PowerShell ISE.\n\n3.  See [How to Use Tab Completion in the Script Pane and Console Pane](How-to-Use-Tab-Completion-in-the-Script-Pane-and-Console-Pane.md) for details about using the tab completion feature to help in typing.\n\n### To find text in the Script Pane\n\n1.  To find text anywhere, press **CTRL\\+F** or, on the **Edit** menu, click **Find in Script**.\n\n2.  To find text after the cursor, press **F3** or, on the **Edit** menu, click **Find Next in Script**.\n\n3.  To find text before the cursor, press **SHIFT\\+F3** or, on the **Edit** menu, click **Find Previous in Script**.\n\n### To find and replace text in the Script Pane\nPress **CRTL\\+H** or, on the **Edit** menu, click **Replace in Script**. Enter both the text you want to find and the text with which you want to replace it, and then press **ENTER**.\n\n### To go to a particular line of text in the Script Pane\n\n1.  In the Script Pane, press **CTRL\\+G** or, on the **Edit** menu, click **Go to Line**.\n\n2.  Enter a line number.\n\n### To copy text in the Script Pane\n\n1.  In the Script Pane, select the text that you want to copy.\n\n2.  Press **CTRL\\+C** or, on the toolbar, click the **Copy** icon, or on the **Edit** menu, click **Copy**.\n\n### To cut text in the Script Pane\n\n1.  In the Script Pane, select the text that you want to cut.\n\n2.  Press **CTRL\\+X** or, on the toolbar, click the **Cut** icon, or on the **Edit** menu, click **Cut**.\n\n### To paste text into the Script Pane\nPress **CTRL\\+V** or, on the toolbar, click the **Paste** icon, or on the **Edit** menu, click **Paste**.\n\n### To undo an action in the Script Pane\nPress **CTRL\\+Z** or, on the toolbar, click the **Undo** icon, or on the **Edit** menu, click **Undo**.\n\n### To redo an action in the Script Pane\nPress **CTRL\\+Y** or, on the toolbar, click the **Redo** icon, or on the **Edit** menu, click **Redo**.\n\n## <a name=\"bkmk_3\"></a>How to save a script\nUse the following steps to save and name a script. An asterisk appears next to the script name to mark a file that has not been saved since it was altered. The asterisk disappears when the file is saved.\n\n### To save a script\nPress **CTRL\\+S** or, on the toolbar, click the **Save** icon, or on the **File** menu, click **Save**.\n\n### To save and name a script\n\n1.  On the **File** menu, click **Save As**. The **Save As** dialog box will appear.\n\n2.  In the **File name** box, enter a name for the file.\n\n3.  In the **Save as type** box, select a file type. For example, in the **Save as type** box, select “PowerShell Scripts (\\* .ps1)”.\n\n4.  Click **Save**.\n\n### To save a script in ASCII encoding\nBy default, Windows PowerShell ISE saves new script files (.ps1), script data files (.psd1), and script module files (.psm1) as Unicode (BigEndianUnicode) by default. To save a script in another encoding, such as ASCII (ANSI), use the **Save** or **SaveAs** methods on the [$psISE.CurrentFile](https://technet.microsoft.com/en-us/library/bc3300e4-9c17-4f00-a621-c8867126e3b3#CurrentFile) object.\n\nThe following command saves a new script as MyScript.ps1 with ASCII encoding.\n\n```\n$psise.CurrentFile.SaveAs(\"MyScript.ps1\", [System.Text.Encoding]::ASCII)\n```\n\nThe following command replaces the current script file with a file with the same name, but with ASCII encoding.\n\n```\n$psise.CurrentFile.Save([System.Text.Encoding]::ASCII)\n```\n\nThe following command gets the encoding of the current file.\n\n```\n$psise.CurrentFile.encoding\n```\n\nWindows PowerShell ISE supports the following encoding options: ASCII, BigEndianUnicode, Unicode, UTF32, UTF7, UTF8 and Default. The value of the Default option varies with the system.\n\nWindows PowerShell ISE does not change the encoding of scripts that were created by in other editors, even when you use the Save or Save As commands in Windows PowerShell ISE.\n\n## See Also\n[Using the Windows PowerShell ISE](Using-the-Windows-PowerShell-ISE.md)\n\n"}