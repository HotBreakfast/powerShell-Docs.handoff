{"nodes":[{"content":"Getting WMI Objects  Get WmiObject","pos":[12,46]},{"content":"Getting WMI Objects (Get-WmiObject)","pos":[245,280]},{"content":"Getting WMI Objects (Get\\-WmiObject)","pos":[285,321]},{"content":"Windows Management Instrumentation (WMI) is a core technology for Windows system administration because it exposes a wide range of information in a uniform manner.","pos":[322,485]},{"content":"Because of how much WMI makes possible, the Windows PowerShell cmdlet for accessing WMI objects, <bpt id=\"p1\">**</bpt>Get\\-WmiObject<ept id=\"p1\">**</ept>, is one of the most useful for doing real work.","pos":[486,649]},{"content":"We are going to discuss how to use Get\\-WmiObject to access WMI objects and then how to use WMI objects to do specific things.","pos":[650,776]},{"content":"Listing WMI Classes","pos":[782,801]},{"content":"The first problem most WMI users encounter is trying to find out what can be done with WMI.","pos":[802,893]},{"content":"WMI classes describe the resources that can be managed.","pos":[894,949]},{"content":"There are hundreds of WMI classes, some of which contain dozens of properties.","pos":[950,1028]},{"content":"<bpt id=\"p1\">**</bpt>Get\\-WmiObject<ept id=\"p1\">**</ept> addresses this problem by making WMI discoverable.","pos":[1030,1099]},{"content":"You can get a list of the WMI classes available on the local computer by typing:","pos":[1100,1180]},{"content":"You can retrieve the same information from a remote computer by using the ComputerName parameter, specifying a computer name or IP address:","pos":[1534,1673]},{"content":"The class listing returned by remote computers may vary due to the specific operating system the computer is running and the particular WMI extensions added by installed applications.","pos":[1917,2100]},{"pos":[2104,2528],"content":"[!NOTE]\nWhen using Get\\-WmiObject to connect to a remote computer, the remote computer must be running WMI and, under the default configuration, the account you are using must be in the local administrators group on the remote computer. The remote system does not need to have Windows PowerShell installed. This allows you to administer operating systems that are not running Windows PowerShell, but do have WMI available.","leadings":["","> "],"nodes":[{"content":"When using Get\\-WmiObject to connect to a remote computer, the remote computer must be running WMI and, under the default configuration, the account you are using must be in the local administrators group on the remote computer.","pos":[8,236]},{"content":"The remote system does not need to have Windows PowerShell installed.","pos":[237,306]},{"content":"This allows you to administer operating systems that are not running Windows PowerShell, but do have WMI available.","pos":[307,422]}]},{"content":"You can even include the ComputerName when connecting to the local system.","pos":[2530,2604]},{"content":"You can use the local computer's name, its IP address (or the loopback address 127.0.0.1), or the WMI\\-style '.' as the computer name.","pos":[2605,2739]},{"content":"If you are running Windows PowerShell on a computer named Admin01 with IP address 192.168.1.90, the following commands will all return the WMI class listing for that computer:","pos":[2740,2915]},{"content":"Get\\-WmiObject uses the root\\/cimv2 namespace by default.","pos":[3159,3216]},{"content":"If you want to specify another WMI namespace, use the <bpt id=\"p1\">**</bpt>Namespace<ept id=\"p1\">**</ept> parameter and specify the corresponding namespace path:","pos":[3217,3340]},{"content":"Displaying WMI Class Details","pos":[3535,3563]},{"content":"If you already know the name of a WMI class, you can use it to get information immediately.","pos":[3564,3655]},{"content":"For example, one of the WMI classes commonly used for retrieving information about a computer is <bpt id=\"p1\">**</bpt>Win32\\_OperatingSystem<ept id=\"p1\">**</ept>.","pos":[3656,3780]},{"content":"Although we are showing all of the parameters, the command can be expressed in a more succinct way.","pos":[4084,4183]},{"content":"The <bpt id=\"p1\">**</bpt>ComputerName<ept id=\"p1\">**</ept> parameter is not necessary when connecting to the local system.","pos":[4184,4268]},{"content":"We show it to demonstrate the most general case and remind you about the parameter.","pos":[4269,4352]},{"content":"The <bpt id=\"p1\">**</bpt>Namespace<ept id=\"p1\">**</ept> defaults to root\\/cimv2, and can be omitted as well.","pos":[4353,4423]},{"content":"Finally, most cmdlets allow you to omit the name of common parameters.","pos":[4424,4494]},{"content":"With Get\\-WmiObject, if no name is specified for the first parameter, Windows PowerShell treats it as the <bpt id=\"p1\">**</bpt>Class<ept id=\"p1\">**</ept> parameter.","pos":[4495,4621]},{"content":"This means the last command could have been issued by typing:","pos":[4622,4683]},{"content":"The <bpt id=\"p1\">**</bpt>Win32\\_OperatingSystem<ept id=\"p1\">**</ept> class has many more properties than those displayed here.","pos":[4730,4818]},{"content":"You can use Get\\-Member to see all the properties.","pos":[4819,4869]},{"content":"The properties of a WMI class are automatically available like other object properties:","pos":[4870,4957]},{"content":"Displaying Non\\-Default Properties with Format Cmdlets","pos":[5552,5606]},{"content":"If you want information contained in the <bpt id=\"p1\">**</bpt>Win32\\_OperatingSystem<ept id=\"p1\">**</ept> class that is not displayed by default, you can display it by using the <bpt id=\"p2\">**</bpt>Format<ept id=\"p2\">**</ept> cmdlets.","pos":[5607,5766]},{"content":"For example, if you want to display available memory data, type:","pos":[5767,5831]},{"pos":[6374,6541],"content":"<ph id=\"ph1\">[!NOTE]</ph> Wildcards work with property names in <bpt id=\"p1\">**</bpt>Format\\-Table<ept id=\"p1\">**</ept>, so the final pipeline element can be reduced to <bpt id=\"p2\">**</bpt>Format\\-Table \\-Property TotalV\\&amp;#42;,Free\\&amp;#42;<ept id=\"p2\">**</ept>","leadings":["","> "]},{"content":"The memory data might be more readable if you format it as a list by typing:","pos":[6543,6619]}],"content":"---\ntitle:  Getting WMI Objects  Get WmiObject \nms.date:  2016-05-11\nkeywords:  powershell,cmdlet\ndescription:  \nms.topic:  article\nauthor:  jpjofre\nmanager:  dongill\nms.prod:  powershell\nms.assetid:  f0ddfc7d-6b5e-4832-82de-2283597ea70d\n---\n\n# Getting WMI Objects (Get-WmiObject)\n\n## Getting WMI Objects (Get\\-WmiObject)\nWindows Management Instrumentation (WMI) is a core technology for Windows system administration because it exposes a wide range of information in a uniform manner. Because of how much WMI makes possible, the Windows PowerShell cmdlet for accessing WMI objects, **Get\\-WmiObject**, is one of the most useful for doing real work. We are going to discuss how to use Get\\-WmiObject to access WMI objects and then how to use WMI objects to do specific things.\n\n### Listing WMI Classes\nThe first problem most WMI users encounter is trying to find out what can be done with WMI. WMI classes describe the resources that can be managed. There are hundreds of WMI classes, some of which contain dozens of properties.\n\n**Get\\-WmiObject** addresses this problem by making WMI discoverable. You can get a list of the WMI classes available on the local computer by typing:\n\n```\nPS> Get-WmiObject -List\n\n__SecurityRelatedClass                  __NTLMUser9X\n__PARAMETERS                            __SystemSecurity\n__NotifyStatus                          __ExtendedStatus\nWin32_PrivilegesStatus                  Win32_TSNetworkAdapterSettingError\nWin32_TSRemoteControlSettingError       Win32_TSEnvironmentSettingError\n...\n```\n\nYou can retrieve the same information from a remote computer by using the ComputerName parameter, specifying a computer name or IP address:\n\n```\nPS> Get-WmiObject -List -ComputerName 192.168.1.29\n\n__SystemClass                           __NAMESPACE\n__Provider                              __Win32Provider\n__ProviderRegistration                  __ObjectProviderRegistration\n...\n```\n\nThe class listing returned by remote computers may vary due to the specific operating system the computer is running and the particular WMI extensions added by installed applications.\n\n> [!NOTE]\n> When using Get\\-WmiObject to connect to a remote computer, the remote computer must be running WMI and, under the default configuration, the account you are using must be in the local administrators group on the remote computer. The remote system does not need to have Windows PowerShell installed. This allows you to administer operating systems that are not running Windows PowerShell, but do have WMI available.\n\nYou can even include the ComputerName when connecting to the local system. You can use the local computer's name, its IP address (or the loopback address 127.0.0.1), or the WMI\\-style '.' as the computer name. If you are running Windows PowerShell on a computer named Admin01 with IP address 192.168.1.90, the following commands will all return the WMI class listing for that computer:\n\n```\nGet-WmiObject -List\nGet-WmiObject -List -ComputerName .\nGet-WmiObject -List -ComputerName Admin01\nGet-WmiObject -List -ComputerName 192.168.1.90\nGet-WmiObject -List -ComputerName 127.0.0.1\nGet-WmiObject -List -ComputerName localhost\n```\n\nGet\\-WmiObject uses the root\\/cimv2 namespace by default. If you want to specify another WMI namespace, use the **Namespace** parameter and specify the corresponding namespace path:\n\n```\nPS> Get-WmiObject -List -ComputerName 192.168.1.29 -Namespace root\n\n__SystemClass                           __NAMESPACE\n__Provider                              __Win32Provider\n...\n```\n\n### Displaying WMI Class Details\nIf you already know the name of a WMI class, you can use it to get information immediately. For example, one of the WMI classes commonly used for retrieving information about a computer is **Win32\\_OperatingSystem**.\n\n```\nPS> Get-WmiObject -Class Win32_OperatingSystem -Namespace root/cimv2 -ComputerName .\n\nSystemDirectory : C:\\WINDOWS\\system32\nOrganization    : Global Network Solutions\nBuildNumber     : 2600\nRegisteredUser  : Oliver W. Jones\nSerialNumber    : 12345-678-9012345-67890\nVersion         : 5.1.2600\n```\n\nAlthough we are showing all of the parameters, the command can be expressed in a more succinct way. The **ComputerName** parameter is not necessary when connecting to the local system. We show it to demonstrate the most general case and remind you about the parameter. The **Namespace** defaults to root\\/cimv2, and can be omitted as well. Finally, most cmdlets allow you to omit the name of common parameters. With Get\\-WmiObject, if no name is specified for the first parameter, Windows PowerShell treats it as the **Class** parameter. This means the last command could have been issued by typing:\n\n```\nGet-WmiObject Win32_OperatingSystem\n```\n\nThe **Win32\\_OperatingSystem** class has many more properties than those displayed here. You can use Get\\-Member to see all the properties. The properties of a WMI class are automatically available like other object properties:\n\n```\nPS> Get-WmiObject -Class Win32_OperatingSystem -Namespace root/cimv2 -ComputerName . | Get-Member -MemberType Property\n\n   TypeName: System.Management.ManagementObject#root\\cimv2\\Win32_OperatingSyste\nm\n\nName                                      MemberType Definition\n----                                      ---------- ----------\n__CLASS                                   Property   System.String __CLASS {...\n...\nBootDevice                                Property   System.String BootDevic...\nBuildNumber                               Property   System.String BuildNumb...\n...\n```\n\n#### Displaying Non\\-Default Properties with Format Cmdlets\nIf you want information contained in the **Win32\\_OperatingSystem** class that is not displayed by default, you can display it by using the **Format** cmdlets. For example, if you want to display available memory data, type:\n\n```\nPS> Get-WmiObject -Class Win32_OperatingSystem -Namespace root/cimv2 -ComputerName . | Format-Table -Property TotalVirtualMemorySize,TotalVisibleMemorySize,FreePhysicalMemory,FreeVirtualMemory,FreeSpaceInPagingFiles\n\nTotalVirtualMemorySize TotalVisibleMem FreePhysicalMem FreeVirtualMemo FreeSpaceInPagi\n                              ory              ry         ngFiles\n--------------- --------------- --------------- --------------- ---------------\n        2097024          785904          305808         2056724         1558232\n```\n\n> [!NOTE]\n> Wildcards work with property names in **Format\\-Table**, so the final pipeline element can be reduced to **Format\\-Table \\-Property TotalV\\&#42;,Free\\&#42;**\n\nThe memory data might be more readable if you format it as a list by typing:\n\n```\nPS> Get-WmiObject -Class Win32_OperatingSystem -Namespace root/cimv2 -ComputerName . | Format-List TotalVirtualMemorySize,TotalVisibleMemorySize,FreePhysicalMemory,FreeVirtualMemory,FreeSpaceInPagingFiles\n\nTotalVirtualMemorySize : 2097024\nTotalVisibleMemorySize : 785904\nFreePhysicalMemory     : 301876\nFreeVirtualMemory      : 2056724\nFreeSpaceInPagingFiles : 1556644\n```\n\n"}