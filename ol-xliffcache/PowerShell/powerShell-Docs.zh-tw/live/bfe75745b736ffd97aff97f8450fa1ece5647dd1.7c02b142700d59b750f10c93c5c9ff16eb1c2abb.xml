{"nodes":[{"content":"title:   Improvements to Package Management in WMF 5.1 (Preview) ms.date:  2016-07-15 keywords:  PowerShell, DSC, WMF description:","pos":[4,134]},{"content":"ms.topic:  article author:  jaimeo contributor: contributor:  jianyunt, quoctruong manager:  dongill ms.prod:  powershell ms.technology: WMF","pos":[137,277]},{"content":"Improvements to Package Management in WMF 5.1 (Preview)","pos":[285,340]},{"content":"Improvements in PackageManagement","pos":[346,379]},{"content":"The following are the fixes made in the WMF 5.1:","pos":[383,431]},{"content":"Version Alias","pos":[438,451]},{"content":"<bpt id=\"p1\">**</bpt>Scenario<ept id=\"p1\">**</ept>: If you have version 1.0 and 2.0 of a package, P1, installed on your system, and you want to uninstall version 1.0, you would run \"uninstall-package -name P1 -version 1.0\" and expect version 1.0 to be uninstalled after running the cmdlet.","pos":[453,704]},{"content":"However the result is that version 2.0 gets uninstalled.","pos":[705,761]},{"content":"This occurs because the \"-version\" parameter is an alias of the \"-minimumversion\" parameter.","pos":[769,861]},{"content":"When OneGet is looking for a qualified package with the minimum version of 1.0, it returns the latest version.","pos":[862,972]},{"content":"This behavior is expected in normal cases because finding the latest version is usually the desired result.","pos":[973,1080]},{"content":"However, it should not apply to the uninstall-package case..","pos":[1081,1141]},{"pos":[1147,1220],"content":"<bpt id=\"p1\">**</bpt>Solution<ept id=\"p1\">**</ept>:removed -version alias entirely in OneGet and PowerShellGet."},{"content":"Multiple prompts for bootstrapping the NuGet provider","pos":[1226,1279]},{"content":"<bpt id=\"p1\">**</bpt>Scenario<ept id=\"p1\">**</ept>: When you run Find-Module or Install-module or other OneGet cmdlets on your computer for the first time, OneGet tries to bootstrap the NuGet provider.","pos":[1281,1444]},{"content":"It does this because the PowerShellGet provider also uses the NuGet provider to download PowerShell modules.","pos":[1445,1553]},{"content":"OneGet then prompts the user for permission to install the NuGet provider.","pos":[1554,1628]},{"content":"After the user selects \"yes\" for the bootstrapping, the latest version of the NuGet provider will be installed.","pos":[1629,1740]},{"content":"However, in some cases, when you have an old version of NuGet provider installed on your computer, the older version of NuGet sometimes gets loaded first into the PowerShell session (that's the race condition in OneGet).","pos":[1747,1967]},{"content":"However PowerShellGet requires the later version of the NuGet provider to work, so PowerShellGet asks the OneGet for bootstrapping the NuGet provider again.","pos":[1968,2124]},{"content":"This results in multiple prompts for bootstrapping the NuGet provider.","pos":[2125,2195]},{"pos":[2197,2339],"content":"<bpt id=\"p1\">**</bpt>Solution<ept id=\"p1\">**</ept>: In WMF5.1, OneGet loads the latest version of the NuGet provider to avoid multiple prompts for bootstrapping the NuGet provider."},{"pos":[2341,2582],"content":"You could also work around this issue by manually deleting the old version of the NuGet provider (NuGet-Anycpu.exe) if exists from $env:ProgramFiles\\PackageManagement\\ProviderAssemblies $env:LOCALAPPDATA\\PackageManagement\\ProviderAssemblies"},{"content":"Support for OneGet on computers with intranet access only","pos":[2588,2645]},{"content":"<bpt id=\"p1\">**</bpt>Scenario<ept id=\"p1\">**</ept>: For the enterprise scenario, people are working under an environment where there is no internet access but Intranet only.","pos":[2647,2782]},{"content":"OneGet did not support this case in WMF 5.0.","pos":[2783,2827]},{"pos":[2829,2938],"content":"<bpt id=\"p1\">**</bpt>Scenario<ept id=\"p1\">**</ept>: In WMF 5.0, OneGet did not support computers that have only intranet (but not internet) access."},{"pos":[2940,3035],"content":"<bpt id=\"p1\">**</bpt>Solution<ept id=\"p1\">**</ept>: In WMF 5.1, you can follow these steps to allow intranet computers to use OneGet:"},{"content":"Download the NuGet provider using another computer that has an internet connection by using Install-PackageProvider NuGet.","pos":[3040,3162]},{"content":"Find the NuGet provider under either  $env:ProgramFiles\\PackageManagement\\ProviderAssemblies\\nuget  or  $env:LOCALAPPDATA\\PackageManagement\\ProviderAssemblies\\nuget.","pos":[3167,3332]},{"pos":[3338,3531],"content":"Copy the binaries to a folder or network share location that the intranet computer can access, and then install the NuGet provider with \"Install-PackageProvider NuGet -Source <ph id=\"ph1\">&lt;Path to folder&gt;</ph>\"."},{"content":"Event logging improvements","pos":[3537,3563]},{"content":"When you install packages, you are changing the state of the computer.","pos":[3565,3635]},{"content":"In WMF 5.1, OneGet now logs events to the Windows event log for install, uninstall, and save-package activities.","pos":[3636,3748]},{"content":"The Event channel is the same as for PowerShell, that is, Microsoft-Windows-PowerShell, Operational.","pos":[3749,3849]},{"content":"Support for basic authentication","pos":[3854,3886]},{"content":"In WMF 5.1, OneGet supports finding and installing packages from a repository that requires basic authentication.","pos":[3888,4001]},{"content":"You can supply your credentials to the Find-Package and Install-Package cmdlets.","pos":[4002,4082]},{"content":"For example:","pos":[4083,4095]},{"content":"Support for using OneGet behind a proxy","pos":[4192,4231]},{"content":"In WMF 5.1, OneGet now takes new proxy parameters: -ProxyCredential and -Proxy.","pos":[4233,4312]},{"content":"Using these parameters, you can specify the proxy URL and credentials to OneGet cmdlets.","pos":[4313,4401]},{"content":"By default, system proxy settings are used.","pos":[4402,4445]},{"content":"For example:","pos":[4446,4458]}],"content":"---\ntitle:   Improvements to Package Management in WMF 5.1 (Preview)\nms.date:  2016-07-15\nkeywords:  PowerShell, DSC, WMF\ndescription:  \nms.topic:  article\nauthor:  jaimeo\ncontributor: contributor:  jianyunt, quoctruong\nmanager:  dongill\nms.prod:  powershell\nms.technology: WMF\n---\n\n# Improvements to Package Management in WMF 5.1 (Preview) #\n\n##Improvements in PackageManagement ##\nThe following are the fixes made in the WMF 5.1: \n\n### Version Alias\n\n**Scenario**: If you have version 1.0 and 2.0 of a package, P1, installed on your system, and you want to uninstall version 1.0, you would run \"uninstall-package -name P1 -version 1.0\" and expect version 1.0 to be uninstalled after running the cmdlet. However the result is that version 2.0 gets uninstalled.  \n    \nThis occurs because the \"-version\" parameter is an alias of the \"-minimumversion\" parameter. When OneGet is looking for a qualified package with the minimum version of 1.0, it returns the latest version. This behavior is expected in normal cases because finding the latest version is usually the desired result. However, it should not apply to the uninstall-package case..\n    \n**Solution**:removed -version alias entirely in OneGet and PowerShellGet. \n\n###Multiple prompts for bootstrapping the NuGet provider\n\n**Scenario**: When you run Find-Module or Install-module or other OneGet cmdlets on your computer for the first time, OneGet tries to bootstrap the NuGet provider. It does this because the PowerShellGet provider also uses the NuGet provider to download PowerShell modules. OneGet then prompts the user for permission to install the NuGet provider. After the user selects \"yes\" for the bootstrapping, the latest version of the NuGet provider will be installed. \n    \nHowever, in some cases, when you have an old version of NuGet provider installed on your computer, the older version of NuGet sometimes gets loaded first into the PowerShell session (that's the race condition in OneGet). However PowerShellGet requires the later version of the NuGet provider to work, so PowerShellGet asks the OneGet for bootstrapping the NuGet provider again. This results in multiple prompts for bootstrapping the NuGet provider.\n\n**Solution**: In WMF5.1, OneGet loads the latest version of the NuGet provider to avoid multiple prompts for bootstrapping the NuGet provider.\n\nYou could also work around this issue by manually deleting the old version of the NuGet provider (NuGet-Anycpu.exe) if exists from $env:ProgramFiles\\PackageManagement\\ProviderAssemblies \n$env:LOCALAPPDATA\\PackageManagement\\ProviderAssemblies\n\n\n###Support for OneGet on computers with intranet access only\n\n**Scenario**: For the enterprise scenario, people are working under an environment where there is no internet access but Intranet only. OneGet did not support this case in WMF 5.0.\n\n**Scenario**: In WMF 5.0, OneGet did not support computers that have only intranet (but not internet) access.\n\n**Solution**: In WMF 5.1, you can follow these steps to allow intranet computers to use OneGet:\n\n1. Download the NuGet provider using another computer that has an internet connection by using Install-PackageProvider NuGet.\n\n2. Find the NuGet provider under either  $env:ProgramFiles\\PackageManagement\\ProviderAssemblies\\nuget  or  $env:LOCALAPPDATA\\PackageManagement\\ProviderAssemblies\\nuget. \n\n3. Copy the binaries to a folder or network share location that the intranet computer can access, and then install the NuGet provider with \"Install-PackageProvider NuGet -Source <Path to folder>\".\n\n\n###Event logging improvements\n\nWhen you install packages, you are changing the state of the computer. In WMF 5.1, OneGet now logs events to the Windows event log for install, uninstall, and save-package activities. The Event channel is the same as for PowerShell, that is, Microsoft-Windows-PowerShell, Operational.\n\n###Support for basic authentication\n\nIn WMF 5.1, OneGet supports finding and installing packages from a repository that requires basic authentication. You can supply your credentials to the Find-Package and Install-Package cmdlets. For example:\n\n``` PowerShell\nFind-Package -Source <SourceWithCredential> -Credential (Get-Credential)\n```\n###Support for using OneGet behind a proxy\n\nIn WMF 5.1, OneGet now takes new proxy parameters: -ProxyCredential and -Proxy. Using these parameters, you can specify the proxy URL and credentials to OneGet cmdlets. By default, system proxy settings are used. For example:\n\n``` PowerShell\nFind-Package -Source http://www.nuget.org/api/v2/ -Proxy http://www.myproxyserver.com -ProxyCredential (Get-Credential)\n```\n\n"}