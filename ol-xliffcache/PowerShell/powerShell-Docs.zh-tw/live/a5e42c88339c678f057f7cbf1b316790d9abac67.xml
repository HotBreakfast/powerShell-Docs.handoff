{"nodes":[{"content":"How to Use Profiles in Windows PowerShell ISE","pos":[11,56]},{"content":"How to Use Profiles in Windows PowerShell ISE","pos":[191,236]},{"content":"This topic explains how to use Profiles in Windows PowerShellÂ® Integrated Scripting Environment (ISE).","pos":[237,340]},{"content":"We recommend that before performing the tasks in this section, you review <bpt id=\"p1\">[</bpt>about_Profiles [v4]<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/e1d9e30a-70cc-4f36-949f-fc7cd96b4054)</ept>, or in the Console Pane, type, “get\\-help about\\_profiles” and press <bpt id=\"p2\">**</bpt>ENTER<ept id=\"p2\">**</ept>","pos":[341,597]},{"content":"A profile is a Windows PowerShell ISE script that runs automatically when you start a new session.","pos":[600,698]},{"content":"You can create one or more Windows PowerShell profiles for Windows PowerShell ISE and use them to add the configure the Windows PowerShell or Windows PowerShell ISE environment, preparing it for your use, with variables, aliases, functions, and color and font preferences that you want available.","pos":[700,996]},{"content":"A profile affects every Windows PowerShell ISE session that you start.","pos":[997,1067]},{"pos":[1071,1503],"content":"[!NOTE]\nThe Windows PowerShell execution policy determines whether you can run scripts and load a profile. The default execution policy, “Restricted,” prevents all scripts from running, including profiles. If you use the “Restricted” policy, the profile cannot load. For more information about execution policy, see [about_Execution_Policies [v4]](https://technet.microsoft.com/en-us/library/347708dc-1515-4d74-978b-8334603472e6).","leadings":["","> "],"nodes":[{"content":"The Windows PowerShell execution policy determines whether you can run scripts and load a profile. The default execution policy, “Restricted,” prevents all scripts from running, including profiles. If you use the “Restricted” policy, the profile cannot load. For more information about execution policy, see [about_Execution_Policies [v4]](https://technet.microsoft.com/en-us/library/347708dc-1515-4d74-978b-8334603472e6)","pos":[8,429],"nodes":[{"content":"The Windows PowerShell execution policy determines whether you can run scripts and load a profile.","pos":[0,98]},{"content":"The default execution policy, “Restricted,” prevents all scripts from running, including profiles.","pos":[99,197]},{"content":"If you use the “Restricted” policy, the profile cannot load.","pos":[198,258]},{"content":"For more information about execution policy, see <bpt id=\"p1\">[</bpt>about_Execution_Policies [v4]<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/347708dc-1515-4d74-978b-8334603472e6)</ept>","pos":[259,421]}]}]},{"content":"Selecting a profile to use in the Windows PowerShell ISE","pos":[1508,1564]},{"content":"Windows PowerShell ISE supports profiles for the current user and all users.","pos":[1565,1641]},{"content":"It also supports the Windows PowerShell profiles that apply to all hosts.","pos":[1642,1715]},{"content":"The profile that you use is determined by how you use Windows PowerShell and Windows PowerShell ISE.","pos":[1717,1817]},{"content":"If you use only Windows PowerShell ISE to run Windows PowerShell, then save all your items in one of the ISE\\-specific profiles, such as the CurrentUserCurrentHost profile for Windows PowerShell ISE or the AllUsersCurrentHost profile for Windows PowerShell ISE.","pos":[1823,2084]},{"content":"If you use multiple host programs to run Windows PowerShell, save your functions, aliases, variables, and commands in a profile that affects all host programs, such as the CurrentUserAllHosts or the AllUsersAllHosts profile, and save ISE\\-specific features, like color and font customization in the CurrentUserCurrentHost profile for Windows PowerShell ISE profile or the AllUsersCurrentHost profile for Windows PowerShell ISE.","pos":[2090,2517]},{"content":"The following are profiles that can be created and used in Windows PowerShell ISE.","pos":[2519,2601]},{"content":"Each profile is saved to its own specific path.","pos":[2602,2649]},{"content":"Profile Type","pos":[2652,2664]},{"content":"Profile Path","pos":[2665,2677]},{"content":"“Current user, PowerShell ISE”","pos":[2716,2746]},{"content":"$profile.CurrentUserCurrentHost, or $profile","pos":[2747,2791]},{"content":"“All users, PowerShell ISE”","pos":[2794,2821]},{"content":"$profile.AllUsersCurrentHost","pos":[2822,2850]},{"content":"“Current user, All hosts”","pos":[2853,2878]},{"content":"$profile.CurrentUserAllHosts","pos":[2879,2907]},{"content":"“All users, All hosts”","pos":[2910,2932]},{"content":"$profile.AllUsersAllHosts","pos":[2933,2958]},{"content":"To create a new profile","pos":[2964,2987]},{"content":"To create a new “Current user, Windows PowerShell ISE” profile, run this command:","pos":[2988,3069]},{"content":"To create a new “All users, Windows PowerShell ISE” profile, run this command:","pos":[3153,3231]},{"content":"To create a new “Current user, All Hosts” profile, run this command:","pos":[3354,3422]},{"content":"To create a new “All users, All Hosts” profile, type:","pos":[3545,3598]},{"content":"To edit a profile","pos":[3717,3734]},{"content":"To open the profile, run the command psedit with the variable that specifies the profile you want to edit.","pos":[3740,3846]},{"content":"For example, to open the “Current user, Windows PowerShell ISE” profile, type:","pos":[3847,3925]},{"content":"Add some items to your profile.","pos":[3949,3980]},{"content":"The following are a few examples to get you started:","pos":[3981,4033]},{"content":"To change the default background color of the Console Pane to blue, in the profile file type: <ph id=\"ph1\">`$psISE.Options.OutputPaneBackground = 'blue'`</ph> .","pos":[4043,4185]},{"content":"For more information about the $psISE variable, see <bpt id=\"p1\">[</bpt>Windows PowerShell ISE Object Model Reference<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/e1a9e7d1-0fd5-47de-8d9b-f1be1ed13b0c)</ept>","pos":[4186,4367]},{"pos":[4378,4430],"content":"To change font size to 20, in the profile file type:"},{"content":"To save your profile file, on the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Save<ept id=\"p2\">**</ept>.","pos":[4466,4530]},{"content":"Next time you open the Windows PowerShell ISE, your customizations are applied.","pos":[4531,4610]},{"content":"See Also","pos":[4615,4623]},{"content":"about_Profiles [v4]","pos":[4625,4644]},{"content":"Using the Windows PowerShell ISE","pos":[4729,4761]}],"content":"---\ntitle: How to Use Profiles in Windows PowerShell ISE\nms.custom: na\nms.reviewer: na\nms.suite: na\nms.tgt_pltfrm: na\nms.topic: article\nms.assetid: 0219626a-6da5-4acc-b630-d058e8b29cc6\n---\n# How to Use Profiles in Windows PowerShell ISE\nThis topic explains how to use Profiles in Windows PowerShellÂ® Integrated Scripting Environment (ISE). We recommend that before performing the tasks in this section, you review [about_Profiles [v4]](https://technet.microsoft.com/en-us/library/e1d9e30a-70cc-4f36-949f-fc7cd96b4054), or in the Console Pane, type, “get\\-help about\\_profiles” and press **ENTER**.\n\nA profile is a Windows PowerShell ISE script that runs automatically when you start a new session.  You can create one or more Windows PowerShell profiles for Windows PowerShell ISE and use them to add the configure the Windows PowerShell or Windows PowerShell ISE environment, preparing it for your use, with variables, aliases, functions, and color and font preferences that you want available. A profile affects every Windows PowerShell ISE session that you start.\n\n> [!NOTE]\n> The Windows PowerShell execution policy determines whether you can run scripts and load a profile. The default execution policy, “Restricted,” prevents all scripts from running, including profiles. If you use the “Restricted” policy, the profile cannot load. For more information about execution policy, see [about_Execution_Policies [v4]](https://technet.microsoft.com/en-us/library/347708dc-1515-4d74-978b-8334603472e6).\n\n## Selecting a profile to use in the Windows PowerShell ISE\nWindows PowerShell ISE supports profiles for the current user and all users. It also supports the Windows PowerShell profiles that apply to all hosts.\n\nThe profile that you use is determined by how you use Windows PowerShell and Windows PowerShell ISE.\n\n-   If you use only Windows PowerShell ISE to run Windows PowerShell, then save all your items in one of the ISE\\-specific profiles, such as the CurrentUserCurrentHost profile for Windows PowerShell ISE or the AllUsersCurrentHost profile for Windows PowerShell ISE.\n\n-   If you use multiple host programs to run Windows PowerShell, save your functions, aliases, variables, and commands in a profile that affects all host programs, such as the CurrentUserAllHosts or the AllUsersAllHosts profile, and save ISE\\-specific features, like color and font customization in the CurrentUserCurrentHost profile for Windows PowerShell ISE profile or the AllUsersCurrentHost profile for Windows PowerShell ISE.\n\nThe following are profiles that can be created and used in Windows PowerShell ISE. Each profile is saved to its own specific path.\n\n|Profile Type|Profile Path|\n|----------------|----------------|\n|“Current user, PowerShell ISE”|$profile.CurrentUserCurrentHost, or $profile|\n|“All users, PowerShell ISE”|$profile.AllUsersCurrentHost|\n|“Current user, All hosts”|$profile.CurrentUserAllHosts|\n|“All users, All hosts”|$profile.AllUsersAllHosts|\n\n## To create a new profile\nTo create a new “Current user, Windows PowerShell ISE” profile, run this command:\n\n```\nif (!(test-path $profile )) \n{new-item -type file -path $profile -force}\n```\n\nTo create a new “All users, Windows PowerShell ISE” profile, run this command:\n\n```\nif (!(test-path $profile.AllUsersCurrentHost)) \n{new-item -type file -path $profile.AllUsersCurrentHost -force}\n```\n\nTo create a new “Current user, All Hosts” profile, run this command:\n\n```\nif (!(test-path $profile.CurrentUserAllHosts)) \n{new-item -type file -path $profile.CurrentUserAllHosts -force}\n```\n\nTo create a new “All users, All Hosts” profile, type:\n\n```\nif (!(test-path $profile.AllUsersAllHosts)) \n{new-item -type file -path $profile.AllUsersAllHosts-force}\n```\n\n## To edit a profile\n\n1.  To open the profile, run the command psedit with the variable that specifies the profile you want to edit. For example, to open the “Current user, Windows PowerShell ISE” profile, type: `psEdit $profile`\n\n2.  Add some items to your profile. The following are a few examples to get you started:\n\n    -   To change the default background color of the Console Pane to blue, in the profile file type: `$psISE.Options.OutputPaneBackground = 'blue'` . For more information about the $psISE variable, see [Windows PowerShell ISE Object Model Reference](https://technet.microsoft.com/en-us/library/e1a9e7d1-0fd5-47de-8d9b-f1be1ed13b0c).\n\n    -   To change font size to 20, in the profile file type: `$psISE.Options.FontSize =20`\n\n3.  To save your profile file, on the **File** menu, click **Save**. Next time you open the Windows PowerShell ISE, your customizations are applied.\n\n## See Also\n[about_Profiles [v4]](https://technet.microsoft.com/en-us/library/e1d9e30a-70cc-4f36-949f-fc7cd96b4054)\n[Using the Windows PowerShell ISE](Using-the-Windows-PowerShell-ISE.md)\n\n"}