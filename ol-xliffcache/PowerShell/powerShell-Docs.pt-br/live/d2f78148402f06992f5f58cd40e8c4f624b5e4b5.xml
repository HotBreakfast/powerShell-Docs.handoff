{"nodes":[{"content":"install and use windows powershell web access","pos":[12,57]},{"content":"Install and Use Windows PowerShell Web Access","pos":[206,251]},{"content":"Updated: November 5, 2013","pos":[253,278]},{"content":"Applies To: Windows Server 2012 R2, Windows Server 2012","pos":[280,335]},{"content":"Windows PowerShell® Web Access, first introduced in Windows Server® 2012, acts as a Windows PowerShell gateway, providing a web-based Windows PowerShell console that is targeted at a remote computer.","pos":[337,536]},{"content":"It enables IT Pros to run Windows PowerShell commands and scripts from a Windows PowerShell console in a web browser, with no Windows PowerShell, remote management software, or browser plug-in installation necessary on the client device.","pos":[537,774]},{"content":"All that is required to run the web-based Windows PowerShell console is a properly-configured Windows PowerShell Web Access gateway, and a client device browser that supports JavaScript® and accepts cookies.","pos":[775,982]},{"content":"Examples of client devices include laptops, non-work personal computers, borrowed computers, tablet computers, web kiosks, computers that are not running a Windows-based operating system, and cell phone browsers.","pos":[984,1196]},{"content":"IT Pros can perform critical management tasks on remote Windows-based servers from devices that have access to an Internet connection and a web browser.","pos":[1197,1349]},{"content":"After successful gateway setup and configuration, users can access a Windows PowerShell console by using a web browser.","pos":[1351,1470]},{"content":"When users open the secured Windows PowerShell Web Access website, they can run a web-based Windows PowerShell console after successful authentication.","pos":[1471,1622]},{"content":"Windows PowerShell Web Access setup and configuration is a three-step process:","pos":[1624,1702]},{"content":"Installing Windows PowerShell Web Access","pos":[1708,1748]},{"content":"Configuring the gateway","pos":[1754,1777]},{"content":"Configuring authorization rules that allow users access to the web-based Windows PowerShell console","pos":[1783,1882]},{"content":"Before you install and configure Windows PowerShell Web Access, we recommend that you read this entire guide, which includes instructions about how to install, secure, and uninstall Windows PowerShell Web Access.","pos":[1884,2096]},{"content":"The <bpt id=\"p1\">[</bpt>Use the Web-based Windows PowerShell Console<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/hh831417(v=ws.11).aspx)</ept> topic describes how users sign in to the web-based console, and covers limitations and differences between the web-based Windows PowerShell console and the <bpt id=\"p2\">**</bpt>powershell.exe<ept id=\"p2\">**</ept> console.","pos":[2097,2399]},{"content":"End users of the web-based console should read <bpt id=\"p1\">[</bpt>Use the Web-based Windows PowerShell Console<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/hh831417(v=ws.11).aspx)</ept>, but do not need to read the rest of this guide.","pos":[2400,2610]},{"content":"This topic does not provide in-depth Web Server (IIS) operations guidance; only those steps required to configure the Windows PowerShell Web Access gateway are described in this topic.","pos":[2612,2796]},{"content":"For more information about configuring and securing websites in IIS, see the IIS documentation resources in the See Also section.","pos":[2797,2926]},{"content":"The following diagram shows how Windows PowerShell Web Access works.","pos":[2928,2996]},{"content":"In this topic:","pos":[3212,3226]},{"content":"Requirements for running Windows PowerShell Web Access","pos":[3233,3287]},{"content":"Browser and client device support","pos":[3307,3340]},{"content":"Recommended (quick) deployment","pos":[3363,3393]},{"content":"Custom deployment","pos":[3413,3430]},{"content":"Configure a genuine certificate","pos":[3452,3483]},{"pos":[3732,3786],"content":"Requirements for running Windows PowerShell Web Access"},{"content":"Windows PowerShell Web Access requires Web Server (IIS), .NET Framework 4.5, and Windows PowerShell 3.0 or Windows PowerShell 4.0 to be running on the server on which you want to run the gateway.","pos":[4037,4232]},{"content":"You can install Windows PowerShell Web Access on a server that is running Windows Server 2012 R2 or Windows Server 2012 by using either the Add Roles and Features Wizard in Server Manager, or Windows PowerShell deployment cmdlets for Server Manager.","pos":[4233,4482]},{"content":"When you install Windows PowerShell Web Access by using Server Manager or its deployment cmdlets, required roles and features are automatically added as part of the installation process.","pos":[4483,4669]},{"content":"Windows PowerShell Web Access allows remote users to access computers in your organization by using Windows PowerShell in a web browser.","pos":[4671,4807]},{"content":"Although Windows PowerShell Web Access is a convenient and powerful management tool, the web-based access poses security risks, and should be configured as securely as possible.","pos":[4808,4985]},{"content":"We recommend that administrators who configure the Windows PowerShell Web Access gateway use available security layers, both the cmdlet-based authorization rules included with Windows PowerShell Web Access, and security layers that are available in Web Server (IIS) and third-party applications.","pos":[4986,5281]},{"content":"This documentation includes both unsecure examples that are only recommended for test environments, as well as examples that are recommended for secure deployments.","pos":[5282,5446]},{"pos":[5679,5712],"content":"Browser and client device support"},{"content":"Windows PowerShell Web Access supports the following Internet browsers.","pos":[5963,6034]},{"content":"Although mobile browsers are not officially supported, many may be able to run the web-based Windows PowerShell console.","pos":[6035,6155]},{"content":"Other browsers that accept cookies, run JavaScript, and run HTTPS websites are expected to work, but are not officially tested.","pos":[6156,6283]},{"pos":[6486,6521],"content":"Supported desktop computer browsers"},{"content":"Windows® Internet Explorer® for Microsoft Windows® 8.0, 9.0, 10.0, and 11.0","pos":[6612,6687]},{"content":"Mozilla Firefox® 10.0.2","pos":[6693,6716]},{"content":"Google Chrome™ 17.0.963.56m for Windows","pos":[6722,6761]},{"content":"Apple Safari® 5.1.2 for Windows","pos":[6767,6798]},{"content":"Apple Safari 5.1.2 for Mac OS®","pos":[6804,6834]},{"pos":[7037,7080],"content":"Minimally-tested mobile devices or browsers"},{"content":"Windows Phone 7 and 7.5","pos":[7171,7194]},{"content":"Google Android WebKit 3.1 Browser Android 2.2.1 (Kernel 2.6)","pos":[7200,7260]},{"content":"Apple Safari for iPhone operating system 5.0.1","pos":[7266,7312]},{"content":"Apple Safari for iPad 2 operating system 5.0.1","pos":[7318,7364]},{"pos":[7567,7587],"content":"Browser requirements"},{"content":"To use the Windows PowerShell Web Access web-based console, browsers must do the following.","pos":[7674,7765]},{"content":"Allow cookies from the Windows PowerShell Web Access gateway website.","pos":[7771,7840]},{"content":"Be able to open and read HTTPS pages.","pos":[7846,7883]},{"content":"Open and run websites that use JavaScript.","pos":[7889,7931]},{"pos":[8161,8191],"content":"Recommended (quick) deployment"},{"content":"You can install the Windows PowerShell Web Access gateway on a server that is running Windows Server 2012 R2 or Windows Server 2012 by using either Windows PowerShell cmdlets, or by using the Add Roles and Features Wizard that is opened from within Server Manager.","pos":[8442,8706]},{"content":"For quick installation and configuration, use Windows PowerShell cmdlets, as described in this section.","pos":[8707,8810]},{"content":"Step 1: Install Windows PowerShell Web Access","pos":[8817,8862]},{"content":"Step 2: Configure the gateway","pos":[8883,8912]},{"content":"Step 3: Configure a restrictive authorization rule","pos":[8933,8983]},{"pos":[9232,9277],"content":"Step 1: Install Windows PowerShell Web Access"},{"content":"To install Windows PowerShell Web Access by using Windows PowerShell cmdlets","pos":[9369,9445]},{"content":"Do one of the following to open a Windows PowerShell session with elevated user rights.","pos":[9451,9538]},{"pos":[9548,9663],"content":"On the Windows desktop, right-click <bpt id=\"p1\">**</bpt>Windows PowerShell<ept id=\"p1\">**</ept> on the taskbar, and then click <bpt id=\"p2\">**</bpt>Run as Administrator<ept id=\"p2\">**</ept>."},{"pos":[9673,9782],"content":"On the Windows <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> screen, right-click <bpt id=\"p2\">**</bpt>Windows PowerShell<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Run as Administrator<ept id=\"p3\">**</ept>."},{"pos":[9788,10583],"content":"<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th><span><img src=\"https://i-technet.sec.s-msft.com/dynimg/IC101471.jpeg\" title=\"System_CAPS_note\" alt=\"System_CAPS_note\" id=\"s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note\" /></span><span class=\"alertTitle\">Note </span></th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td><p>In Windows PowerShell 3.0 and 4.0, there is no need to import the Server Manager cmdlet module into the Windows PowerShell session before running cmdlets that are part of the module. A module is automatically imported the first time you run a cmdlet that is part of the module. Also, Windows PowerShell cmdlets are not case-sensitive.</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"Note","pos":[307,311]},{"content":"In Windows PowerShell 3.0 and 4.0, there is no need to import the Server Manager cmdlet module into the Windows PowerShell session before running cmdlets that are part of the module. A module is automatically imported the first time you run a cmdlet that is part of the module. Also, Windows PowerShell cmdlets are not case-sensitive.","pos":[372,706],"nodes":[{"content":"In Windows PowerShell 3.0 and 4.0, there is no need to import the Server Manager cmdlet module into the Windows PowerShell session before running cmdlets that are part of the module.","pos":[0,182]},{"content":"A module is automatically imported the first time you run a cmdlet that is part of the module.","pos":[183,277]},{"content":"Also, Windows PowerShell cmdlets are not case-sensitive.","pos":[278,334]}]}]},{"content":"Type the following, and then press <bpt id=\"p1\">**</bpt>Enter<ept id=\"p1\">**</ept>, where <bpt id=\"p2\">*</bpt>computer\\_name<ept id=\"p2\">*</ept> represents a remote computer on which you want to install Windows PowerShell Web Access, if applicable.","pos":[10589,10761]},{"content":"The <ph id=\"ph1\">&lt;span class=\"code\"&gt;</ph>Restart<ph id=\"ph2\">&lt;/span&gt;</ph> parameter automatically restarts destination servers if required.","pos":[10762,10865]},{"content":"[Copy](javascript:if%20(window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_374a9c21-4f6e-471e-b957-bb190a594533'); \"Copy to clipboard.\")","pos":[10871,11037]},{"pos":[11171,12415],"content":"<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th><span><img src=\"https://i-technet.sec.s-msft.com/dynimg/IC101471.jpeg\" title=\"System_CAPS_note\" alt=\"System_CAPS_note\" id=\"s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note\" /></span><span class=\"alertTitle\">Note </span></th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td><p>Installing Windows PowerShell Web Access by using Windows PowerShell cmdlets does not add Web Server (IIS) management tools by default. If you want to install the management tools on the same server as the Windows PowerShell Web Access gateway, add the <span class=\"code\">IncludeManagementTools</span> parameter to the installation command (as provided in this step). If you are managing the Windows PowerShell Web Access website from a remote computer, install the IIS Manager snap-in by installing <a href=\"http://go.microsoft.com/fwlink/?LinkID=304145\">Remote Server Administration Tools for Windows 8.1</a> or <a href=\"http://go.microsoft.com/fwlink/p/?LinkID=238560\">Remote Server Administration Tools for Windows 8</a> on the computer from which you want to manage the gateway.</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"Note","pos":[307,311]},{"content":"Installing Windows PowerShell Web Access by using Windows PowerShell cmdlets does not add Web Server (IIS) management tools by default. If you want to install the management tools on the same server as the Windows PowerShell Web Access gateway, add the <span class=\"code\">IncludeManagementTools</span> parameter to the installation command (as provided in this step). If you are managing the Windows PowerShell Web Access website from a remote computer, install the IIS Manager snap-in by installing <a href=\"http://go.microsoft.com/fwlink/?LinkID=304145\">Remote Server Administration Tools for Windows 8.1</a> or <a href=\"http://go.microsoft.com/fwlink/p/?LinkID=238560\">Remote Server Administration Tools for Windows 8</a> on the computer from which you want to manage the gateway.","pos":[372,1155],"nodes":[{"content":"Installing Windows PowerShell Web Access by using Windows PowerShell cmdlets does not add Web Server (IIS) management tools by default.","pos":[0,135]},{"content":"If you want to install the management tools on the same server as the Windows PowerShell Web Access gateway, add the <ph id=\"ph1\">&lt;span class=\"code\"&gt;</ph>IncludeManagementTools<ph id=\"ph2\">&lt;/span&gt;</ph> parameter to the installation command (as provided in this step).","pos":[136,367]},{"content":"If you are managing the Windows PowerShell Web Access website from a remote computer, install the IIS Manager snap-in by installing <ph id=\"ph1\">&lt;a href=\"http://go.microsoft.com/fwlink/?LinkID=304145\"&gt;</ph>Remote Server Administration Tools for Windows 8.1<ph id=\"ph2\">&lt;/a&gt;</ph> or <ph id=\"ph3\">&lt;a href=\"http://go.microsoft.com/fwlink/p/?LinkID=238560\"&gt;</ph>Remote Server Administration Tools for Windows 8<ph id=\"ph4\">&lt;/a&gt;</ph> on the computer from which you want to manage the gateway.","pos":[368,783]}]}]},{"content":"To install roles and features on an offline VHD, you must add both the <ph id=\"ph1\">&lt;span class=\"code\"&gt;</ph>ComputerName<ph id=\"ph2\">&lt;/span&gt;</ph> parameter and the <ph id=\"ph3\">&lt;span class=\"code\"&gt;</ph>VHD<ph id=\"ph4\">&lt;/span&gt;</ph> parameter.","pos":[12421,12589]},{"content":"The <ph id=\"ph1\">&lt;span class=\"code\"&gt;</ph>ComputerName<ph id=\"ph2\">&lt;/span&gt;</ph> parameter contains the name of the server on which to mount the VHD, and the <ph id=\"ph3\">&lt;span class=\"code\"&gt;</ph>VHD<ph id=\"ph4\">&lt;/span&gt;</ph> parameter contains the path to the VHD file on the specified server.","pos":[12590,12808]},{"content":"[Copy](javascript:if%20(window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_d841d509-347e-49d0-bf54-8d1f306bece6'); \"Copy to clipboard.\")","pos":[12814,12980]},{"content":"When installation is complete, verify that Windows PowerShell Web Access was installed on destination servers by running the <bpt id=\"p1\">**</bpt>Get-WindowsFeature<ept id=\"p1\">**</ept> cmdlet on a destination server, in a Windows PowerShell console that has been opened with elevated user rights.","pos":[13126,13385]},{"content":"You can also verify that Windows PowerShell Web Access was installed in the Server Manager console, by selecting a destination server on the <bpt id=\"p1\">**</bpt>All Servers<ept id=\"p1\">**</ept> page, and then viewing the <bpt id=\"p2\">**</bpt>Roles and Features<ept id=\"p2\">**</ept> tile for the selected server.","pos":[13386,13622]},{"content":"You can also view the readme file for Windows PowerShell Web Access.","pos":[13623,13691]},{"content":"After Windows PowerShell Web Access is installed, you are prompted to review the readme file, which contains basic, required setup instructions for the gateway.","pos":[13697,13857]},{"content":"These setup instructions are also in the following section, <bpt id=\"p1\">[</bpt>Step 2: Configure the gateway<ept id=\"p1\">](#BKMK_step2)</ept>.","pos":[13858,13963]},{"content":"The path to the readme file is <ph id=\"ph1\">&lt;span class=\"computerOutputInline\"&gt;</ph>C:\\\\Windows\\\\Web\\\\PowerShellWebAccess\\\\wwwroot\\\\README.txt<ph id=\"ph2\">&lt;/span&gt;</ph>.","pos":[13964,14096]},{"pos":[14331,14360],"content":"Step 2: Configure the gateway"},{"content":"The <bpt id=\"p1\">**</bpt>Install-PswaWebApplication<ept id=\"p1\">**</ept> cmdlet is a quick way to get Windows PowerShell Web Access configured.","pos":[14447,14552]},{"content":"Although you can add the <ph id=\"ph1\">&lt;span class=\"code\"&gt;</ph>UseTestCertificate<ph id=\"ph2\">&lt;/span&gt;</ph> parameter to the <ph id=\"ph3\">&lt;span class=\"code\"&gt;</ph>Install-PswaWebApplication<ph id=\"ph4\">&lt;/span&gt;</ph> cmdlet to install a self-signed SSL certificate for test purposes, this is not secure; for a secure production environment, always use a valid SSL certificate that has been signed by a certification authority (CA).","pos":[14553,14907]},{"content":"Administrators can replace the test certificate with a signed certificate of their choice by using the IIS Manager console.","pos":[14908,15031]},{"content":"You can complete Windows PowerShell Web Access web application configuration either by running the <ph id=\"ph1\">&lt;span class=\"code\"&gt;</ph>Install-PswaWebApplication<ph id=\"ph2\">&lt;/span&gt;</ph> cmdlet or by performing GUI-based configuration steps in IIS Manager.","pos":[15033,15254]},{"content":"By default, the cmdlet installs the web application, <bpt id=\"p1\">**</bpt>pswa<ept id=\"p1\">**</ept> (and an application pool for it, <bpt id=\"p2\">**</bpt>pswa\\_pool<ept id=\"p2\">**</ept>), in the <bpt id=\"p3\">**</bpt>Default Web Site<ept id=\"p3\">**</ept> container, as shown in IIS Manager; if desired, you can instruct the cmdlet to change the default site container of the web application.","pos":[15255,15531]},{"content":"IIS Manager offers configuration options that are available for web applications, such as changing the port number or the Secure Sockets Layer (SSL) certificate.","pos":[15532,15693]},{"content":"Security Note","pos":[16014,16027]},{"content":"We strongly recommend that administrators configure the gateway to use a valid certificate that has been signed by a CA.","pos":[16088,16208]},{"content":"To configure the Windows PowerShell Web Access gateway with a test certificate by using Install-PswaWebApplication","pos":[16248,16362]},{"content":"To configure the Windows PowerShell Web Access gateway with a genuine certificate by using Install-PswaWebApplication and IIS Manager","pos":[16386,16519]},{"content":"To configure the Windows PowerShell Web Access gateway with a test certificate by using Install-PswaWebApplication","pos":[16542,16656]},{"content":"Do one of the following to open a Windows PowerShell session.","pos":[16662,16723]},{"pos":[16733,16807],"content":"On the Windows desktop, right-click <bpt id=\"p1\">**</bpt>Windows PowerShell<ept id=\"p1\">**</ept> on the taskbar."},{"pos":[16817,16879],"content":"On the Windows <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> screen, click <bpt id=\"p2\">**</bpt>Windows PowerShell<ept id=\"p2\">**</ept>."},{"pos":[16885,16930],"content":"Type the following, and then press <bpt id=\"p1\">**</bpt>Enter<ept id=\"p1\">**</ept>."},{"content":"Install-PswaWebApplication -UseTestCertificate","pos":[16938,16984]},{"pos":[16992,17689],"content":"<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th><span><img src=\"https://i-technet.sec.s-msft.com/dynimg/IC17938.jpeg\" title=\"System_CAPS_security\" alt=\"System_CAPS_security\" id=\"s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-security\" /></span><span class=\"alertTitle\"> Security Note </span></th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td><p>The <span class=\"code\">UseTestCertificate</span> parameter should only be used in a private test environment. For a secure production environment, we recommend using a valid certificate that has been signed by a CA.</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"Security Note","pos":[319,332]},{"content":"The <span class=\"code\">UseTestCertificate</span> parameter should only be used in a private test environment. For a secure production environment, we recommend using a valid certificate that has been signed by a CA.","pos":[393,608],"nodes":[{"content":"The <ph id=\"ph1\">&lt;span class=\"code\"&gt;</ph>UseTestCertificate<ph id=\"ph2\">&lt;/span&gt;</ph> parameter should only be used in a private test environment.","pos":[0,109]},{"content":"For a secure production environment, we recommend using a valid certificate that has been signed by a CA.","pos":[110,215]}]}]},{"content":"Running the cmdlet installs the Windows PowerShell Web Access web application within the IIS Default Web Site container.","pos":[17695,17815]},{"content":"The cmdlet creates the infrastructure required to run Windows PowerShell Web Access on the default website, https://<ph id=\"ph1\">&amp;lt;</ph>server\\_name<ph id=\"ph2\">&amp;gt;</ph>/pswa.","pos":[17816,17958]},{"content":"To install the web application in a different website, provide the website name by adding the <ph id=\"ph1\">&lt;span class=\"code\"&gt;</ph>WebSiteName<ph id=\"ph2\">&lt;/span&gt;</ph> parameter.","pos":[17959,18101]},{"content":"To change the name of the web application (the default is <ph id=\"ph1\">&lt;span class=\"code\"&gt;</ph>pswa<ph id=\"ph2\">&lt;/span&gt;</ph>), add the <ph id=\"ph3\">&lt;span class=\"code\"&gt;</ph>WebApplicationName<ph id=\"ph4\">&lt;/span&gt;</ph> parameter.","pos":[18102,18256]},{"content":"The following settings are configured by running the cmdlet.","pos":[18262,18322]},{"content":"You can change these manually in the IIS Manager console, if desired.","pos":[18323,18392]},{"content":"Path: /pswa","pos":[18402,18413]},{"content":"ApplicationPool: pswa\\_pool","pos":[18423,18450]},{"content":"EnabledProtocols: http","pos":[18460,18482]},{"pos":[18492,18548],"content":"PhysicalPath: %<bpt id=\"p1\">*</bpt>windir<ept id=\"p1\">*</ept>%/Web/PowerShellWebAccess/wwwroot"},{"pos":[18574,18684],"content":"Example:<ph id=\"ph1\">&lt;/span&gt;</ph> <ph id=\"ph2\">&lt;span class=\"code\"&gt;</ph>Install-PswaWebApplication –webApplicationName myWebApp –useTestCertificate"},{"pos":[18697,18814],"content":"In this example, the resulting website for Windows PowerShell Web Access is https://<ph id=\"ph1\">&amp;lt;</ph> <bpt id=\"p1\">*</bpt>server\\_name<ept id=\"p1\">*</ept><ph id=\"ph2\">&amp;gt;</ph>/myWebApp."},{"pos":[18820,19646],"content":"<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th><span><img src=\"https://i-technet.sec.s-msft.com/dynimg/IC101471.jpeg\" title=\"System_CAPS_note\" alt=\"System_CAPS_note\" id=\"s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note\" /></span><span class=\"alertTitle\">Note </span></th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td><p>You cannot sign in until users have been granted access to the website by adding authorization rules. For more information, see <a href=\"#BKMK_step3\">Step 3: Configure a restrictive authorization rule</a> and <a href=\"https://technet.microsoft.com/en-us/library/dn282394(v=ws.11).aspx\">Authorization Rules and Security Features of Windows PowerShell Web Access</a>.</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"Note","pos":[307,311]},{"content":"You cannot sign in until users have been granted access to the website by adding authorization rules. For more information, see <a href=\"#BKMK_step3\">Step 3: Configure a restrictive authorization rule</a> and <a href=\"https://technet.microsoft.com/en-us/library/dn282394(v=ws.11).aspx\">Authorization Rules and Security Features of Windows PowerShell Web Access</a>.","pos":[372,737],"nodes":[{"content":"You cannot sign in until users have been granted access to the website by adding authorization rules.","pos":[0,101]},{"content":"For more information, see <ph id=\"ph1\">&lt;a href=\"#BKMK_step3\"&gt;</ph>Step 3: Configure a restrictive authorization rule<ph id=\"ph2\">&lt;/a&gt;</ph> and <ph id=\"ph3\">&lt;a href=\"https://technet.microsoft.com/en-us/library/dn282394(v=ws.11).aspx\"&gt;</ph>Authorization Rules and Security Features of Windows PowerShell Web Access<ph id=\"ph4\">&lt;/a&gt;</ph>.","pos":[102,365]}]}]},{"content":"To configure the Windows PowerShell Web Access gateway with a genuine certificate by using Install-PswaWebApplication and IIS Manager","pos":[19653,19786]},{"content":"Do one of the following to open a Windows PowerShell session.","pos":[19792,19853]},{"pos":[19863,19937],"content":"On the Windows desktop, right-click <bpt id=\"p1\">**</bpt>Windows PowerShell<ept id=\"p1\">**</ept> on the taskbar."},{"pos":[19947,20009],"content":"On the Windows <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> screen, click <bpt id=\"p2\">**</bpt>Windows PowerShell<ept id=\"p2\">**</ept>."},{"pos":[20015,20060],"content":"Type the following, and then press <bpt id=\"p1\">**</bpt>Enter<ept id=\"p1\">**</ept>."},{"content":"Install-PswaWebApplication","pos":[20068,20094]},{"content":"The following gateway settings are configured by running the cmdlet.","pos":[20102,20170]},{"content":"You can change these manually in the IIS Manager console, if desired.","pos":[20171,20240]},{"content":"You can also specify values for the <ph id=\"ph1\">&lt;span class=\"code\"&gt;</ph>WebsiteName<ph id=\"ph2\">&lt;/span&gt;</ph> and <ph id=\"ph3\">&lt;span class=\"code\"&gt;</ph>WebApplicationName<ph id=\"ph4\">&lt;/span&gt;</ph> parameters of the <ph id=\"ph5\">&lt;span class=\"code\"&gt;</ph>Install-PswaWebApplication<ph id=\"ph6\">&lt;/span&gt;</ph> cmdlet.","pos":[20241,20442]},{"content":"Path: /pswa","pos":[20452,20463]},{"content":"ApplicationPool: pswa\\_pool","pos":[20473,20500]},{"content":"EnabledProtocols: http","pos":[20510,20532]},{"pos":[20542,20598],"content":"PhysicalPath: %<bpt id=\"p1\">*</bpt>windir<ept id=\"p1\">*</ept>%/Web/PowerShellWebAccess/wwwroot"},{"content":"Open the IIS Manager console by doing one of the following.","pos":[20604,20663]},{"content":"On the Windows desktop, start Server Manager by clicking <bpt id=\"p1\">**</bpt>Server Manager<ept id=\"p1\">**</ept> in the Windows taskbar.","pos":[20673,20772]},{"content":"On the <bpt id=\"p1\">**</bpt>Tools<ept id=\"p1\">**</ept> menu in Server Manager, click <bpt id=\"p2\">**</bpt>Internet Information Services (IIS) Manager<ept id=\"p2\">**</ept>.","pos":[20773,20868]},{"pos":[20878,20936],"content":"On the Windows <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> screen, click <bpt id=\"p2\">**</bpt>Server Manager<ept id=\"p2\">**</ept>."},{"content":"In the IIS Manager tree pane, expand the node for the server on which Windows PowerShell Web Access is installed until the <bpt id=\"p1\">**</bpt>Sites<ept id=\"p1\">**</ept> folder is visible.","pos":[20942,21093]},{"content":"Expand the <bpt id=\"p1\">**</bpt>Sites<ept id=\"p1\">**</ept> folder.","pos":[21094,21122]},{"content":"Select the website in which you have installed the Windows PowerShell Web Access web application.","pos":[21128,21225]},{"content":"In the <bpt id=\"p1\">**</bpt>Actions<ept id=\"p1\">**</ept> pane, click <bpt id=\"p2\">**</bpt>Bindings<ept id=\"p2\">**</ept>.","pos":[21226,21270]},{"pos":[21276,21326],"content":"In the <bpt id=\"p1\">**</bpt>Site Binding<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept>."},{"pos":[21332,21412],"content":"In the <bpt id=\"p1\">**</bpt>Add Site Binding<ept id=\"p1\">**</ept> dialog box, in the <bpt id=\"p2\">**</bpt>Type<ept id=\"p2\">**</ept> field, select <bpt id=\"p3\">**</bpt>https<ept id=\"p3\">**</ept>."},{"content":"In the <bpt id=\"p1\">**</bpt>SSL certificate<ept id=\"p1\">**</ept> field, select your signed certificate from the drop-down menu.","pos":[21418,21507]},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[21508,21521]},{"content":"See <bpt id=\"p1\">[</bpt>To configure an SSL certificate in IIS Manager<ept id=\"p1\">](#BKMK_cert)</ept> in this topic for more information about how to obtain a certificate.","pos":[21522,21656]},{"content":"The Windows PowerShell Web Access web application is now configured to use your signed SSL certificate.","pos":[21662,21765]},{"content":"You can access Windows PowerShell Web Access by opening https://<ph id=\"ph1\">&amp;lt;</ph>server\\_name<ph id=\"ph2\">&amp;gt;</ph>/pswa in a browser window.","pos":[21766,21876]},{"pos":[21882,22708],"content":"<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th><span><img src=\"https://i-technet.sec.s-msft.com/dynimg/IC101471.jpeg\" title=\"System_CAPS_note\" alt=\"System_CAPS_note\" id=\"s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note\" /></span><span class=\"alertTitle\">Note </span></th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td><p>You cannot sign in until users have been granted access to the website by adding authorization rules. For more information, see <a href=\"#BKMK_step3\">Step 3: Configure a restrictive authorization rule</a> and <a href=\"https://technet.microsoft.com/en-us/library/dn282394(v=ws.11).aspx\">Authorization Rules and Security Features of Windows PowerShell Web Access</a>.</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"Note","pos":[307,311]},{"content":"You cannot sign in until users have been granted access to the website by adding authorization rules. For more information, see <a href=\"#BKMK_step3\">Step 3: Configure a restrictive authorization rule</a> and <a href=\"https://technet.microsoft.com/en-us/library/dn282394(v=ws.11).aspx\">Authorization Rules and Security Features of Windows PowerShell Web Access</a>.","pos":[372,737],"nodes":[{"content":"You cannot sign in until users have been granted access to the website by adding authorization rules.","pos":[0,101]},{"content":"For more information, see <ph id=\"ph1\">&lt;a href=\"#BKMK_step3\"&gt;</ph>Step 3: Configure a restrictive authorization rule<ph id=\"ph2\">&lt;/a&gt;</ph> and <ph id=\"ph3\">&lt;a href=\"https://technet.microsoft.com/en-us/library/dn282394(v=ws.11).aspx\"&gt;</ph>Authorization Rules and Security Features of Windows PowerShell Web Access<ph id=\"ph4\">&lt;/a&gt;</ph>.","pos":[102,365]}]}]},{"pos":[22943,22993],"content":"Step 3: Configure a restrictive authorization rule"},{"content":"After Windows PowerShell Web Access is installed and the gateway is configured, users can open the sign-in page in a browser, but they cannot sign in until the Windows PowerShell Web Access administrator grants users access explicitly.","pos":[23080,23315]},{"content":"Windows PowerShell Web Access access control is managed by using the set of Windows PowerShell cmdlets described in the following table.","pos":[23316,23452]},{"content":"There is no comparable GUI for adding or managing authorization rules.","pos":[23453,23523]},{"content":"For more detailed information about Windows PowerShell Web Access cmdlets, see the cmdlet reference topics, <bpt id=\"p1\">[</bpt>Windows PowerShell Web Access Cmdlets<ept id=\"p1\">](https://technet.microsoft.com/library/hh918342.aspx)</ept>.","pos":[23524,23725]},{"pos":[23727,23962],"content":"For more detail about Windows PowerShell Web Access authorization rules and security, see <bpt id=\"p1\">[</bpt>Authorization Rules and Security Features of Windows PowerShell Web Access<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dn282394(v=ws.11).aspx)</ept>."},{"content":"To add a restrictive authorization rule","pos":[23969,24008]},{"content":"Do one of the following to open a Windows PowerShell session with elevated user rights.","pos":[24014,24101]},{"pos":[24111,24226],"content":"On the Windows desktop, right-click <bpt id=\"p1\">**</bpt>Windows PowerShell<ept id=\"p1\">**</ept> on the taskbar, and then click <bpt id=\"p2\">**</bpt>Run as Administrator<ept id=\"p2\">**</ept>."},{"pos":[24236,24345],"content":"On the Windows <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> screen, right-click <bpt id=\"p2\">**</bpt>Windows PowerShell<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Run as Administrator<ept id=\"p3\">**</ept>."},{"content":"Optional step for restricting user access by using session configurations:<ph id=\"ph1\">&lt;/span&gt;</ph> Verify that session configurations that you want to use in your rules already exist.","pos":[24371,24537]},{"content":"If they have not yet been created, use instructions for creating session configurations in <bpt id=\"p1\">[</bpt>about\\_Session\\_Configuration\\_Files<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/hh847838.aspx)</ept> on MSDN.","pos":[24538,24742]},{"pos":[24748,24793],"content":"Type the following, and then press <bpt id=\"p1\">**</bpt>Enter<ept id=\"p1\">**</ept>."},{"content":"[Copy](javascript:if%20(window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_f9e7959b-75d0-4d63-8f8e-02334a8dd09d'); \"Copy to clipboard.\")","pos":[24799,24965]},{"content":"This authorization rule allows a specific user access to one computer on the network to which they typically have access, with access to a specific session configuration that is scoped to the user’s typical scripting and cmdlet needs.","pos":[25124,25358]},{"content":"In the following example, a user named <ph id=\"ph1\">&lt;span class=\"code\"&gt;</ph>JSmith<ph id=\"ph2\">&lt;/span&gt;</ph> in the <ph id=\"ph3\">&lt;span class=\"code\"&gt;</ph>Contoso<ph id=\"ph4\">&lt;/span&gt;</ph> domain is granted access to manage the computer <ph id=\"ph5\">&lt;span class=\"code\"&gt;</ph>Contoso\\_214<ph id=\"ph6\">&lt;/span&gt;</ph>, and use a session configuration named <ph id=\"ph7\">&lt;span class=\"code\"&gt;</ph>NewAdminsOnly<ph id=\"ph8\">&lt;/span&gt;</ph>.","pos":[25359,25638]},{"content":"[Copy](javascript:if%20(window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_ebd5bc5e-ec5d-4955-a86a-63843e480e37'); \"Copy to clipboard.\")","pos":[25644,25810]},{"content":"Verify that the rule has been created by running either the <bpt id=\"p1\">**</bpt>Get-PswaAuthorizationRule<ept id=\"p1\">**</ept> cmdlet, or <bpt id=\"p2\">**</bpt>Test-PswaAuthorizationRule -UserName <ph id=\"ph1\">&amp;lt;</ph>domain\\\\user | computer\\\\user<ph id=\"ph2\">&amp;gt;</ph> -ComputerName<ept id=\"p2\">**</ept> <ph id=\"ph3\">&amp;lt;</ph>computer\\_name<ph id=\"ph4\">&amp;gt;</ph>.","pos":[25935,26152]},{"content":"For example, <bpt id=\"p1\">**</bpt>Test-PswaAuthorizationRule –UserName Contoso\\\\JSmith –ComputerName Contoso\\_214<ept id=\"p1\">**</ept>.","pos":[26153,26250]},{"content":"After you have configured an authorization rule, you are ready for authorized users to sign in to the web-based console and begin using Windows PowerShell Web Access.","pos":[26252,26418]},{"pos":[26650,26667],"content":"Custom deployment"},{"content":"You can install the Windows PowerShell Web Access gateway on a server that is running Windows Server 2012 R2 or Windows Server 2012 by using the Add Roles and Features Wizard in Server Manager.","pos":[26918,27111]},{"content":"After Windows PowerShell Web Access is installed, you can customize the configuration of the gateway in IIS Manager.","pos":[27112,27228]},{"pos":[27465,27510],"content":"Step 1: Install Windows PowerShell Web Access"},{"content":"To install Windows PowerShell Web Access by using the Add Roles and Features Wizard","pos":[27602,27685]},{"content":"If Server Manager is already open, go on to the next step.","pos":[27691,27749]},{"content":"If Server Manager is not already open, open it by doing one of the following.","pos":[27750,27827]},{"pos":[27837,27936],"content":"On the Windows desktop, start Server Manager by clicking <bpt id=\"p1\">**</bpt>Server Manager<ept id=\"p1\">**</ept> in the Windows taskbar."},{"pos":[27946,28004],"content":"On the Windows <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> screen, click <bpt id=\"p2\">**</bpt>Server Manager<ept id=\"p2\">**</ept>."},{"pos":[28010,28067],"content":"On the <bpt id=\"p1\">**</bpt>Manage<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Add Roles and Features<ept id=\"p2\">**</ept>."},{"content":"On the <bpt id=\"p1\">**</bpt>Select installation type<ept id=\"p1\">**</ept> page, select <bpt id=\"p2\">**</bpt>Role-based or feature-based installation<ept id=\"p2\">**</ept>.","pos":[28073,28167]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[28168,28183]},{"content":"On the <bpt id=\"p1\">**</bpt>Select destination server<ept id=\"p1\">**</ept> page, select a server from the server pool, or select an offline VHD.","pos":[28189,28295]},{"content":"To select an offline VHD as your destination server, first select the server on which to mount the VHD, and then select the VHD file.","pos":[28296,28429]},{"content":"For information about how to add servers to your server pool, see the Server Manager Help.","pos":[28430,28520]},{"content":"After you have selected the destination server, click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[28521,28584]},{"pos":[28590,28718],"content":"On the <bpt id=\"p1\">**</bpt>Select features<ept id=\"p1\">**</ept> page of the wizard, expand <bpt id=\"p2\">**</bpt>Windows PowerShell<ept id=\"p2\">**</ept>, and then select <bpt id=\"p3\">**</bpt>Windows PowerShell Web Access<ept id=\"p3\">**</ept>."},{"content":"Note that you are prompted to add required features, such as .NET Framework 4.5, and role services of Web Server (IIS).","pos":[28724,28843]},{"content":"Add required features and continue.","pos":[28844,28879]},{"pos":[28885,29771],"content":"<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th><span><img src=\"https://i-technet.sec.s-msft.com/dynimg/IC101471.jpeg\" title=\"System_CAPS_note\" alt=\"System_CAPS_note\" id=\"s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note\" /></span><span class=\"alertTitle\">Note </span></th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td><p>Installing Windows PowerShell Web Access by using the Add Roles and Features Wizard also installs Web Server (IIS), including the IIS Manager snap-in. The snap-in and other IIS management tools are installed by default if you use Add Roles and Features Wizard. If you install Windows PowerShell Web Access by using Windows PowerShell cmdlets as described in the following procedure, management tools are not added by default.</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"Note","pos":[307,311]},{"content":"Installing Windows PowerShell Web Access by using the Add Roles and Features Wizard also installs Web Server (IIS), including the IIS Manager snap-in. The snap-in and other IIS management tools are installed by default if you use Add Roles and Features Wizard. If you install Windows PowerShell Web Access by using Windows PowerShell cmdlets as described in the following procedure, management tools are not added by default.","pos":[372,797],"nodes":[{"content":"Installing Windows PowerShell Web Access by using the Add Roles and Features Wizard also installs Web Server (IIS), including the IIS Manager snap-in.","pos":[0,150]},{"content":"The snap-in and other IIS management tools are installed by default if you use Add Roles and Features Wizard.","pos":[151,260]},{"content":"If you install Windows PowerShell Web Access by using Windows PowerShell cmdlets as described in the following procedure, management tools are not added by default.","pos":[261,425]}]}]},{"content":"On the <bpt id=\"p1\">**</bpt>Confirm installation selections<ept id=\"p1\">**</ept> page, if the feature files for Windows PowerShell Web Access are not stored on the destination server that you selected in step 4, click <bpt id=\"p2\">**</bpt>Specify an alternate source path<ept id=\"p2\">**</ept>, and provide the path to the feature files.","pos":[29777,30037]},{"content":"Otherwise, click <bpt id=\"p1\">**</bpt>Install<ept id=\"p1\">**</ept>.","pos":[30038,30067]},{"content":"After you click <bpt id=\"p1\">**</bpt>Install<ept id=\"p1\">**</ept>, the <bpt id=\"p2\">**</bpt>Installation progress<ept id=\"p2\">**</ept> page displays installation progress, results, and messages such as warnings, failures, or post-installation configuration steps that are required for Windows PowerShell Web Access.","pos":[30073,30312]},{"content":"After Windows PowerShell Web Access is installed, you are prompted to review the readme file, which contains basic, required setup instructions for the gateway.","pos":[30313,30473]},{"content":"These instructions are also included in this topic.","pos":[30474,30525]},{"content":"The path to the readme file is <ph id=\"ph1\">&lt;span class=\"computerOutputInline\"&gt;</ph>C:\\\\Windows\\\\Web\\\\PowerShellWebAccess\\\\wwwroot\\\\README.txt<ph id=\"ph2\">&lt;/span&gt;</ph>.","pos":[30526,30658]},{"pos":[30861,30890],"content":"Step 2: Configure the gateway"},{"content":"Instructions in this section are for installing the Windows PowerShell Web Access web application in a subdirectory—and not in the root directory—of your website.","pos":[30977,31139]},{"content":"This procedure is the GUI-based equivalent of the actions performed by the <ph id=\"ph1\">&lt;span class=\"code\"&gt;</ph>Install-PswaWebApplication<ph id=\"ph2\">&lt;/span&gt;</ph> cmdlet.","pos":[31140,31275]},{"content":"This section also includes instructions for how to use IIS Manager to configure the Windows PowerShell Web Access gateway as a root website.","pos":[31276,31416]},{"content":"To use IIS Manager to configure the gateway in an existing website","pos":[31423,31489]},{"content":"To use IIS Manager to configure the gateway as a root website with a test certificate","pos":[31514,31599]},{"content":"To use IIS Manager to configure the gateway in an existing website","pos":[31631,31697]},{"content":"Open the IIS Manager console by doing one of the following.","pos":[31703,31762]},{"content":"On the Windows desktop, start Server Manager by clicking <bpt id=\"p1\">**</bpt>Server Manager<ept id=\"p1\">**</ept> in the Windows taskbar.","pos":[31772,31871]},{"content":"On the <bpt id=\"p1\">**</bpt>Tools<ept id=\"p1\">**</ept> menu in Server Manager, click <bpt id=\"p2\">**</bpt>Internet Information Services (IIS) Manager<ept id=\"p2\">**</ept>.","pos":[31872,31967]},{"content":"On the Windows <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> screen, type any part of the name <bpt id=\"p2\">**</bpt>Internet Information Services (IIS) Manager<ept id=\"p2\">**</ept>.","pos":[31977,32084]},{"content":"Click the shortcut when it is displayed in the <bpt id=\"p1\">**</bpt>Apps<ept id=\"p1\">**</ept> results.","pos":[32085,32149]},{"content":"Create a new application pool for Windows PowerShell Web Access.","pos":[32155,32219]},{"content":"Expand the node of the gateway server in the IIS Manager tree pane, select <bpt id=\"p1\">**</bpt>Application Pools<ept id=\"p1\">**</ept>, and click <bpt id=\"p2\">**</bpt>Add Application Pool<ept id=\"p2\">**</ept> in the <bpt id=\"p3\">**</bpt>Actions<ept id=\"p3\">**</ept> pane.","pos":[32220,32377]},{"content":"Add a new application pool with the name <bpt id=\"p1\">**</bpt>pswa\\_pool<ept id=\"p1\">**</ept>, or provide another name.","pos":[32383,32464]},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[32465,32478]},{"content":"In the IIS Manager tree pane, expand the node for the server on which Windows PowerShell Web Access is installed until the <bpt id=\"p1\">**</bpt>Sites<ept id=\"p1\">**</ept> folder is visible.","pos":[32484,32635]},{"content":"Select the <bpt id=\"p1\">**</bpt>Sites<ept id=\"p1\">**</ept> folder.","pos":[32636,32664]},{"pos":[32670,32839],"content":"Right-click the website (for example, <bpt id=\"p1\">**</bpt>Default Web Site<ept id=\"p1\">**</ept>) to which you would like to add the Windows PowerShell Web Access website, and then click <bpt id=\"p2\">**</bpt>Add Application<ept id=\"p2\">**</ept>."},{"content":"In the <bpt id=\"p1\">**</bpt>Alias<ept id=\"p1\">**</ept> field, type pswa, or provide another alias.","pos":[32845,32905]},{"content":"The alias becomes the virtual directory name.","pos":[32906,32951]},{"content":"For example, <bpt id=\"p1\">**</bpt>pswa<ept id=\"p1\">**</ept> in the following URL represents the alias specified in this step: https://<ph id=\"ph1\">&amp;lt;</ph>server\\_name<ph id=\"ph2\">&amp;gt;</ph>/pswa.","pos":[32952,33074]},{"pos":[33080,33170],"content":"In the <bpt id=\"p1\">**</bpt>Application pool<ept id=\"p1\">**</ept> field, select the application pool that you created in step 3."},{"content":"In the <bpt id=\"p1\">**</bpt>Physical path<ept id=\"p1\">**</ept> field, browse for the location of the application.","pos":[33176,33251]},{"content":"You can use the default location, %windir%/Web/PowerShellWebAccess/wwwroot.","pos":[33252,33327]},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[33328,33341]},{"pos":[33347,33456],"content":"Follow the steps in the procedure <bpt id=\"p1\">[</bpt>To configure an SSL certificate in IIS Manager<ept id=\"p1\">](#BKMK_cert)</ept> in this topic."},{"content":"Optional security step:<ph id=\"ph1\">&lt;/span&gt;</ph> With the website selected in the tree pane, double-click <bpt id=\"p1\">**</bpt>SSL Settings<ept id=\"p1\">**</ept> in the content pane.","pos":[33482,33607]},{"content":"Select <bpt id=\"p1\">**</bpt>Require SSL<ept id=\"p1\">**</ept>, and then in the <bpt id=\"p2\">**</bpt>Actions<ept id=\"p2\">**</ept> pane, click <bpt id=\"p3\">**</bpt>Apply<ept id=\"p3\">**</ept>.","pos":[33608,33682]},{"content":"Optionally, in the <bpt id=\"p1\">**</bpt>SSL Settings<ept id=\"p1\">**</ept> pane, you can require that users connecting to the Windows PowerShell Web Access website have client certificates.","pos":[33683,33833]},{"content":"Client certificates help to verify the identity of a client device user.","pos":[33834,33906]},{"content":"For more information about how requiring client certificates can increase the security of Windows PowerShell Web Access, see <bpt id=\"p1\">[</bpt>Authorization Rules and Security Features of Windows PowerShell Web Access<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dn282394(v=ws.11).aspx)</ept> in this guide.","pos":[33907,34191]},{"content":"Open a browser session on a client device.","pos":[34197,34239]},{"content":"For more information about supported browsers and devices, see <bpt id=\"p1\">[</bpt>Browser and client device support<ept id=\"p1\">](#BKMK_browser)</ept> in this topic.","pos":[34240,34368]},{"pos":[34374,34472],"content":"Open the new Windows PowerShell Web Access website, https://<ph id=\"ph1\">&amp;lt;</ph> <bpt id=\"p1\">*</bpt>gateway\\_server\\_name<ept id=\"p1\">*</ept><ph id=\"ph2\">&amp;gt;</ph>/pswa."},{"content":"The browser should display the Windows PowerShell Web Access console sign-in page.","pos":[34478,34560]},{"pos":[34566,35128],"content":"<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th><span><img src=\"https://i-technet.sec.s-msft.com/dynimg/IC101471.jpeg\" title=\"System_CAPS_note\" alt=\"System_CAPS_note\" id=\"s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note\" /></span><span class=\"alertTitle\">Note </span></th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td><p>You cannot sign in until users have been granted access to the website by adding authorization rules.</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"Note","pos":[307,311]},{"content":"You cannot sign in until users have been granted access to the website by adding authorization rules.","pos":[372,473]}]},{"pos":[35134,35439],"content":"In a Windows PowerShell session that has been opened with elevated user rights (Run as Administrator), run the following script, in which <bpt id=\"p1\">*</bpt>application\\_pool\\_name<ept id=\"p1\">*</ept> represents the name of the application pool that you created in step 3, to give the application pool access rights to the authorization file."},{"content":"[Copy](javascript:if%20(window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_c1a80a93-8fcf-4beb-a025-5f81bfb8bdae'); \"Copy to clipboard.\")","pos":[35445,35611]},{"content":"To view existing access rights on the authorization file, run the following command:","pos":[35893,35977]},{"content":"[Copy](javascript:if%20(window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_ac2179c2-9548-4a17-8663-267fdd105380'); \"Copy to clipboard.\")","pos":[35983,36149]},{"content":"To use IIS Manager to configure the gateway as a root website with a test certificate","pos":[36215,36300]},{"content":"Open the IIS Manager console by doing one of the following.","pos":[36306,36365]},{"content":"On the Windows desktop, start Server Manager by clicking <bpt id=\"p1\">**</bpt>Server Manager<ept id=\"p1\">**</ept> in the Windows taskbar.","pos":[36375,36474]},{"content":"On the <bpt id=\"p1\">**</bpt>Tools<ept id=\"p1\">**</ept> menu in Server Manager, click <bpt id=\"p2\">**</bpt>Internet Information Services (IIS) Manager<ept id=\"p2\">**</ept>.","pos":[36475,36570]},{"content":"On the Windows <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> screen, type any part of the name <bpt id=\"p2\">**</bpt>Internet Information Services (IIS) Manager<ept id=\"p2\">**</ept>.","pos":[36580,36687]},{"content":"Click the shortcut when it is displayed in the <bpt id=\"p1\">**</bpt>Apps<ept id=\"p1\">**</ept> results.","pos":[36688,36752]},{"content":"In the IIS Manager tree pane, expand the node for the server on which Windows PowerShell Web Access is installed until the <bpt id=\"p1\">**</bpt>Sites<ept id=\"p1\">**</ept> folder is visible.","pos":[36758,36909]},{"content":"Select the <bpt id=\"p1\">**</bpt>Sites<ept id=\"p1\">**</ept> folder.","pos":[36910,36938]},{"pos":[36944,36991],"content":"In the <bpt id=\"p1\">**</bpt>Actions<ept id=\"p1\">**</ept> pane, click <bpt id=\"p2\">**</bpt>Add Website<ept id=\"p2\">**</ept>."},{"pos":[36997,37068],"content":"Type a name for the website, such as <bpt id=\"p1\">**</bpt>Windows PowerShell Web Access<ept id=\"p1\">**</ept>."},{"content":"An application pool is automatically created for the new website.","pos":[37074,37139]},{"content":"To use a different application pool, click <bpt id=\"p1\">**</bpt>Select<ept id=\"p1\">**</ept> to select an application pool to associate with the new website.","pos":[37140,37258]},{"content":"Select the alternate application pool in the <bpt id=\"p1\">**</bpt>Select Application Pool<ept id=\"p1\">**</ept> dialog box, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[37259,37366]},{"pos":[37372,37462],"content":"In the <bpt id=\"p1\">**</bpt>Physical path<ept id=\"p1\">**</ept> text box, navigate to %<bpt id=\"p2\">*</bpt>windir<ept id=\"p2\">*</ept>%/Web/PowerShellWebAccess/wwwroot."},{"pos":[37468,37532],"content":"In the <bpt id=\"p1\">**</bpt>Type<ept id=\"p1\">**</ept> field of the <bpt id=\"p2\">**</bpt>Binding<ept id=\"p2\">**</ept> area, select <bpt id=\"p3\">**</bpt>https<ept id=\"p3\">**</ept>."},{"content":"Assign a port number to the website that is not already in use by another site or application.","pos":[37538,37632]},{"content":"To locate open ports, you can run the <bpt id=\"p1\">**</bpt>netstat<ept id=\"p1\">**</ept> command in a Command Prompt window.","pos":[37633,37718]},{"content":"The default port number is 443.","pos":[37719,37750]},{"content":"Change the default port if another website is already using 443, or if you have other security reasons for changing the port number.","pos":[37756,37888]},{"content":"If another website that is running on your gateway server is using your selected port, a warning is displayed when you click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>Add Website<ept id=\"p2\">**</ept> dialog box.","pos":[37889,38055]},{"content":"You must use an unused port to run Windows PowerShell Web Access.","pos":[38056,38121]},{"content":"Optionally, if needed for your organization, specify a host name that makes sense to your organization and users, such as <bpt id=\"p1\">**</bpt>www.contoso.com<ept id=\"p1\">**</ept>.","pos":[38127,38269]},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[38270,38283]},{"content":"For a more secure production environment, we strongly recommend providing a valid certificate that has been signed by a CA.","pos":[38289,38412]},{"content":"You must provide an SSL certificate, because users can only connect to Windows PowerShell Web Access through an HTTPS website.","pos":[38413,38539]},{"content":"See <bpt id=\"p1\">[</bpt>To configure an SSL certificate in IIS Manager<ept id=\"p1\">](#BKMK_cert)</ept> in this topic for more information about how to obtain a certificate.","pos":[38540,38674]},{"pos":[38680,38733],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to close the <bpt id=\"p2\">**</bpt>Add Website<ept id=\"p2\">**</ept> dialog box."},{"pos":[38739,39044],"content":"In a Windows PowerShell session that has been opened with elevated user rights (Run as Administrator), run the following script, in which <bpt id=\"p1\">*</bpt>application\\_pool\\_name<ept id=\"p1\">*</ept> represents the name of the application pool that you created in step 4, to give the application pool access rights to the authorization file."},{"content":"[Copy](javascript:if%20(window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_35ae9944-ca44-4af7-9c96-616083b3e3db'); \"Copy to clipboard.\")","pos":[39050,39216]},{"content":"To view existing access rights on the authorization file, run the following command:","pos":[39498,39582]},{"content":"[Copy](javascript:if%20(window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_0eb6d70a-2807-498b-b088-fa5233ed68d5'); \"Copy to clipboard.\")","pos":[39588,39754]},{"pos":[39819,39940],"content":"With the new website selected in the IIS Manager tree pane, click <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>Actions<ept id=\"p2\">**</ept> pane to start the website."},{"content":"Open a browser session on a client device.","pos":[39946,39988]},{"content":"For more information about supported browsers and devices, see <bpt id=\"p1\">[</bpt>Browser and client device support<ept id=\"p1\">](#BKMK_browser)</ept> in this document.","pos":[39989,40120]},{"content":"Open the new Windows PowerShell Web Access website.","pos":[40126,40177]},{"content":"Because the root website points to the Windows PowerShell Web Access folder, the browser should display the Windows PowerShell Web Access sign-in page when you open https://<ph id=\"ph1\">&amp;lt;</ph> <bpt id=\"p1\">*</bpt>gateway\\_server\\_name<ept id=\"p1\">*</ept><ph id=\"ph2\">&amp;gt;</ph>.","pos":[40183,40389]},{"content":"You should not need to add <bpt id=\"p1\">**</bpt>/pswa<ept id=\"p1\">**</ept> to the URL.","pos":[40390,40438]},{"pos":[40444,41006],"content":"<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th><span><img src=\"https://i-technet.sec.s-msft.com/dynimg/IC101471.jpeg\" title=\"System_CAPS_note\" alt=\"System_CAPS_note\" id=\"s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note\" /></span><span class=\"alertTitle\">Note </span></th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td><p>You cannot sign in until users have been granted access to the website by adding authorization rules.</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"Note","pos":[307,311]},{"content":"You cannot sign in until users have been granted access to the website by adding authorization rules.","pos":[372,473]}]},{"pos":[41209,41259],"content":"Step 3: Configure a restrictive authorization rule"},{"content":"After Windows PowerShell Web Access is installed and the gateway is configured, users can open the sign-in page in a browser, but they cannot sign in until the Windows PowerShell Web Access administrator grants users access explicitly.","pos":[41346,41581]},{"content":"Windows PowerShell Web Access access control is managed by using the set of Windows PowerShell cmdlets described in the following table.","pos":[41582,41718]},{"content":"There is no comparable GUI for adding or managing authorization rules.","pos":[41719,41789]},{"content":"For more detailed information about Windows PowerShell Web Access cmdlets, see the cmdlet reference topics, <bpt id=\"p1\">[</bpt>Windows PowerShell Web Access Cmdlets<ept id=\"p1\">](https://technet.microsoft.com/library/hh918342.aspx)</ept>.","pos":[41790,41991]},{"pos":[41993,42228],"content":"For more detail about Windows PowerShell Web Access authorization rules and security, see <bpt id=\"p1\">[</bpt>Authorization Rules and Security Features of Windows PowerShell Web Access<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dn282394(v=ws.11).aspx)</ept>."},{"content":"To add a restrictive authorization rule","pos":[42235,42274]},{"content":"Do one of the following to open a Windows PowerShell session with elevated user rights.","pos":[42280,42367]},{"pos":[42377,42492],"content":"On the Windows desktop, right-click <bpt id=\"p1\">**</bpt>Windows PowerShell<ept id=\"p1\">**</ept> on the taskbar, and then click <bpt id=\"p2\">**</bpt>Run as Administrator<ept id=\"p2\">**</ept>."},{"pos":[42502,42611],"content":"On the Windows <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> screen, right-click <bpt id=\"p2\">**</bpt>Windows PowerShell<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Run as Administrator<ept id=\"p3\">**</ept>."},{"content":"Optional step for restricting user access by using session configurations:<ph id=\"ph1\">&lt;/span&gt;</ph> Verify that session configurations that you want to use in your rules already exist.","pos":[42637,42803]},{"content":"If they have not yet been created, use instructions for creating session configurations in <bpt id=\"p1\">[</bpt>about\\_Session\\_Configuration\\_Files<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/hh847838.aspx)</ept> on MSDN.","pos":[42804,43008]},{"pos":[43014,43059],"content":"Type the following, and then press <bpt id=\"p1\">**</bpt>Enter<ept id=\"p1\">**</ept>."},{"content":"[Copy](javascript:if%20(window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_4df22c91-f56f-4bb5-91e7-99f9b365ed5d'); \"Copy to clipboard.\")","pos":[43065,43231]},{"content":"This authorization rule allows a specific user access to one computer on the network to which they typically have access, with access to a specific session configuration that is scoped to the user’s typical scripting and cmdlet needs.","pos":[43390,43624]},{"content":"In the following example, a user named <ph id=\"ph1\">&lt;span class=\"code\"&gt;</ph>JSmith<ph id=\"ph2\">&lt;/span&gt;</ph> in the <ph id=\"ph3\">&lt;span class=\"code\"&gt;</ph>Contoso<ph id=\"ph4\">&lt;/span&gt;</ph> domain is granted access to manage the computer <ph id=\"ph5\">&lt;span class=\"code\"&gt;</ph>Contoso\\_214<ph id=\"ph6\">&lt;/span&gt;</ph>, and use a session configuration named <ph id=\"ph7\">&lt;span class=\"code\"&gt;</ph>NewAdminsOnly<ph id=\"ph8\">&lt;/span&gt;</ph>.","pos":[43625,43904]},{"content":"[Copy](javascript:if%20(window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_efc3999a-2905-453f-86cd-014b41658ffc'); \"Copy to clipboard.\")","pos":[43910,44076]},{"content":"Verify that the rule has been created by running either the <bpt id=\"p1\">**</bpt>Get-PswaAuthorizationRule<ept id=\"p1\">**</ept> cmdlet, or <bpt id=\"p2\">**</bpt>Test-PswaAuthorizationRule -UserName <ph id=\"ph1\">&amp;lt;</ph>domain\\\\user | computer\\\\user<ph id=\"ph2\">&amp;gt;</ph> -ComputerName<ept id=\"p2\">**</ept> <ph id=\"ph3\">&amp;lt;</ph>computer\\_name<ph id=\"ph4\">&amp;gt;</ph>.","pos":[44201,44418]},{"content":"For example, <bpt id=\"p1\">**</bpt>Test-PswaAuthorizationRule –UserName Contoso\\\\JSmith –ComputerName Contoso\\_214<ept id=\"p1\">**</ept>.","pos":[44419,44516]},{"content":"After you have configured an authorization rule, you are ready for authorized users to sign in to the web-based console and begin using Windows PowerShell Web Access.","pos":[44518,44684]},{"pos":[44920,44951],"content":"Configure a genuine certificate"},{"content":"For a secure production environment, always use a valid SSL certificate that has been signed by a certification authority (CA).","pos":[45202,45329]},{"content":"The procedure in this section describes how to obtain and apply a valid SSL certificate from a CA.","pos":[45330,45428]},{"content":"To configure an SSL certificate in IIS Manager","pos":[45434,45480]},{"content":"In the IIS Manager tree pane, select the server on which Windows PowerShell Web Access is installed.","pos":[45486,45586]},{"pos":[45592,45650],"content":"In the content pane, double click <bpt id=\"p1\">**</bpt>Server Certificates<ept id=\"p1\">**</ept>."},{"content":"In the <bpt id=\"p1\">**</bpt>Actions<ept id=\"p1\">**</ept> pane, do one of the following.","pos":[45656,45705]},{"content":"For more information about configuring server certificates in IIS, see <bpt id=\"p1\">[</bpt>Configuring Server Certificates in IIS 7<ept id=\"p1\">](https://technet.microsoft.com/library/cc732230.aspx)</ept>.","pos":[45706,45873]},{"pos":[45883,45973],"content":"Click <bpt id=\"p1\">**</bpt>Import<ept id=\"p1\">**</ept> to import an existing, valid certificate from a location on your network."},{"content":"Click <bpt id=\"p1\">**</bpt>Create Certificate Request<ept id=\"p1\">**</ept> to request a certificate from a CA such as VeriSign™, Thawte, or GeoTrust®.","pos":[45983,46095]},{"content":"The certificate's common name must match the host header in the request.","pos":[46096,46168]},{"content":"For example, if the client browser requests http://www.contoso.com/, then the common name must also be http://www.contoso.com/.","pos":[46169,46296]},{"content":"This is the most secure and recommended option for providing the Windows PowerShell Web Access gateway with a certificate.","pos":[46297,46419]},{"content":"Click <bpt id=\"p1\">**</bpt>Create a Self-Signed Certificate<ept id=\"p1\">**</ept> to create a certificate that you can use immediately, and have signed later by a CA if desired.","pos":[46429,46567]},{"content":"Specify a friendly name for the self-signed certificate, such as <bpt id=\"p1\">**</bpt>Windows PowerShell Web Access<ept id=\"p1\">**</ept>.","pos":[46568,46667]},{"content":"This option is not considered secure, and is recommended only for a private test environment.","pos":[46668,46761]},{"pos":[46767,46983],"content":"After creating or obtaining a certificate, select the website to which the certificate is applied (for example, <bpt id=\"p1\">**</bpt>Default Web Site<ept id=\"p1\">**</ept>) in the IIS Manager tree pane, and then click <bpt id=\"p2\">**</bpt>Bindings<ept id=\"p2\">**</ept> in the <bpt id=\"p3\">**</bpt>Actions<ept id=\"p3\">**</ept> pane."},{"content":"In the <bpt id=\"p1\">**</bpt>Add Site Binding<ept id=\"p1\">**</ept> dialog box, add an <bpt id=\"p2\">**</bpt>https<ept id=\"p2\">**</ept> binding for the site, if one is not already displayed.","pos":[46989,47100]},{"content":"If you are not using a self-signed certificate, specify the host name from step 3 of this procedure.","pos":[47101,47201]},{"content":"If you are using a self-signed certificate, this step is not required.","pos":[47202,47272]},{"pos":[47278,47381],"content":"Select the certificate that you obtained or created in step 3 of this procedure, and then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>."},{"pos":[47612,47658],"content":"Using the web-based Windows PowerShell console"},{"content":"After Windows PowerShell Web Access is installed and the gateway configuration is finished as described in this topic, the Windows PowerShell web-based console is ready to use.","pos":[47909,48085]},{"content":"For more information about getting started in the web-based console, see <bpt id=\"p1\">[</bpt>Use the Web-based Windows PowerShell Console<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/hh831417(v=ws.11).aspx)</ept>.","pos":[48086,48274]},{"pos":[48472,48480],"content":"See Also"},{"pos":[48731,49085],"content":"<bpt id=\"p1\">[</bpt>Internet Information Services (IIS) 7.0 Documentation<ept id=\"p1\">](https://technet.microsoft.com/library/cc753433.aspx)</ept><ph id=\"ph1\">\n</ph><bpt id=\"p2\">[</bpt>IIS Manager 7.0 Help<ept id=\"p2\">](https://technet.microsoft.com/library/cc732664.aspx)</ept><ph id=\"ph2\">\n</ph><bpt id=\"p3\">[</bpt>Configure Web Server Security (IIS 7)<ept id=\"p3\">](https://technet.microsoft.com/library/cc731278.aspx)</ept><ph id=\"ph3\">\n</ph><bpt id=\"p4\">[</bpt>IPsec Deployment Resources<ept id=\"p4\">](https://technet.microsoft.com/network/bb531150)</ept>"},{"pos":[49093,49125],"content":"Show:<ph id=\"ph1\">&lt;/span&gt;</ph> Inherited Protected"},{"content":"Was this page helpful?","pos":[49156,49178]},{"content":"Yes No","pos":[49186,49192]},{"content":"Additional feedback?","pos":[49194,49214]},{"pos":[49268,49324],"content":"1500<ph id=\"ph1\">&lt;/span&gt;</ph> characters remaining<ph id=\"ph2\">&lt;/span&gt;</ph> Submit Skip this"},{"content":"Thank you!","pos":[49354,49364]},{"content":"We appreciate your feedback.","pos":[49402,49430]},{"content":"Manage Your Profile","pos":[49440,49459]},{"pos":[49814,49845],"content":"Site Feedback<ph id=\"ph1\">&lt;/a&gt;</ph> Site Feedback"},{"pos":[49904,49905],"content":"x"},{"content":"Tell us about your experience...","pos":[49911,49943]},{"content":"Did the page load quickly?","pos":[49945,49971]},{"pos":[49980,50014],"content":"Yes<ph id=\"ph1\">&lt;span&gt;</ph> <ph id=\"ph2\">&lt;/span&gt;&lt;/span&gt;</ph> <ph id=\"ph3\">&lt;span&gt;</ph> No"},{"content":"Do you like the page design?","pos":[50037,50065]},{"pos":[50074,50108],"content":"Yes<ph id=\"ph1\">&lt;span&gt;</ph> <ph id=\"ph2\">&lt;/span&gt;&lt;/span&gt;</ph> <ph id=\"ph3\">&lt;span&gt;</ph> No"},{"content":"Tell us more","pos":[50131,50143]},{"content":"Flash Newsletter","pos":[50150,50166]},{"content":"Contact Us","pos":[50224,50234]},{"content":"Privacy Statement","pos":[50292,50309]},{"content":"Terms of Use","pos":[50370,50382]},{"content":"Trademarks","pos":[50440,50450]},{"content":"© 2016 Microsoft","pos":[50531,50547]},{"content":"© 2016 Microsoft","pos":[50549,50565]},{"content":"Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code, not by Microsoft.","pos":[50567,50710]},{"content":"See ASP.NET Ajax CDN Terms of Use – http://www.asp.net/ajaxlibrary/CDN.ashx.","pos":[50711,50787]}],"content":"---\ntitle:  install and use windows powershell web access\nms.date:  2016-05-11\nkeywords:  powershell,cmdlet\ndescription:  \nms.topic:  article\nauthor:  jpjofre\nmanager:  dongill\nms.prod:  powershell\n---\n\n#  Install and Use Windows PowerShell Web Access\n\nUpdated: November 5, 2013\n\nApplies To: Windows Server 2012 R2, Windows Server 2012\n\nWindows PowerShell® Web Access, first introduced in Windows Server® 2012, acts as a Windows PowerShell gateway, providing a web-based Windows PowerShell console that is targeted at a remote computer. It enables IT Pros to run Windows PowerShell commands and scripts from a Windows PowerShell console in a web browser, with no Windows PowerShell, remote management software, or browser plug-in installation necessary on the client device. All that is required to run the web-based Windows PowerShell console is a properly-configured Windows PowerShell Web Access gateway, and a client device browser that supports JavaScript® and accepts cookies.\n\nExamples of client devices include laptops, non-work personal computers, borrowed computers, tablet computers, web kiosks, computers that are not running a Windows-based operating system, and cell phone browsers. IT Pros can perform critical management tasks on remote Windows-based servers from devices that have access to an Internet connection and a web browser.\n\nAfter successful gateway setup and configuration, users can access a Windows PowerShell console by using a web browser. When users open the secured Windows PowerShell Web Access website, they can run a web-based Windows PowerShell console after successful authentication.\n\nWindows PowerShell Web Access setup and configuration is a three-step process:\n\n1.  Installing Windows PowerShell Web Access\n\n2.  Configuring the gateway\n\n3.  Configuring authorization rules that allow users access to the web-based Windows PowerShell console\n\nBefore you install and configure Windows PowerShell Web Access, we recommend that you read this entire guide, which includes instructions about how to install, secure, and uninstall Windows PowerShell Web Access. The [Use the Web-based Windows PowerShell Console](https://technet.microsoft.com/en-us/library/hh831417(v=ws.11).aspx) topic describes how users sign in to the web-based console, and covers limitations and differences between the web-based Windows PowerShell console and the **powershell.exe** console. End users of the web-based console should read [Use the Web-based Windows PowerShell Console](https://technet.microsoft.com/en-us/library/hh831417(v=ws.11).aspx), but do not need to read the rest of this guide.\n\nThis topic does not provide in-depth Web Server (IIS) operations guidance; only those steps required to configure the Windows PowerShell Web Access gateway are described in this topic. For more information about configuring and securing websites in IIS, see the IIS documentation resources in the See Also section.\n\nThe following diagram shows how Windows PowerShell Web Access works.\n\n<span><img src=\"https://i-technet.sec.s-msft.com/dynimg/IC564303.jpeg\" title=\"Windows PowerShell Web Access diagram\" alt=\"Windows PowerShell Web Access diagram\" id=\"ee15fa8f-ce13-49e5-933d-514f6d60a2b1\" /></span>\n\nIn this topic:\n\n-   [Requirements for running Windows PowerShell Web Access](#BKMK_reqs)\n\n-   [Browser and client device support](#BKMK_browser)\n\n-   [Recommended (quick) deployment](#BKMK_recm)\n\n-   [Custom deployment](#BKMK_custom)\n\n-   [Configure a genuine certificate](#BKMK_configcert)\n\n<a href=\"\" id=\"BKMK_reqs\"></a>\n\n<a href=\"javascript:void(0)\" class=\"LW_CollapsibleArea_TitleAhref\" title=\"Collapse\"><span class=\"cl_CollapsibleArea_expanding LW_CollapsibleArea_Img\"></span><span class=\"LW_CollapsibleArea_Title\">Requirements for running Windows PowerShell Web Access</span></a>\n<a href=\"/en-us/library/hh831611(v=ws.11).aspx#Anchor_0\" class=\"LW_CollapsibleArea_Anchor_Img\" title=\"Right-click to copy and share the link for this section\"></a>\n\n------------------------------------------------------------------------\n\nWindows PowerShell Web Access requires Web Server (IIS), .NET Framework 4.5, and Windows PowerShell 3.0 or Windows PowerShell 4.0 to be running on the server on which you want to run the gateway. You can install Windows PowerShell Web Access on a server that is running Windows Server 2012 R2 or Windows Server 2012 by using either the Add Roles and Features Wizard in Server Manager, or Windows PowerShell deployment cmdlets for Server Manager. When you install Windows PowerShell Web Access by using Server Manager or its deployment cmdlets, required roles and features are automatically added as part of the installation process.\n\nWindows PowerShell Web Access allows remote users to access computers in your organization by using Windows PowerShell in a web browser. Although Windows PowerShell Web Access is a convenient and powerful management tool, the web-based access poses security risks, and should be configured as securely as possible. We recommend that administrators who configure the Windows PowerShell Web Access gateway use available security layers, both the cmdlet-based authorization rules included with Windows PowerShell Web Access, and security layers that are available in Web Server (IIS) and third-party applications. This documentation includes both unsecure examples that are only recommended for test environments, as well as examples that are recommended for secure deployments.\n\n<a href=\"\" id=\"BKMK_browser\"></a>\n\n<a href=\"javascript:void(0)\" class=\"LW_CollapsibleArea_TitleAhref\" title=\"Collapse\"><span class=\"cl_CollapsibleArea_expanding LW_CollapsibleArea_Img\"></span><span class=\"LW_CollapsibleArea_Title\">Browser and client device support</span></a>\n<a href=\"/en-us/library/hh831611(v=ws.11).aspx#Anchor_1\" class=\"LW_CollapsibleArea_Anchor_Img\" title=\"Right-click to copy and share the link for this section\"></a>\n\n------------------------------------------------------------------------\n\nWindows PowerShell Web Access supports the following Internet browsers. Although mobile browsers are not officially supported, many may be able to run the web-based Windows PowerShell console. Other browsers that accept cookies, run JavaScript, and run HTTPS websites are expected to work, but are not officially tested.\n\n###\n\n<a href=\"javascript:void(0)\" class=\"LW_CollapsibleArea_TitleAhref\" title=\"Collapse\"><span class=\"cl_CollapsibleArea_expanding LW_CollapsibleArea_Img\"></span><span class=\"LW_CollapsibleArea_Title\">Supported desktop computer browsers</span></a>\n\n------------------------------------------------------------------------\n\n-   Windows® Internet Explorer® for Microsoft Windows® 8.0, 9.0, 10.0, and 11.0\n\n-   Mozilla Firefox® 10.0.2\n\n-   Google Chrome™ 17.0.963.56m for Windows\n\n-   Apple Safari® 5.1.2 for Windows\n\n-   Apple Safari 5.1.2 for Mac OS®\n\n###\n\n<a href=\"javascript:void(0)\" class=\"LW_CollapsibleArea_TitleAhref\" title=\"Collapse\"><span class=\"cl_CollapsibleArea_expanding LW_CollapsibleArea_Img\"></span><span class=\"LW_CollapsibleArea_Title\">Minimally-tested mobile devices or browsers</span></a>\n\n------------------------------------------------------------------------\n\n-   Windows Phone 7 and 7.5\n\n-   Google Android WebKit 3.1 Browser Android 2.2.1 (Kernel 2.6)\n\n-   Apple Safari for iPhone operating system 5.0.1\n\n-   Apple Safari for iPad 2 operating system 5.0.1\n\n###\n\n<a href=\"javascript:void(0)\" class=\"LW_CollapsibleArea_TitleAhref\" title=\"Collapse\"><span class=\"cl_CollapsibleArea_expanding LW_CollapsibleArea_Img\"></span><span class=\"LW_CollapsibleArea_Title\">Browser requirements</span></a>\n\n------------------------------------------------------------------------\n\nTo use the Windows PowerShell Web Access web-based console, browsers must do the following.\n\n-   Allow cookies from the Windows PowerShell Web Access gateway website.\n\n-   Be able to open and read HTTPS pages.\n\n-   Open and run websites that use JavaScript.\n\n<a href=\"\" id=\"BKMK_recm\"></a>\n\n<a href=\"javascript:void(0)\" class=\"LW_CollapsibleArea_TitleAhref\" title=\"Collapse\"><span class=\"cl_CollapsibleArea_expanding LW_CollapsibleArea_Img\"></span><span class=\"LW_CollapsibleArea_Title\">Recommended (quick) deployment</span></a>\n<a href=\"/en-us/library/hh831611(v=ws.11).aspx#Anchor_2\" class=\"LW_CollapsibleArea_Anchor_Img\" title=\"Right-click to copy and share the link for this section\"></a>\n\n------------------------------------------------------------------------\n\nYou can install the Windows PowerShell Web Access gateway on a server that is running Windows Server 2012 R2 or Windows Server 2012 by using either Windows PowerShell cmdlets, or by using the Add Roles and Features Wizard that is opened from within Server Manager. For quick installation and configuration, use Windows PowerShell cmdlets, as described in this section.\n\n-   [Step 1: Install Windows PowerShell Web Access](#BKMK_step1)\n\n-   [Step 2: Configure the gateway](#BKMK_step2)\n\n-   [Step 3: Configure a restrictive authorization rule](#BKMK_step3)\n\n<a href=\"\" id=\"BKMK_step1\"></a>\n###\n\n<a href=\"javascript:void(0)\" class=\"LW_CollapsibleArea_TitleAhref\" title=\"Collapse\"><span class=\"cl_CollapsibleArea_expanding LW_CollapsibleArea_Img\"></span><span class=\"LW_CollapsibleArea_Title\">Step 1: Install Windows PowerShell Web Access</span></a>\n\n------------------------------------------------------------------------\n\n#### To install Windows PowerShell Web Access by using Windows PowerShell cmdlets\n\n1.  Do one of the following to open a Windows PowerShell session with elevated user rights.\n\n    -   On the Windows desktop, right-click **Windows PowerShell** on the taskbar, and then click **Run as Administrator**.\n\n    -   On the Windows **Start** screen, right-click **Windows PowerShell**, and then click **Run as Administrator**.\n\n    <table>\n    <colgroup>\n    <col width=\"100%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th><span><img src=\"https://i-technet.sec.s-msft.com/dynimg/IC101471.jpeg\" title=\"System_CAPS_note\" alt=\"System_CAPS_note\" id=\"s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note\" /></span><span class=\"alertTitle\">Note </span></th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td><p>In Windows PowerShell 3.0 and 4.0, there is no need to import the Server Manager cmdlet module into the Windows PowerShell session before running cmdlets that are part of the module. A module is automatically imported the first time you run a cmdlet that is part of the module. Also, Windows PowerShell cmdlets are not case-sensitive.</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n2.  Type the following, and then press **Enter**, where *computer\\_name* represents a remote computer on which you want to install Windows PowerShell Web Access, if applicable. The <span class=\"code\">Restart</span> parameter automatically restarts destination servers if required.\n\n    [Copy](javascript:if%20(window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_374a9c21-4f6e-471e-b957-bb190a594533'); \"Copy to clipboard.\")\n\n        Install-WindowsFeature –Name WindowsPowerShellWebAccess -ComputerName <computer_name> -IncludeManagementTools -Restart\n\n    <table>\n    <colgroup>\n    <col width=\"100%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th><span><img src=\"https://i-technet.sec.s-msft.com/dynimg/IC101471.jpeg\" title=\"System_CAPS_note\" alt=\"System_CAPS_note\" id=\"s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note\" /></span><span class=\"alertTitle\">Note </span></th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td><p>Installing Windows PowerShell Web Access by using Windows PowerShell cmdlets does not add Web Server (IIS) management tools by default. If you want to install the management tools on the same server as the Windows PowerShell Web Access gateway, add the <span class=\"code\">IncludeManagementTools</span> parameter to the installation command (as provided in this step). If you are managing the Windows PowerShell Web Access website from a remote computer, install the IIS Manager snap-in by installing <a href=\"http://go.microsoft.com/fwlink/?LinkID=304145\">Remote Server Administration Tools for Windows 8.1</a> or <a href=\"http://go.microsoft.com/fwlink/p/?LinkID=238560\">Remote Server Administration Tools for Windows 8</a> on the computer from which you want to manage the gateway.</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n    To install roles and features on an offline VHD, you must add both the <span class=\"code\">ComputerName</span> parameter and the <span class=\"code\">VHD</span> parameter. The <span class=\"code\">ComputerName</span> parameter contains the name of the server on which to mount the VHD, and the <span class=\"code\">VHD</span> parameter contains the path to the VHD file on the specified server.\n\n    [Copy](javascript:if%20(window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_d841d509-347e-49d0-bf54-8d1f306bece6'); \"Copy to clipboard.\")\n\n        Install-WindowsFeature –Name WindowsPowerShellWebAccess –VHD <path> -ComputerName <computer_name> -IncludeManagementTools -Restart\n\n3.  When installation is complete, verify that Windows PowerShell Web Access was installed on destination servers by running the **Get-WindowsFeature** cmdlet on a destination server, in a Windows PowerShell console that has been opened with elevated user rights. You can also verify that Windows PowerShell Web Access was installed in the Server Manager console, by selecting a destination server on the **All Servers** page, and then viewing the **Roles and Features** tile for the selected server. You can also view the readme file for Windows PowerShell Web Access.\n\n4.  After Windows PowerShell Web Access is installed, you are prompted to review the readme file, which contains basic, required setup instructions for the gateway. These setup instructions are also in the following section, [Step 2: Configure the gateway](#BKMK_step2). The path to the readme file is <span class=\"computerOutputInline\">C:\\\\Windows\\\\Web\\\\PowerShellWebAccess\\\\wwwroot\\\\README.txt</span>.\n\n<a href=\"\" id=\"BKMK_step2\"></a>\n###\n\n<a href=\"javascript:void(0)\" class=\"LW_CollapsibleArea_TitleAhref\" title=\"Collapse\"><span class=\"cl_CollapsibleArea_expanding LW_CollapsibleArea_Img\"></span><span class=\"LW_CollapsibleArea_Title\">Step 2: Configure the gateway</span></a>\n\n------------------------------------------------------------------------\n\nThe **Install-PswaWebApplication** cmdlet is a quick way to get Windows PowerShell Web Access configured. Although you can add the <span class=\"code\">UseTestCertificate</span> parameter to the <span class=\"code\">Install-PswaWebApplication</span> cmdlet to install a self-signed SSL certificate for test purposes, this is not secure; for a secure production environment, always use a valid SSL certificate that has been signed by a certification authority (CA). Administrators can replace the test certificate with a signed certificate of their choice by using the IIS Manager console.\n\nYou can complete Windows PowerShell Web Access web application configuration either by running the <span class=\"code\">Install-PswaWebApplication</span> cmdlet or by performing GUI-based configuration steps in IIS Manager. By default, the cmdlet installs the web application, **pswa** (and an application pool for it, **pswa\\_pool**), in the **Default Web Site** container, as shown in IIS Manager; if desired, you can instruct the cmdlet to change the default site container of the web application. IIS Manager offers configuration options that are available for web applications, such as changing the port number or the Secure Sockets Layer (SSL) certificate.\n\n<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th><span><img src=\"https://i-technet.sec.s-msft.com/dynimg/IC17938.jpeg\" title=\"System_CAPS_security\" alt=\"System_CAPS_security\" id=\"s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-security\" /></span><span class=\"alertTitle\"> Security Note </span></th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td><p>We strongly recommend that administrators configure the gateway to use a valid certificate that has been signed by a CA.</p></td>\n</tr>\n</tbody>\n</table>\n\n-   [To configure the Windows PowerShell Web Access gateway with a test certificate by using Install-PswaWebApplication](#BKMK_testcert)\n\n-   [To configure the Windows PowerShell Web Access gateway with a genuine certificate by using Install-PswaWebApplication and IIS Manager](#BKMK_gencert)\n\n#### To configure the Windows PowerShell Web Access gateway with a test certificate by using Install-PswaWebApplication\n\n1.  Do one of the following to open a Windows PowerShell session.\n\n    -   On the Windows desktop, right-click **Windows PowerShell** on the taskbar.\n\n    -   On the Windows **Start** screen, click **Windows PowerShell**.\n\n2.  Type the following, and then press **Enter**.\n\n    **Install-PswaWebApplication -UseTestCertificate**\n\n    <table>\n    <colgroup>\n    <col width=\"100%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th><span><img src=\"https://i-technet.sec.s-msft.com/dynimg/IC17938.jpeg\" title=\"System_CAPS_security\" alt=\"System_CAPS_security\" id=\"s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-security\" /></span><span class=\"alertTitle\"> Security Note </span></th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td><p>The <span class=\"code\">UseTestCertificate</span> parameter should only be used in a private test environment. For a secure production environment, we recommend using a valid certificate that has been signed by a CA.</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n    Running the cmdlet installs the Windows PowerShell Web Access web application within the IIS Default Web Site container. The cmdlet creates the infrastructure required to run Windows PowerShell Web Access on the default website, https://&lt;server\\_name&gt;/pswa. To install the web application in a different website, provide the website name by adding the <span class=\"code\">WebSiteName</span> parameter. To change the name of the web application (the default is <span class=\"code\">pswa</span>), add the <span class=\"code\">WebApplicationName</span> parameter.\n\n    The following settings are configured by running the cmdlet. You can change these manually in the IIS Manager console, if desired.\n\n    -   Path: /pswa\n\n    -   ApplicationPool: pswa\\_pool\n\n    -   EnabledProtocols: http\n\n    -   PhysicalPath: %*windir*%/Web/PowerShellWebAccess/wwwroot\n\n    <span class=\"label\">Example:</span> <span class=\"code\">Install-PswaWebApplication –webApplicationName myWebApp –useTestCertificate</span>\n\n    In this example, the resulting website for Windows PowerShell Web Access is https://&lt; *server\\_name*&gt;/myWebApp.\n\n    <table>\n    <colgroup>\n    <col width=\"100%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th><span><img src=\"https://i-technet.sec.s-msft.com/dynimg/IC101471.jpeg\" title=\"System_CAPS_note\" alt=\"System_CAPS_note\" id=\"s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note\" /></span><span class=\"alertTitle\">Note </span></th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td><p>You cannot sign in until users have been granted access to the website by adding authorization rules. For more information, see <a href=\"#BKMK_step3\">Step 3: Configure a restrictive authorization rule</a> and <a href=\"https://technet.microsoft.com/en-us/library/dn282394(v=ws.11).aspx\">Authorization Rules and Security Features of Windows PowerShell Web Access</a>.</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n#### To configure the Windows PowerShell Web Access gateway with a genuine certificate by using Install-PswaWebApplication and IIS Manager\n\n1.  Do one of the following to open a Windows PowerShell session.\n\n    -   On the Windows desktop, right-click **Windows PowerShell** on the taskbar.\n\n    -   On the Windows **Start** screen, click **Windows PowerShell**.\n\n2.  Type the following, and then press **Enter**.\n\n    **Install-PswaWebApplication**\n\n    The following gateway settings are configured by running the cmdlet. You can change these manually in the IIS Manager console, if desired. You can also specify values for the <span class=\"code\">WebsiteName</span> and <span class=\"code\">WebApplicationName</span> parameters of the <span class=\"code\">Install-PswaWebApplication</span> cmdlet.\n\n    -   Path: /pswa\n\n    -   ApplicationPool: pswa\\_pool\n\n    -   EnabledProtocols: http\n\n    -   PhysicalPath: %*windir*%/Web/PowerShellWebAccess/wwwroot\n\n3.  Open the IIS Manager console by doing one of the following.\n\n    -   On the Windows desktop, start Server Manager by clicking **Server Manager** in the Windows taskbar. On the **Tools** menu in Server Manager, click **Internet Information Services (IIS) Manager**.\n\n    -   On the Windows **Start** screen, click **Server Manager**.\n\n4.  In the IIS Manager tree pane, expand the node for the server on which Windows PowerShell Web Access is installed until the **Sites** folder is visible. Expand the **Sites** folder.\n\n5.  Select the website in which you have installed the Windows PowerShell Web Access web application. In the **Actions** pane, click **Bindings**.\n\n6.  In the **Site Binding** dialog box, click **Add**.\n\n7.  In the **Add Site Binding** dialog box, in the **Type** field, select **https**.\n\n8.  In the **SSL certificate** field, select your signed certificate from the drop-down menu. Click **OK**. See [To configure an SSL certificate in IIS Manager](#BKMK_cert) in this topic for more information about how to obtain a certificate.\n\n    The Windows PowerShell Web Access web application is now configured to use your signed SSL certificate. You can access Windows PowerShell Web Access by opening https://&lt;server\\_name&gt;/pswa in a browser window.\n\n    <table>\n    <colgroup>\n    <col width=\"100%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th><span><img src=\"https://i-technet.sec.s-msft.com/dynimg/IC101471.jpeg\" title=\"System_CAPS_note\" alt=\"System_CAPS_note\" id=\"s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note\" /></span><span class=\"alertTitle\">Note </span></th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td><p>You cannot sign in until users have been granted access to the website by adding authorization rules. For more information, see <a href=\"#BKMK_step3\">Step 3: Configure a restrictive authorization rule</a> and <a href=\"https://technet.microsoft.com/en-us/library/dn282394(v=ws.11).aspx\">Authorization Rules and Security Features of Windows PowerShell Web Access</a>.</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n<a href=\"\" id=\"BKMK_step3\"></a>\n###\n\n<a href=\"javascript:void(0)\" class=\"LW_CollapsibleArea_TitleAhref\" title=\"Collapse\"><span class=\"cl_CollapsibleArea_expanding LW_CollapsibleArea_Img\"></span><span class=\"LW_CollapsibleArea_Title\">Step 3: Configure a restrictive authorization rule</span></a>\n\n------------------------------------------------------------------------\n\nAfter Windows PowerShell Web Access is installed and the gateway is configured, users can open the sign-in page in a browser, but they cannot sign in until the Windows PowerShell Web Access administrator grants users access explicitly. Windows PowerShell Web Access access control is managed by using the set of Windows PowerShell cmdlets described in the following table. There is no comparable GUI for adding or managing authorization rules. For more detailed information about Windows PowerShell Web Access cmdlets, see the cmdlet reference topics, [Windows PowerShell Web Access Cmdlets](https://technet.microsoft.com/library/hh918342.aspx).\n\nFor more detail about Windows PowerShell Web Access authorization rules and security, see [Authorization Rules and Security Features of Windows PowerShell Web Access](https://technet.microsoft.com/en-us/library/dn282394(v=ws.11).aspx).\n\n#### To add a restrictive authorization rule\n\n1.  Do one of the following to open a Windows PowerShell session with elevated user rights.\n\n    -   On the Windows desktop, right-click **Windows PowerShell** on the taskbar, and then click **Run as Administrator**.\n\n    -   On the Windows **Start** screen, right-click **Windows PowerShell**, and then click **Run as Administrator**.\n\n2.  <span class=\"label\">Optional step for restricting user access by using session configurations:</span> Verify that session configurations that you want to use in your rules already exist. If they have not yet been created, use instructions for creating session configurations in [about\\_Session\\_Configuration\\_Files](https://msdn.microsoft.com/library/windows/desktop/hh847838.aspx) on MSDN.\n\n3.  Type the following, and then press **Enter**.\n\n    [Copy](javascript:if%20(window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_f9e7959b-75d0-4d63-8f8e-02334a8dd09d'); \"Copy to clipboard.\")\n\n        Add-PswaAuthorizationRule –UserName <domain\\user | computer\\user> -ComputerName <computer_name> -ConfigurationName <session_configuration_name>\n\n    This authorization rule allows a specific user access to one computer on the network to which they typically have access, with access to a specific session configuration that is scoped to the user’s typical scripting and cmdlet needs. In the following example, a user named <span class=\"code\">JSmith</span> in the <span class=\"code\">Contoso</span> domain is granted access to manage the computer <span class=\"code\">Contoso\\_214</span>, and use a session configuration named <span class=\"code\">NewAdminsOnly</span>.\n\n    [Copy](javascript:if%20(window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_ebd5bc5e-ec5d-4955-a86a-63843e480e37'); \"Copy to clipboard.\")\n\n        Add-PswaAuthorizationRule –UserName Contoso\\JSmith -ComputerName Contoso_214 -ConfigurationName NewAdminsOnly\n\n4.  Verify that the rule has been created by running either the **Get-PswaAuthorizationRule** cmdlet, or **Test-PswaAuthorizationRule -UserName &lt;domain\\\\user | computer\\\\user&gt; -ComputerName** &lt;computer\\_name&gt;. For example, **Test-PswaAuthorizationRule –UserName Contoso\\\\JSmith –ComputerName Contoso\\_214**.\n\nAfter you have configured an authorization rule, you are ready for authorized users to sign in to the web-based console and begin using Windows PowerShell Web Access.\n\n<a href=\"\" id=\"BKMK_custom\"></a>\n\n<a href=\"javascript:void(0)\" class=\"LW_CollapsibleArea_TitleAhref\" title=\"Collapse\"><span class=\"cl_CollapsibleArea_expanding LW_CollapsibleArea_Img\"></span><span class=\"LW_CollapsibleArea_Title\">Custom deployment</span></a>\n<a href=\"/en-us/library/hh831611(v=ws.11).aspx#Anchor_3\" class=\"LW_CollapsibleArea_Anchor_Img\" title=\"Right-click to copy and share the link for this section\"></a>\n\n------------------------------------------------------------------------\n\nYou can install the Windows PowerShell Web Access gateway on a server that is running Windows Server 2012 R2 or Windows Server 2012 by using the Add Roles and Features Wizard in Server Manager. After Windows PowerShell Web Access is installed, you can customize the configuration of the gateway in IIS Manager.\n\n<a href=\"\" id=\"BKMK_custom1\"></a>\n###\n\n<a href=\"javascript:void(0)\" class=\"LW_CollapsibleArea_TitleAhref\" title=\"Collapse\"><span class=\"cl_CollapsibleArea_expanding LW_CollapsibleArea_Img\"></span><span class=\"LW_CollapsibleArea_Title\">Step 1: Install Windows PowerShell Web Access</span></a>\n\n------------------------------------------------------------------------\n\n#### To install Windows PowerShell Web Access by using the Add Roles and Features Wizard\n\n1.  If Server Manager is already open, go on to the next step. If Server Manager is not already open, open it by doing one of the following.\n\n    -   On the Windows desktop, start Server Manager by clicking **Server Manager** in the Windows taskbar.\n\n    -   On the Windows **Start** screen, click **Server Manager**.\n\n2.  On the **Manage** menu, click **Add Roles and Features**.\n\n3.  On the **Select installation type** page, select **Role-based or feature-based installation**. Click **Next**.\n\n4.  On the **Select destination server** page, select a server from the server pool, or select an offline VHD. To select an offline VHD as your destination server, first select the server on which to mount the VHD, and then select the VHD file. For information about how to add servers to your server pool, see the Server Manager Help. After you have selected the destination server, click **Next**.\n\n5.  On the **Select features** page of the wizard, expand **Windows PowerShell**, and then select **Windows PowerShell Web Access**.\n\n6.  Note that you are prompted to add required features, such as .NET Framework 4.5, and role services of Web Server (IIS). Add required features and continue.\n\n    <table>\n    <colgroup>\n    <col width=\"100%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th><span><img src=\"https://i-technet.sec.s-msft.com/dynimg/IC101471.jpeg\" title=\"System_CAPS_note\" alt=\"System_CAPS_note\" id=\"s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note\" /></span><span class=\"alertTitle\">Note </span></th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td><p>Installing Windows PowerShell Web Access by using the Add Roles and Features Wizard also installs Web Server (IIS), including the IIS Manager snap-in. The snap-in and other IIS management tools are installed by default if you use Add Roles and Features Wizard. If you install Windows PowerShell Web Access by using Windows PowerShell cmdlets as described in the following procedure, management tools are not added by default.</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n7.  On the **Confirm installation selections** page, if the feature files for Windows PowerShell Web Access are not stored on the destination server that you selected in step 4, click **Specify an alternate source path**, and provide the path to the feature files. Otherwise, click **Install**.\n\n8.  After you click **Install**, the **Installation progress** page displays installation progress, results, and messages such as warnings, failures, or post-installation configuration steps that are required for Windows PowerShell Web Access. After Windows PowerShell Web Access is installed, you are prompted to review the readme file, which contains basic, required setup instructions for the gateway. These instructions are also included in this topic. The path to the readme file is <span class=\"computerOutputInline\">C:\\\\Windows\\\\Web\\\\PowerShellWebAccess\\\\wwwroot\\\\README.txt</span>.\n\n###\n\n<a href=\"javascript:void(0)\" class=\"LW_CollapsibleArea_TitleAhref\" title=\"Collapse\"><span class=\"cl_CollapsibleArea_expanding LW_CollapsibleArea_Img\"></span><span class=\"LW_CollapsibleArea_Title\">Step 2: Configure the gateway</span></a>\n\n------------------------------------------------------------------------\n\nInstructions in this section are for installing the Windows PowerShell Web Access web application in a subdirectory—and not in the root directory—of your website. This procedure is the GUI-based equivalent of the actions performed by the <span class=\"code\">Install-PswaWebApplication</span> cmdlet. This section also includes instructions for how to use IIS Manager to configure the Windows PowerShell Web Access gateway as a root website.\n\n-   [To use IIS Manager to configure the gateway in an existing website](#BKMK_configman)\n\n-   [To use IIS Manager to configure the gateway as a root website with a test certificate](#BKMK_configroot)\n\n-   \n\n#### To use IIS Manager to configure the gateway in an existing website\n\n1.  Open the IIS Manager console by doing one of the following.\n\n    -   On the Windows desktop, start Server Manager by clicking **Server Manager** in the Windows taskbar. On the **Tools** menu in Server Manager, click **Internet Information Services (IIS) Manager**.\n\n    -   On the Windows **Start** screen, type any part of the name **Internet Information Services (IIS) Manager**. Click the shortcut when it is displayed in the **Apps** results.\n\n2.  Create a new application pool for Windows PowerShell Web Access. Expand the node of the gateway server in the IIS Manager tree pane, select **Application Pools**, and click **Add Application Pool** in the **Actions** pane.\n\n3.  Add a new application pool with the name **pswa\\_pool**, or provide another name. Click **OK**.\n\n4.  In the IIS Manager tree pane, expand the node for the server on which Windows PowerShell Web Access is installed until the **Sites** folder is visible. Select the **Sites** folder.\n\n5.  Right-click the website (for example, **Default Web Site**) to which you would like to add the Windows PowerShell Web Access website, and then click **Add Application**.\n\n6.  In the **Alias** field, type pswa, or provide another alias. The alias becomes the virtual directory name. For example, **pswa** in the following URL represents the alias specified in this step: https://&lt;server\\_name&gt;/pswa.\n\n7.  In the **Application pool** field, select the application pool that you created in step 3.\n\n8.  In the **Physical path** field, browse for the location of the application. You can use the default location, %windir%/Web/PowerShellWebAccess/wwwroot. Click **OK**.\n\n9.  Follow the steps in the procedure [To configure an SSL certificate in IIS Manager](#BKMK_cert) in this topic.\n\n10. <span class=\"label\">Optional security step:</span> With the website selected in the tree pane, double-click **SSL Settings** in the content pane. Select **Require SSL**, and then in the **Actions** pane, click **Apply**. Optionally, in the **SSL Settings** pane, you can require that users connecting to the Windows PowerShell Web Access website have client certificates. Client certificates help to verify the identity of a client device user. For more information about how requiring client certificates can increase the security of Windows PowerShell Web Access, see [Authorization Rules and Security Features of Windows PowerShell Web Access](https://technet.microsoft.com/en-us/library/dn282394(v=ws.11).aspx) in this guide.\n\n11. Open a browser session on a client device. For more information about supported browsers and devices, see [Browser and client device support](#BKMK_browser) in this topic.\n\n12. Open the new Windows PowerShell Web Access website, https://&lt; *gateway\\_server\\_name*&gt;/pswa.\n\n    The browser should display the Windows PowerShell Web Access console sign-in page.\n\n    <table>\n    <colgroup>\n    <col width=\"100%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th><span><img src=\"https://i-technet.sec.s-msft.com/dynimg/IC101471.jpeg\" title=\"System_CAPS_note\" alt=\"System_CAPS_note\" id=\"s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note\" /></span><span class=\"alertTitle\">Note </span></th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td><p>You cannot sign in until users have been granted access to the website by adding authorization rules.</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n13. In a Windows PowerShell session that has been opened with elevated user rights (Run as Administrator), run the following script, in which *application\\_pool\\_name* represents the name of the application pool that you created in step 3, to give the application pool access rights to the authorization file.\n\n    [Copy](javascript:if%20(window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_c1a80a93-8fcf-4beb-a025-5f81bfb8bdae'); \"Copy to clipboard.\")\n\n        $applicationPoolName = \"<application_pool_name>\"\n        $authorizationFile = \"C:\\windows\\web\\powershellwebaccess\\data\\AuthorizationRules.xml\"\n        c:\\windows\\system32\\icacls.exe $authorizationFile /grant ('\"' + \"IIS AppPool\\$applicationPoolName\" + '\":R') > $null\n\n    To view existing access rights on the authorization file, run the following command:\n\n    [Copy](javascript:if%20(window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_ac2179c2-9548-4a17-8663-267fdd105380'); \"Copy to clipboard.\")\n\n        c:\\windows\\system32\\icacls.exe $authorizationFile\n\n#### To use IIS Manager to configure the gateway as a root website with a test certificate\n\n1.  Open the IIS Manager console by doing one of the following.\n\n    -   On the Windows desktop, start Server Manager by clicking **Server Manager** in the Windows taskbar. On the **Tools** menu in Server Manager, click **Internet Information Services (IIS) Manager**.\n\n    -   On the Windows **Start** screen, type any part of the name **Internet Information Services (IIS) Manager**. Click the shortcut when it is displayed in the **Apps** results.\n\n2.  In the IIS Manager tree pane, expand the node for the server on which Windows PowerShell Web Access is installed until the **Sites** folder is visible. Select the **Sites** folder.\n\n3.  In the **Actions** pane, click **Add Website**.\n\n4.  Type a name for the website, such as **Windows PowerShell Web Access**.\n\n5.  An application pool is automatically created for the new website. To use a different application pool, click **Select** to select an application pool to associate with the new website. Select the alternate application pool in the **Select Application Pool** dialog box, and then click **OK**.\n\n6.  In the **Physical path** text box, navigate to %*windir*%/Web/PowerShellWebAccess/wwwroot.\n\n7.  In the **Type** field of the **Binding** area, select **https**.\n\n8.  Assign a port number to the website that is not already in use by another site or application. To locate open ports, you can run the **netstat** command in a Command Prompt window. The default port number is 443.\n\n    Change the default port if another website is already using 443, or if you have other security reasons for changing the port number. If another website that is running on your gateway server is using your selected port, a warning is displayed when you click **OK** in the **Add Website** dialog box. You must use an unused port to run Windows PowerShell Web Access.\n\n9.  Optionally, if needed for your organization, specify a host name that makes sense to your organization and users, such as **www.contoso.com**. Click **OK**.\n\n10. For a more secure production environment, we strongly recommend providing a valid certificate that has been signed by a CA. You must provide an SSL certificate, because users can only connect to Windows PowerShell Web Access through an HTTPS website. See [To configure an SSL certificate in IIS Manager](#BKMK_cert) in this topic for more information about how to obtain a certificate.\n\n11. Click **OK** to close the **Add Website** dialog box.\n\n12. In a Windows PowerShell session that has been opened with elevated user rights (Run as Administrator), run the following script, in which *application\\_pool\\_name* represents the name of the application pool that you created in step 4, to give the application pool access rights to the authorization file.\n\n    [Copy](javascript:if%20(window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_35ae9944-ca44-4af7-9c96-616083b3e3db'); \"Copy to clipboard.\")\n\n        $applicationPoolName = \"<application_pool_name>\"\n        $authorizationFile = \"C:\\windows\\web\\powershellwebaccess\\data\\AuthorizationRules.xml\"\n        c:\\windows\\system32\\icacls.exe $authorizationFile /grant ('\"' + \"IIS AppPool\\$applicationPoolName\" + '\":R') > $null\n\n    To view existing access rights on the authorization file, run the following command:\n\n    [Copy](javascript:if%20(window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_0eb6d70a-2807-498b-b088-fa5233ed68d5'); \"Copy to clipboard.\")\n\n        c:\\windows\\system32\\icacls.exe $authorizationFile\n\n13. With the new website selected in the IIS Manager tree pane, click **Start** in the **Actions** pane to start the website.\n\n14. Open a browser session on a client device. For more information about supported browsers and devices, see [Browser and client device support](#BKMK_browser) in this document.\n\n15. Open the new Windows PowerShell Web Access website.\n\n    Because the root website points to the Windows PowerShell Web Access folder, the browser should display the Windows PowerShell Web Access sign-in page when you open https://&lt; *gateway\\_server\\_name*&gt;. You should not need to add **/pswa** to the URL.\n\n    <table>\n    <colgroup>\n    <col width=\"100%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th><span><img src=\"https://i-technet.sec.s-msft.com/dynimg/IC101471.jpeg\" title=\"System_CAPS_note\" alt=\"System_CAPS_note\" id=\"s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note\" /></span><span class=\"alertTitle\">Note </span></th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td><p>You cannot sign in until users have been granted access to the website by adding authorization rules.</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n###\n\n<a href=\"javascript:void(0)\" class=\"LW_CollapsibleArea_TitleAhref\" title=\"Collapse\"><span class=\"cl_CollapsibleArea_expanding LW_CollapsibleArea_Img\"></span><span class=\"LW_CollapsibleArea_Title\">Step 3: Configure a restrictive authorization rule</span></a>\n\n------------------------------------------------------------------------\n\nAfter Windows PowerShell Web Access is installed and the gateway is configured, users can open the sign-in page in a browser, but they cannot sign in until the Windows PowerShell Web Access administrator grants users access explicitly. Windows PowerShell Web Access access control is managed by using the set of Windows PowerShell cmdlets described in the following table. There is no comparable GUI for adding or managing authorization rules. For more detailed information about Windows PowerShell Web Access cmdlets, see the cmdlet reference topics, [Windows PowerShell Web Access Cmdlets](https://technet.microsoft.com/library/hh918342.aspx).\n\nFor more detail about Windows PowerShell Web Access authorization rules and security, see [Authorization Rules and Security Features of Windows PowerShell Web Access](https://technet.microsoft.com/en-us/library/dn282394(v=ws.11).aspx).\n\n#### To add a restrictive authorization rule\n\n1.  Do one of the following to open a Windows PowerShell session with elevated user rights.\n\n    -   On the Windows desktop, right-click **Windows PowerShell** on the taskbar, and then click **Run as Administrator**.\n\n    -   On the Windows **Start** screen, right-click **Windows PowerShell**, and then click **Run as Administrator**.\n\n2.  <span class=\"label\">Optional step for restricting user access by using session configurations:</span> Verify that session configurations that you want to use in your rules already exist. If they have not yet been created, use instructions for creating session configurations in [about\\_Session\\_Configuration\\_Files](https://msdn.microsoft.com/library/windows/desktop/hh847838.aspx) on MSDN.\n\n3.  Type the following, and then press **Enter**.\n\n    [Copy](javascript:if%20(window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_4df22c91-f56f-4bb5-91e7-99f9b365ed5d'); \"Copy to clipboard.\")\n\n        Add-PswaAuthorizationRule –UserName <domain\\user | computer\\user> -ComputerName <computer_name> -ConfigurationName <session_configuration_name>\n\n    This authorization rule allows a specific user access to one computer on the network to which they typically have access, with access to a specific session configuration that is scoped to the user’s typical scripting and cmdlet needs. In the following example, a user named <span class=\"code\">JSmith</span> in the <span class=\"code\">Contoso</span> domain is granted access to manage the computer <span class=\"code\">Contoso\\_214</span>, and use a session configuration named <span class=\"code\">NewAdminsOnly</span>.\n\n    [Copy](javascript:if%20(window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_efc3999a-2905-453f-86cd-014b41658ffc'); \"Copy to clipboard.\")\n\n        Add-PswaAuthorizationRule –UserName Contoso\\JSmith -ComputerName Contoso_214 -ConfigurationName NewAdminsOnly\n\n4.  Verify that the rule has been created by running either the **Get-PswaAuthorizationRule** cmdlet, or **Test-PswaAuthorizationRule -UserName &lt;domain\\\\user | computer\\\\user&gt; -ComputerName** &lt;computer\\_name&gt;. For example, **Test-PswaAuthorizationRule –UserName Contoso\\\\JSmith –ComputerName Contoso\\_214**.\n\nAfter you have configured an authorization rule, you are ready for authorized users to sign in to the web-based console and begin using Windows PowerShell Web Access.\n\n<a href=\"\" id=\"BKMK_configcert\"></a>\n\n<a href=\"javascript:void(0)\" class=\"LW_CollapsibleArea_TitleAhref\" title=\"Collapse\"><span class=\"cl_CollapsibleArea_expanding LW_CollapsibleArea_Img\"></span><span class=\"LW_CollapsibleArea_Title\">Configure a genuine certificate</span></a>\n<a href=\"/en-us/library/hh831611(v=ws.11).aspx#Anchor_4\" class=\"LW_CollapsibleArea_Anchor_Img\" title=\"Right-click to copy and share the link for this section\"></a>\n\n------------------------------------------------------------------------\n\nFor a secure production environment, always use a valid SSL certificate that has been signed by a certification authority (CA). The procedure in this section describes how to obtain and apply a valid SSL certificate from a CA.\n\n### To configure an SSL certificate in IIS Manager\n\n1.  In the IIS Manager tree pane, select the server on which Windows PowerShell Web Access is installed.\n\n2.  In the content pane, double click **Server Certificates**.\n\n3.  In the **Actions** pane, do one of the following. For more information about configuring server certificates in IIS, see [Configuring Server Certificates in IIS 7](https://technet.microsoft.com/library/cc732230.aspx).\n\n    -   Click **Import** to import an existing, valid certificate from a location on your network.\n\n    -   Click **Create Certificate Request** to request a certificate from a CA such as VeriSign™, Thawte, or GeoTrust®. The certificate's common name must match the host header in the request. For example, if the client browser requests http://www.contoso.com/, then the common name must also be http://www.contoso.com/. This is the most secure and recommended option for providing the Windows PowerShell Web Access gateway with a certificate.\n\n    -   Click **Create a Self-Signed Certificate** to create a certificate that you can use immediately, and have signed later by a CA if desired. Specify a friendly name for the self-signed certificate, such as **Windows PowerShell Web Access**. This option is not considered secure, and is recommended only for a private test environment.\n\n4.  After creating or obtaining a certificate, select the website to which the certificate is applied (for example, **Default Web Site**) in the IIS Manager tree pane, and then click **Bindings** in the **Actions** pane.\n\n5.  In the **Add Site Binding** dialog box, add an **https** binding for the site, if one is not already displayed. If you are not using a self-signed certificate, specify the host name from step 3 of this procedure. If you are using a self-signed certificate, this step is not required.\n\n6.  Select the certificate that you obtained or created in step 3 of this procedure, and then click **OK**.\n\n<a href=\"\" id=\"BKMK_using\"></a>\n\n<a href=\"javascript:void(0)\" class=\"LW_CollapsibleArea_TitleAhref\" title=\"Collapse\"><span class=\"cl_CollapsibleArea_expanding LW_CollapsibleArea_Img\"></span><span class=\"LW_CollapsibleArea_Title\">Using the web-based Windows PowerShell console</span></a>\n<a href=\"/en-us/library/hh831611(v=ws.11).aspx#Anchor_5\" class=\"LW_CollapsibleArea_Anchor_Img\" title=\"Right-click to copy and share the link for this section\"></a>\n\n------------------------------------------------------------------------\n\nAfter Windows PowerShell Web Access is installed and the gateway configuration is finished as described in this topic, the Windows PowerShell web-based console is ready to use. For more information about getting started in the web-based console, see [Use the Web-based Windows PowerShell Console](https://technet.microsoft.com/en-us/library/hh831417(v=ws.11).aspx).\n\n<a href=\"javascript:void(0)\" class=\"LW_CollapsibleArea_TitleAhref\" title=\"Collapse\"><span class=\"cl_CollapsibleArea_expanding LW_CollapsibleArea_Img\"></span><span class=\"LW_CollapsibleArea_Title\">See Also</span></a>\n<a href=\"/en-us/library/hh831611(v=ws.11).aspx#Anchor_6\" class=\"LW_CollapsibleArea_Anchor_Img\" title=\"Right-click to copy and share the link for this section\"></a>\n\n------------------------------------------------------------------------\n\n[Internet Information Services (IIS) 7.0 Documentation](https://technet.microsoft.com/library/cc753433.aspx)\n[IIS Manager 7.0 Help](https://technet.microsoft.com/library/cc732664.aspx)\n[Configure Web Server Security (IIS 7)](https://technet.microsoft.com/library/cc731278.aspx)\n[IPsec Deployment Resources](https://technet.microsoft.com/network/bb531150)\n\n<span>Show:</span> Inherited Protected\n\n<span class=\"stdr-votetitle\">Was this page helpful?</span>\nYes\nNo\n\nAdditional feedback?\n\n<span class=\"stdr-count\"><span class=\"stdr-charcnt\">1500</span> characters remaining</span>\nSubmit\nSkip this\n\n<span class=\"stdr-thankyou\">Thank you!</span> <span class=\"stdr-appreciate\">We appreciate your feedback.</span>\n\n[Manage Your Profile](https://social.technet.microsoft.com/profile)\n\n|\n\n<a href=\"javascript:void(0)\" id=\"SiteFeedbackLinkOpener\"><span id=\"FeedbackButton\" class=\"FeedbackButton clip20x21\"> <img src=\"https://i-technet.sec.s-msft.com/Areas/Epx/Content/Images/ImageSprite.png?v=635975720914499532\" alt=\"Site Feedback\" id=\"feedBackImg\" class=\"cl_footer_feedback_icon\" /> </span> Site Feedback</a>\nSite Feedback\n\n<a href=\"javascript:void(0)\" id=\"SiteFeedbackLinkCloser\">x</a>\n\nTell us about your experience...\n\nDid the page load quickly?\n\n<span> Yes<span> </span></span> <span> No<span> </span></span>\n\nDo you like the page design?\n\n<span> Yes<span> </span></span> <span> No<span> </span></span>\n\nTell us more\n\n-   [Flash Newsletter](https://technet.microsoft.com/cc543196.aspx)\n-   |\n-   [Contact Us](https://technet.microsoft.com/cc512759.aspx)\n-   |\n-   [Privacy Statement](https://privacy.microsoft.com/privacystatement)\n-   |\n-   [Terms of Use](https://technet.microsoft.com/cc300389.aspx)\n-   |\n-   [Trademarks](https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/)\n-   |\n\n© 2016 Microsoft\n\n© 2016 Microsoft\n\nThird party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code, not by Microsoft. See ASP.NET Ajax CDN Terms of Use – http://www.asp.net/ajaxlibrary/CDN.ashx.\n<img src=\"https://m.webtrends.com/dcsjwb9vb00000c932fd0rjc7_5p3t/njs.gif?dcsuri=/nojavascript&amp;WT.js=No\" alt=\"DCSIMG\" id=\"Img1\" width=\"1\" height=\"1\" />\n\n"}